<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
  <div class="navpath"><a class="el" href="dir_f74ade614ec31c2ba6c13faba1bd859c.html">fs</a>
  </div>
<div class="contents">
<h1>pnutfs.c File Reference</h1>Peanut File System.  
<a href="#_details">More...</a>
<p>

<p>
<a href="pnutfs_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gd2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#ge9cc3f70052dd31a2e9eb7ef5ccba0b8">NODETYPE_REG</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gc4183a62d414b9d45cfb2753acf68345">NODETYPE_DIR</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g5c33ceb9dfe33aa33dc7c0cb741ad679">PNUT_MAX_NAMELEN</a>&nbsp;&nbsp;&nbsp;(PNUT_DIRENT_SIZE - sizeof(<a class="el" href="group__xg_p_nut.html#gb1df3a55e86e5ea88e4db13d08662ad4">PNUT_BLKNUM</a>) - sizeof(<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>) - 1)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum length of a base name.  <a href="group__xg_p_nut.html#g5c33ceb9dfe33aa33dc7c0cb741ad679"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g5a13a0b0b8f7b78b710c9f156625e31c">PNUT_MAX_FILESIZE</a>&nbsp;&nbsp;&nbsp;(PNUT_BLOCKS_PER_NODE * PNUT_BLOCK_SIZE)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum size of a file or directory.  <a href="group__xg_p_nut.html#g5a13a0b0b8f7b78b710c9f156625e31c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g26a2c011ea6632c117da727631f11a1f">NUTBANK_SIZE</a>&nbsp;&nbsp;&nbsp;16384</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of each memory bank.  <a href="group__xg_p_nut.html#g26a2c011ea6632c117da727631f11a1f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g7ca418ff25e56062efc19694a920aef8">PNUT_TOTAL_BLOCKS</a>&nbsp;&nbsp;&nbsp;(PNUTBANK_COUNT * (NUTBANK_SIZE / PNUT_BLOCK_SIZE))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Total number of blocks on this device.  <a href="group__xg_p_nut.html#g7ca418ff25e56062efc19694a920aef8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g55570d30e39bb5d1ef421dab4a326dd8">BLOCKS_PER_BANK</a>&nbsp;&nbsp;&nbsp;(NUTBANK_SIZE / PNUT_BLOCK_SIZE)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g14bf50b6797af8fb3bda12c9aef80887">NUTBANK_SR</a>&nbsp;&nbsp;&nbsp;0xFF00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g500d68a36132539458d98c8966ec3b18">NUTBANK_START</a>&nbsp;&nbsp;&nbsp;0x8000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g93247ae4ecd231b533806d35307e68a8">NUTBANK_PTR</a>&nbsp;&nbsp;&nbsp;((char *)NUTBANK_START)</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gb1df3a55e86e5ea88e4db13d08662ad4">PNUT_BLKNUM</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gcabe6f787aea232ef3b91b8151c743ee">BankSelect</a> (<a class="el" href="group__xg_p_nut.html#gb1df3a55e86e5ea88e4db13d08662ad4">PNUT_BLKNUM</a> blk)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make the bank visible, which contains the specified block.  <a href="group__xg_p_nut.html#gcabe6f787aea232ef3b91b8151c743ee"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">PNUT_NODE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g5f3fdbd70697b26f533c03712c9e7f28">BankNodePointer</a> (<a class="el" href="group__xg_p_nut.html#gb1df3a55e86e5ea88e4db13d08662ad4">PNUT_BLKNUM</a> blk)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Select specified bank and return pointer to block.  <a href="group__xg_p_nut.html#g5f3fdbd70697b26f533c03712c9e7f28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g4f8f4eb4ba13ea50c4c9f636980e1584">PnutIOCtl</a> (NUTDEVICE *dev, int req, void *conf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device specific functions.  <a href="group__xg_p_nut.html#g4f8f4eb4ba13ea50c4c9f636980e1584"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTDEVICE&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gca108170da851cf5f834b85bb066cbaa">devPnut</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Peanut device information structure.  <a href="group__xg_p_nut.html#gca108170da851cf5f834b85bb066cbaa"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Peanut File System Configuration</h2></td></tr>
<tr><td colspan="2">The Nut/OS Configurator may be used to override the default values. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gfe7b66c5d4d005c0eb561138db5f58c7">PNUT_BLOCK_SIZE</a>&nbsp;&nbsp;&nbsp;512</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of a filesystem block.  <a href="group__xg_p_nut.html#gfe7b66c5d4d005c0eb561138db5f58c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#ge2da73bc0e5b28eb88d65afb7e9d358d">PNUT_DIRENT_SIZE</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of a directory entry.  <a href="group__xg_p_nut.html#ge2da73bc0e5b28eb88d65afb7e9d358d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#gd35267ab23b76e3ab82648bf23580256">PNUT_BLOCKS_PER_NODE</a>&nbsp;&nbsp;&nbsp;250</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum number of blocks per node.  <a href="group__xg_p_nut.html#gd35267ab23b76e3ab82648bf23580256"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_p_nut.html#g4293e35138194851cce8bef591a894ad">PNUTBANK_COUNT</a>&nbsp;&nbsp;&nbsp;30</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Peanut File System. 
<p>
<div class="fragment"><pre class="fragment">
 *
 * $Log$
 * Revision 1.16  2009/02/13 14:52:05  haraldkipp
 * Include memdebug.h for heap management debugging support.
 *
 * Revision 1.15  2009/01/17 11:26:46  haraldkipp
 * Getting rid of two remaining BSD types in favor of stdint.
 * Replaced 'u_int' by 'unsinged int' and 'uptr_t' by 'uintptr_t'.
 *
 * Revision 1.14  2008/08/27 06:45:23  thornen
 * Added bank support for MMnet03..04 MMnet102..104
 *
 * Revision 1.13  2008/08/26 17:36:45  haraldkipp
 * Revoked changes 2008/08/26 by thornen.
 *
 * Revision 1.11  2008/08/11 06:59:42  haraldkipp
 * BSD types replaced by stdint types (feature request #1282721).
 *
 * Revision 1.10  2006/08/01 07:43:48  haraldkipp
 * PNUT file system failed after some modifications done previously for the
 * PHAT file system. During directory open, the NUTFILE structure must be
 * allocated in the file system driver. PnutDirRead() must return -1 if the
 * end of a directory is reached. Reading unused directory entries must update
 * the file position pointer.
 *
 * Revision 1.9  2006/03/02 20:01:17  haraldkipp
 * Added implementation of dev_size makes _filelength() work, which in turn
 * enables the use of this file system in pro/httpd.c.
 *
 * Revision 1.8  2006/01/05 16:45:20  haraldkipp
 * Dynamic NUTFILE allocation for detached block device.
 *
 * Revision 1.7  2005/09/08 10:12:44  olereinhardt
 * Added #ifdef statement in NutSegBufEnable to avoid compiler warning
 * if no banked mem is used.
 *
 * Revision 1.6  2005/09/07 16:23:41  christianwelzel
 * Added support for MMnet02. Bankswitching is now handled in bankmem.h
 *
 * Revision 1.5  2005/08/02 17:46:47  haraldkipp
 * Major API documentation update.
 *
 * Revision 1.4  2005/05/16 08:33:59  haraldkipp
 * Added banking support for Arthernet.
 *
 * Revision 1.3  2005/02/21 11:10:21  olereinhardt
 * Changed deckaration of the "root" variable to compile with unix emulation
 *
 * Revision 1.2  2005/02/07 18:57:47  haraldkipp
 * ICCAVR compile errors fixed
 *
 * Revision 1.1  2005/02/05 20:35:21  haraldkipp
 * Peanut added
 *
 * </pre></div> 
<p>Definition in file <a class="el" href="pnutfs_8c-source.html">pnutfs.c</a>.</p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
