<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>XgAt91Twi</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#gb11b4ba5d0cf98175aed9f4a8c57ae75">TWI_PIO_ASR</a>&nbsp;&nbsp;&nbsp;PIOA_ASR</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#gc62d86252a221012b011073a2772a5c0">TWI_PIO_PDR</a>&nbsp;&nbsp;&nbsp;PIOA_PDR</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#gd74e35fa99ab9637a5a75cd762c36357">TWI_PIO_MDER</a>&nbsp;&nbsp;&nbsp;PIOA_MDER</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#gbe6654261c61050f912f4ad48458d7d2">TwMasterTransact</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sla, CONST void *txdata, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> txlen, void *rxdata, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> rxsiz, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> tmo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Transmit and/or receive data as a master.  <a href="#gbe6654261c61050f912f4ad48458d7d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#g5c826968e877be9162904631cd0a36df">TwMasterRegRead</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sla, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> iadr, <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> iadrlen, void *rxdata, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> rxsiz, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> tmo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive data as a master from a device having internal addressable registers.  <a href="#g5c826968e877be9162904631cd0a36df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#g68d7e97ad78e6abb985e3aad76390d6b">TwMasterRegWrite</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sla, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> iadr, <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> iadrlen, CONST void *txdata, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> txsiz, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> tmo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Transmit data as a master to a device having internal addressable registers.  <a href="#g68d7e97ad78e6abb985e3aad76390d6b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#g0910c498af43ca35a28b6c64c40d5b76">TwMasterError</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last master mode error.  <a href="#g0910c498af43ca35a28b6c64c40d5b76"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#g96d141b9a633fde584ee23fde45be5b1">TwMasterIndexes</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> idx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get last transfer results.  <a href="#g96d141b9a633fde584ee23fde45be5b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#gf49042cc4abc3b12378155db4af11924">TwIOCtl</a> (int req, void *conf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform TWI control functions.  <a href="#gf49042cc4abc3b12378155db4af11924"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_at91_twi.html#ga4c8ead7d93be00c8a12be08e64f1666">TwInit</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> sla)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize TWI interface.  <a href="#ga4c8ead7d93be00c8a12be08e64f1666"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="gb11b4ba5d0cf98175aed9f4a8c57ae75"></a><!-- doxytag: member="at91_twi.c::TWI_PIO_ASR" ref="gb11b4ba5d0cf98175aed9f4a8c57ae75" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_PIO_ASR&nbsp;&nbsp;&nbsp;PIOA_ASR          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00077">77</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>Referenced by <a class="el" href="at91__twi_8c-source.html#l00503">TwInit()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gc62d86252a221012b011073a2772a5c0"></a><!-- doxytag: member="at91_twi.c::TWI_PIO_PDR" ref="gc62d86252a221012b011073a2772a5c0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_PIO_PDR&nbsp;&nbsp;&nbsp;PIOA_PDR          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00080">80</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>Referenced by <a class="el" href="at91__twi_8c-source.html#l00503">TwInit()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd74e35fa99ab9637a5a75cd762c36357"></a><!-- doxytag: member="at91_twi.c::TWI_PIO_MDER" ref="gd74e35fa99ab9637a5a75cd762c36357" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TWI_PIO_MDER&nbsp;&nbsp;&nbsp;PIOA_MDER          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00083">83</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>Referenced by <a class="el" href="at91__twi_8c-source.html#l00503">TwInit()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gbe6654261c61050f912f4ad48458d7d2"></a><!-- doxytag: member="at91_twi.c::TwMasterTransact" ref="gbe6654261c61050f912f4ad48458d7d2" args="(uint8_t sla, CONST void *txdata, uint16_t txlen, void *rxdata, uint16_t rxsiz, uint32_t tmo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwMasterTransact           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>sla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&nbsp;</td>
          <td class="paramname"> <em>txdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>txlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>rxdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>rxsiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>tmo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Transmit and/or receive data as a master. 
<p>
The two-wire serial interface must have been initialized by calling <a class="el" href="group__xg_at91_twi.html#ga4c8ead7d93be00c8a12be08e64f1666" title="Initialize TWI interface.">TwInit()</a> before this function can be used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sla</em>&nbsp;</td><td>Slave address of the destination. This slave address must be specified as a 7-bit address. For example, the PCF8574A may be configured to slave addresses from 0x38 to 0x3F. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>txdata</em>&nbsp;</td><td>Points to the data to transmit. Ignored, if the number of data bytes to transmit is zero. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>txlen</em>&nbsp;</td><td>Number of data bytes to transmit. If zero, then the interface will not send any data to the slave device and will directly enter the master receive mode. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rxdata</em>&nbsp;</td><td>Points to a buffer, where the received data will be stored. Ignored, if the maximum number of bytes to receive is zero. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rxsiz</em>&nbsp;</td><td>Maximum number of bytes to receive. Set to zero, if no bytes are expected from the slave device. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmo</em>&nbsp;</td><td>Timeout in milliseconds. To disable timeout, set this parameter to NUT_WAIT_INFINITE.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes received, -1 in case of an error or timeout. </dd></dl>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00173">173</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>References <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="arm_8h-source.html#l00195">outr</a>, <a class="el" href="twif_8c-source.html#l00109">tw_mm_mutex</a>, <a class="el" href="twif_8c-source.html#l00110">tw_mm_que</a>, <a class="el" href="twif_8h-source.html#l00066">TWERR_IF_LOCKED</a>, <a class="el" href="twif_8h-source.html#l00064">TWERR_TIMEOUT</a>, <a class="el" href="at91__twi_8h-source.html#l00061">TWI_CR</a>, <a class="el" href="at91__twi_8h-source.html#l00082">TWI_DADR_LSB</a>, <a class="el" href="at91__twi_8h-source.html#l00122">TWI_IDR</a>, <a class="el" href="at91__twi_8h-source.html#l00119">TWI_IER</a>, <a class="el" href="at91__twi_8h-source.html#l00074">TWI_MMR</a>, <a class="el" href="at91__twi_8h-source.html#l00080">TWI_MREAD</a>, <a class="el" href="at91__twi_8h-source.html#l00128">TWI_RXRDY</a>, <a class="el" href="at91__twi_8h-source.html#l00062">TWI_START</a>, <a class="el" href="at91__twi_8h-source.html#l00063">TWI_STOP</a>, <a class="el" href="at91__twi_8h-source.html#l00149">TWI_THR</a>, and <a class="el" href="at91__twi_8h-source.html#l00129">TWI_TXRDY</a>.</p>

</div>
</div><p>
<a class="anchor" name="g5c826968e877be9162904631cd0a36df"></a><!-- doxytag: member="at91_twi.c::TwMasterRegRead" ref="g5c826968e877be9162904631cd0a36df" args="(uint8_t sla, uint32_t iadr, uint8_t iadrlen, void *rxdata, uint16_t rxsiz, uint32_t tmo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwMasterRegRead           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>sla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>iadr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>iadrlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>rxdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>rxsiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>tmo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receive data as a master from a device having internal addressable registers. 
<p>
The two-wire serial interface must have been initialized by calling <a class="el" href="group__xg_at91_twi.html#ga4c8ead7d93be00c8a12be08e64f1666" title="Initialize TWI interface.">TwInit()</a> before this function can be used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sla</em>&nbsp;</td><td>Slave address of the destination. This slave address must be specified as a 7-bit address. For example, the PCF8574A may be configured to slave addresses from 0x38 to 0x3F. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iadr</em>&nbsp;</td><td>Address send to the device to access certain registers or memory addresses of it. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iadrlen</em>&nbsp;</td><td>Number of bytes to send as address, maximum 3 bytes are supported from AT91SAM7 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rxdata</em>&nbsp;</td><td>Points to a buffer, where the received data will be stored. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rxsiz</em>&nbsp;</td><td>Maximum number of bytes to receive. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmo</em>&nbsp;</td><td>Timeout in milliseconds. To disable timeout, set this parameter to NUT_WAIT_INFINITE.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes received, -1 in case of an error or timeout. </dd></dl>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00269">269</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>References <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="arm_8h-source.html#l00195">outr</a>, <a class="el" href="twif_8c-source.html#l00109">tw_mm_mutex</a>, <a class="el" href="twif_8c-source.html#l00110">tw_mm_que</a>, <a class="el" href="twif_8h-source.html#l00066">TWERR_IF_LOCKED</a>, <a class="el" href="twif_8h-source.html#l00064">TWERR_TIMEOUT</a>, <a class="el" href="at91__twi_8h-source.html#l00061">TWI_CR</a>, <a class="el" href="at91__twi_8h-source.html#l00082">TWI_DADR_LSB</a>, <a class="el" href="at91__twi_8h-source.html#l00096">TWI_IADRR</a>, <a class="el" href="at91__twi_8h-source.html#l00122">TWI_IDR</a>, <a class="el" href="at91__twi_8h-source.html#l00119">TWI_IER</a>, <a class="el" href="at91__twi_8h-source.html#l00074">TWI_MMR</a>, <a class="el" href="at91__twi_8h-source.html#l00080">TWI_MREAD</a>, <a class="el" href="at91__twi_8h-source.html#l00128">TWI_RXRDY</a>, <a class="el" href="at91__twi_8h-source.html#l00062">TWI_START</a>, and <a class="el" href="at91__twi_8h-source.html#l00063">TWI_STOP</a>.</p>

</div>
</div><p>
<a class="anchor" name="g68d7e97ad78e6abb985e3aad76390d6b"></a><!-- doxytag: member="at91_twi.c::TwMasterRegWrite" ref="g68d7e97ad78e6abb985e3aad76390d6b" args="(uint8_t sla, uint32_t iadr, uint8_t iadrlen, CONST void *txdata, uint16_t txsiz, uint32_t tmo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwMasterRegWrite           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>sla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>iadr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>iadrlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&nbsp;</td>
          <td class="paramname"> <em>txdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>txsiz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>tmo</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Transmit data as a master to a device having internal addressable registers. 
<p>
The two-wire serial interface must have been initialized by calling <a class="el" href="group__xg_at91_twi.html#ga4c8ead7d93be00c8a12be08e64f1666" title="Initialize TWI interface.">TwInit()</a> before this function can be used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sla</em>&nbsp;</td><td>Slave address of the destination. This slave address must be specified as a 7-bit address. For example, the PCF8574A may be configured to slave addresses from 0x38 to 0x3F. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iadr</em>&nbsp;</td><td>Address send to the device to access certain registers or memory addresses of it. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iadrlen</em>&nbsp;</td><td>Number of bytes to send as address, maximum 3 bytes are supported from AT91SAM7 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>txdata</em>&nbsp;</td><td>Points to a buffer, where the data to transmit will be stored. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>txsiz</em>&nbsp;</td><td>Maximum number of bytes to transmit. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tmo</em>&nbsp;</td><td>Timeout in milliseconds. To disable timeout, set this parameter to NUT_WAIT_INFINITE.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes transmitted, -1 in case of an error or timeout. Number could be less if slave end transmission with NAK. </dd></dl>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00344">344</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>References <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="arm_8h-source.html#l00193">outb</a>, <a class="el" href="arm_8h-source.html#l00195">outr</a>, <a class="el" href="twif_8c-source.html#l00109">tw_mm_mutex</a>, <a class="el" href="twif_8c-source.html#l00110">tw_mm_que</a>, <a class="el" href="twif_8h-source.html#l00066">TWERR_IF_LOCKED</a>, <a class="el" href="twif_8h-source.html#l00064">TWERR_TIMEOUT</a>, <a class="el" href="at91__twi_8h-source.html#l00082">TWI_DADR_LSB</a>, <a class="el" href="at91__twi_8h-source.html#l00096">TWI_IADRR</a>, <a class="el" href="at91__twi_8h-source.html#l00122">TWI_IDR</a>, <a class="el" href="at91__twi_8h-source.html#l00119">TWI_IER</a>, <a class="el" href="at91__twi_8h-source.html#l00074">TWI_MMR</a>, <a class="el" href="at91__twi_8h-source.html#l00149">TWI_THR</a>, and <a class="el" href="at91__twi_8h-source.html#l00129">TWI_TXRDY</a>.</p>

</div>
</div><p>
<a class="anchor" name="g0910c498af43ca35a28b6c64c40d5b76"></a><!-- doxytag: member="at91_twi.c::TwMasterError" ref="g0910c498af43ca35a28b6c64c40d5b76" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwMasterError           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get last master mode error. 
<p>
You may call this function to determine the specific cause of an error after twi transaction failed. 
<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00393">393</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g96d141b9a633fde584ee23fde45be5b1"></a><!-- doxytag: member="at91_twi.c::TwMasterIndexes" ref="g96d141b9a633fde584ee23fde45be5b1" args="(uint8_t idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> TwMasterIndexes           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>idx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get last transfer results. 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>Do we really need this. It may not work with competing threads.</dd></dl>
You may call this function to determine how many bytes where transferred before the twi transaction failed. 
<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00409">409</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf49042cc4abc3b12378155db4af11924"></a><!-- doxytag: member="at91_twi.c::TwIOCtl" ref="gf49042cc4abc3b12378155db4af11924" args="(int req, void *conf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwIOCtl           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>conf</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform TWI control functions. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>req</em>&nbsp;</td><td>Requested control function. May be set to one of the following constants:<ul>
<li>TWI_SETSPEED, if conf points to an uint32_t value containing the bitrate.</li><li>TWI_GETSPEED, if conf points to an uint32_t value receiving the current bitrate. </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>conf</em>&nbsp;</td><td>Points to a buffer that contains any data required for the given control function or receives data from that function. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Timeout is limited to the granularity of the system timer. </dd></dl>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00438">438</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>References <a class="el" href="arm_8h-source.html#l00199">inr</a>, <a class="el" href="sys_2timer_8h-source.html#l00160">NUT_HWCLK_PERIPHERAL</a>, <a class="el" href="sys_2timer_8h-source.html#l00200">NutClockGet</a>, <a class="el" href="timer_8c-source.html#l00800">NutGetCpuClock()</a>, <a class="el" href="arm_8h-source.html#l00195">outr</a>, <a class="el" href="at91__twi_8h-source.html#l00104">TWI_CWGR</a>, <a class="el" href="twif_8h-source.html#l00056">TWI_GETSPEED</a>, <a class="el" href="twif_8h-source.html#l00060">TWI_GETSTATUS</a>, <a class="el" href="twif_8h-source.html#l00055">TWI_SETSPEED</a>, and <a class="el" href="twif_8h-source.html#l00059">TWI_SETSTATUS</a>.</p>

</div>
</div><p>
<a class="anchor" name="ga4c8ead7d93be00c8a12be08e64f1666"></a><!-- doxytag: member="at91_twi.c::TwInit" ref="ga4c8ead7d93be00c8a12be08e64f1666" args="(uint8_t sla)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TwInit           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>sla</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize TWI interface. 
<p>
The specified slave address is not used here as we don't support twi-slave on AT91SAM7X<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This function is only available on AT91SAM7xxxx systems.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sla</em>&nbsp;</td><td>Slave address, must be specified as a 7-bit address, always lower than 128. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="at91__twi_8c-source.html#l00503">503</a> of file <a class="el" href="at91__twi_8c-source.html">at91_twi.c</a>.</p>

<p>References <a class="el" href="arm_8h-source.html#l00201">_BV</a>, <a class="el" href="dev_2irqreg_8h-source.html#l00141">NUT_IRQMODE_LEVEL</a>, <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>, <a class="el" href="ihndlr_8c-source.html#l00121">NutIrqEnable()</a>, <a class="el" href="ihndlr_8c-source.html#l00201">NutIrqSetMode()</a>, <a class="el" href="ihndlr_8c-source.html#l00098">NutRegisterIrqHandler()</a>, <a class="el" href="arm_8h-source.html#l00195">outr</a>, <a class="el" href="at91__pmc_8h-source.html#l00103">PMC_PCER</a>, <a class="el" href="twif_8c-source.html#l00109">tw_mm_mutex</a>, <a class="el" href="at91__twi_8h-source.html#l00061">TWI_CR</a>, <a class="el" href="at91sam7s_8h-source.html#l00131">TWI_ID</a>, <a class="el" href="at91__twi_8h-source.html#l00122">TWI_IDR</a>, <a class="el" href="at91__twi_8h-source.html#l00064">TWI_MSEN</a>, <a class="el" href="at91__twi_8c-source.html#l00077">TWI_PIO_ASR</a>, <a class="el" href="at91__twi_8c-source.html#l00083">TWI_PIO_MDER</a>, <a class="el" href="at91__twi_8c-source.html#l00080">TWI_PIO_PDR</a>, <a class="el" href="twif_8h-source.html#l00055">TWI_SETSPEED</a>, <a class="el" href="at91__twi_8h-source.html#l00067">TWI_SVDIS</a>, <a class="el" href="at91__twi_8h-source.html#l00068">TWI_SWRST</a>, and <a class="el" href="twif_8c-source.html#l00830">TwIOCtl()</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
