<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
  <div class="navpath"><a class="el" href="dir_62cc943d9a5c6ffd14cbda02228b93ec.html">dev</a>
  </div>
<div class="contents">
<h1>x12rtc.c File Reference</h1>RTC and EEPROM routines for the Intersil X12xx clock chips.  
<a href="#_details">More...</a>
<p>

<p>
<a href="x12rtc_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#c51c0bf7789728a1b2d88356c3f789e9">I2C_SLA_RTC</a>&nbsp;&nbsp;&nbsp;0x6F</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#f46b456765d52c2be1515e1a1040a40b">I2C_SLA_EEPROM</a>&nbsp;&nbsp;&nbsp;0x57</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#ddfda15f5f3ec6f8f325f48be50c548a">EEPROM_PAGE_SIZE</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#7947dea51e9ee22c94e660e927bef650">X12RtcReadRegs</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> reg, <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buff, size_t cnt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read RTC registers.  <a href="#7947dea51e9ee22c94e660e927bef650"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#23e5c16152b7f3d14927dba342ca0954">X12RtcWrite</a> (int nv, CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buff, size_t cnt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write to RTC registers.  <a href="#23e5c16152b7f3d14927dba342ca0954"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#064966fba1b531fd7ccd2b64ae5c521b">X12RtcGetClock</a> (struct <a class="el" href="struct__tm.html">_tm</a> *tm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get date and time from an X12xx hardware clock.  <a href="#064966fba1b531fd7ccd2b64ae5c521b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#5d3fff18c845694ea7c770e20b243102">X12RtcSetClock</a> (CONST struct <a class="el" href="struct__tm.html">_tm</a> *tm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set an X12xx hardware clock.  <a href="#5d3fff18c845694ea7c770e20b243102"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#b57af922d4203f808a76188b54fa3937">X12RtcGetAlarm</a> (int idx, struct <a class="el" href="struct__tm.html">_tm</a> *tm, int *aflgs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get alarm date and time of an X12xx hardware clock.  <a href="#b57af922d4203f808a76188b54fa3937"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#896520f5d3dc5c6997ff5eaff180ef91">X12RtcSetAlarm</a> (int idx, CONST struct <a class="el" href="struct__tm.html">_tm</a> *tm, int aflgs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set alarm of an X12xx hardware clock.  <a href="#896520f5d3dc5c6997ff5eaff180ef91"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#b07d10a89ab2a8815997e3c2dd3bf41e">X12RtcGetStatus</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *sflgs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Query RTC status flags.  <a href="#b07d10a89ab2a8815997e3c2dd3bf41e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#1407db5b616d125020d843d602caaafb">X12RtcClearStatus</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> sflgs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear RTC status flags.  <a href="#1407db5b616d125020d843d602caaafb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#8236fbe59011df5bc9db072de31128c3">X12EepromRead</a> (unsigned int addr, void *buff, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read contents from non-volatile EEPROM.  <a href="#8236fbe59011df5bc9db072de31128c3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#bee38edf014cf9a82b94c2e0a52d895e">X12EepromWrite</a> (unsigned int addr, CONST void *buff, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store buffer contents in non-volatile EEPROM.  <a href="#bee38edf014cf9a82b94c2e0a52d895e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#305d0637a6a98425e7a28badcefa0466">X12Init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the interface to an Intersil X12xx hardware clock.  <a href="#305d0637a6a98425e7a28badcefa0466"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTRTC&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="x12rtc_8c.html#8ea7ee804bfcd8c92052c34e8bc173fb">rtcX12x6</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
RTC and EEPROM routines for the Intersil X12xx clock chips. 
<p>
<div class="fragment"><pre class="fragment">
 *
 * $Log$
 * Revision 1.10  2009/02/13 14:52:05  haraldkipp
 * Include memdebug.h for heap management debugging support.
 *
 * Revision 1.9  2009/01/17 11:26:46  haraldkipp
 * Getting rid of two remaining BSD types in favor of stdint.
 * Replaced 'u_int' by 'unsinged int' and 'uptr_t' by 'uintptr_t'.
 *
 * Revision 1.8  2008/08/11 06:59:42  haraldkipp
 * BSD types replaced by stdint types (feature request #1282721).
 *
 * Revision 1.7  2008/07/09 14:25:06  haraldkipp
 * Made EEPROM_PAGE_SIZE configurable. Does it really make sense?
 *
 * Revision 1.6  2007/06/03 08:50:38  haraldkipp
 * Automatic detection of X1226 or X1286.
 * Fixed wrong century determination for X1226.
 * Debugging output added.
 *
 * Revision 1.5  2007/05/02 11:29:25  haraldkipp
 * Failed to store more than one EEPROM page. Removing NutSleep() from
 * X12WaitReady() fixes this. Why?
 *
 * Revision 1.4  2006/10/05 17:21:53  haraldkipp
 * Hardware specific functions marked deprecated.
 * Hardcoded register addresses and values replaced by macros.
 *
 * Revision 1.3  2006/03/02 19:57:34  haraldkipp
 * ICCARM insists on a (void *) typecast for the second parameter of memcpy().
 *
 * Revision 1.2  2006/01/19 18:41:34  haraldkipp
 * Year translation was completely broken. Fixed.
 *
 * Revision 1.1  2005/10/24 10:21:57  haraldkipp
 * Initial check in.
 *
 *
 * </pre></div> 
<p>Definition in file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="c51c0bf7789728a1b2d88356c3f789e9"></a><!-- doxytag: member="x12rtc.c::I2C_SLA_RTC" ref="c51c0bf7789728a1b2d88356c3f789e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_SLA_RTC&nbsp;&nbsp;&nbsp;0x6F          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00101">101</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="f46b456765d52c2be1515e1a1040a40b"></a><!-- doxytag: member="x12rtc.c::I2C_SLA_EEPROM" ref="f46b456765d52c2be1515e1a1040a40b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_SLA_EEPROM&nbsp;&nbsp;&nbsp;0x57          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00105">105</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>Referenced by <a class="el" href="x12rtc_8c-source.html#l00463">X12EepromRead()</a>, and <a class="el" href="x12rtc_8c-source.html#l00488">X12EepromWrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ddfda15f5f3ec6f8f325f48be50c548a"></a><!-- doxytag: member="x12rtc.c::EEPROM_PAGE_SIZE" ref="ddfda15f5f3ec6f8f325f48be50c548a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EEPROM_PAGE_SIZE&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00109">109</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>Referenced by <a class="el" href="x12rtc_8c-source.html#l00488">X12EepromWrite()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7947dea51e9ee22c94e660e927bef650"></a><!-- doxytag: member="x12rtc.c::X12RtcReadRegs" ref="7947dea51e9ee22c94e660e927bef650" args="(uint8_t reg, uint8_t *buff, size_t cnt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcReadRegs           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cnt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read RTC registers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>The first register to read. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Pointer to a buffer that receives the register contents. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnt</em>&nbsp;</td><td>The number of registers to read.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00174">174</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00076">I2C_SLA_RTC</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, <a class="el" href="icc_8h-source.html#l00136">printf</a>, <a class="el" href="putchar_8c-source.html#l00061">putchar()</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="x12rtc_8c-source.html#l00546">X12Init()</a>, <a class="el" href="x12rtc_8c-source.html#l00320">X12RtcGetAlarm()</a>, <a class="el" href="x12rtc_8c-source.html#l00239">X12RtcGetClock()</a>, and <a class="el" href="x12rtc_8c-source.html#l00415">X12RtcGetStatus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="23e5c16152b7f3d14927dba342ca0954"></a><!-- doxytag: member="x12rtc.c::X12RtcWrite" ref="23e5c16152b7f3d14927dba342ca0954" args="(int nv, CONST uint8_t *buff, size_t cnt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcWrite           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cnt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write to RTC registers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nv</em>&nbsp;</td><td>Must be set to 1 when writing to non-volatile registers. In this case the routine will poll for write cycle completion before returning to the caller. Set to zero if writing to volatile registers. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>This buffer must contain all bytes to be transfered to the RTC chip, including the register address. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnt</em>&nbsp;</td><td>Number of valid bytes in the buffer.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00207">207</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00076">I2C_SLA_RTC</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, <a class="el" href="icc_8h-source.html#l00136">printf</a>, <a class="el" href="putchar_8c-source.html#l00061">putchar()</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="x12rtc_8c-source.html#l00374">X12RtcSetAlarm()</a>, and <a class="el" href="x12rtc_8c-source.html#l00276">X12RtcSetClock()</a>.</p>

</div>
</div><p>
<a class="anchor" name="064966fba1b531fd7ccd2b64ae5c521b"></a><!-- doxytag: member="x12rtc.c::X12RtcGetClock" ref="064966fba1b531fd7ccd2b64ae5c521b" args="(struct _tm *tm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcGetClock           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get date and time from an X12xx hardware clock. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000007">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#f7b0f9657f58b47b8d7c84ff581e1fed" title="Get date and time from the registered RTC.">NutRtcGetTime()</a>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure that receives the date and time information.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00239">239</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00065">BCD2BIN</a>, <a class="el" href="time_8h-source.html#l00098">tm::tm_hour</a>, <a class="el" href="time_8h-source.html#l00099">tm::tm_mday</a>, <a class="el" href="time_8h-source.html#l00097">tm::tm_min</a>, <a class="el" href="time_8h-source.html#l00100">tm::tm_mon</a>, <a class="el" href="time_8h-source.html#l00096">tm::tm_sec</a>, <a class="el" href="time_8h-source.html#l00102">tm::tm_wday</a>, <a class="el" href="time_8h-source.html#l00101">tm::tm_year</a>, <a class="el" href="x12rtc_8h-source.html#l00140">X12RTC_SC</a>, and <a class="el" href="x12rtc_8c-source.html#l00174">X12RtcReadRegs()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5d3fff18c845694ea7c770e20b243102"></a><!-- doxytag: member="x12rtc.c::X12RtcSetClock" ref="5d3fff18c845694ea7c770e20b243102" args="(CONST struct _tm *tm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcSetClock           </td>
          <td>(</td>
          <td class="paramtype">CONST struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set an X12xx hardware clock. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000008">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#fd28cfc1426a407c61d51c139d392e71" title="Set date and time of the registered RTC.">NutRtcSetTime()</a>.</dd></dl>
New time will be taken over at the beginning of the next second.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure which contains the date and time information.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00276">276</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00070">BIN2BCD</a>, <a class="el" href="memset_8c-source.html#l00088">memset()</a>, <a class="el" href="x12rtc_8h-source.html#l00140">X12RTC_SC</a>, and <a class="el" href="x12rtc_8c-source.html#l00207">X12RtcWrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b57af922d4203f808a76188b54fa3937"></a><!-- doxytag: member="x12rtc.c::X12RtcGetAlarm" ref="b57af922d4203f808a76188b54fa3937" args="(int idx, struct _tm *tm, int *aflgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcGetAlarm           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>aflgs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get alarm date and time of an X12xx hardware clock. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000009">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#7c9a30dae3154b8d754cb9c3cdaba4d6" title="Get alarm date and time from the registered RTC.">NutRtcGetAlarm()</a>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>idx</em>&nbsp;</td><td>Zero based index. Two alarms are supported. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure that receives the date and time information. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aflgs</em>&nbsp;</td><td>Points to an unsigned long that receives the enable flags.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00320">320</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00065">BCD2BIN</a>, <a class="el" href="memset_8c-source.html#l00088">memset()</a>, <a class="el" href="rtc_8h-source.html#l00057">RTC_ALARM_HOUR</a>, <a class="el" href="rtc_8h-source.html#l00058">RTC_ALARM_MDAY</a>, <a class="el" href="rtc_8h-source.html#l00056">RTC_ALARM_MINUTE</a>, <a class="el" href="rtc_8h-source.html#l00059">RTC_ALARM_MONTH</a>, <a class="el" href="rtc_8h-source.html#l00055">RTC_ALARM_SECOND</a>, <a class="el" href="rtc_8h-source.html#l00060">RTC_ALARM_WDAY</a>, <a class="el" href="time_8h-source.html#l00098">tm::tm_hour</a>, <a class="el" href="time_8h-source.html#l00099">tm::tm_mday</a>, <a class="el" href="time_8h-source.html#l00097">tm::tm_min</a>, <a class="el" href="time_8h-source.html#l00100">tm::tm_mon</a>, <a class="el" href="time_8h-source.html#l00096">tm::tm_sec</a>, <a class="el" href="time_8h-source.html#l00102">tm::tm_wday</a>, <a class="el" href="x12rtc_8h-source.html#l00077">X12RTC_DTA_EDT</a>, <a class="el" href="x12rtc_8h-source.html#l00088">X12RTC_DWA_EDW</a>, <a class="el" href="x12rtc_8h-source.html#l00073">X12RTC_HRA_EHR</a>, <a class="el" href="x12rtc_8h-source.html#l00069">X12RTC_MNA_EMN</a>, <a class="el" href="x12rtc_8h-source.html#l00081">X12RTC_MOA_EMO</a>, <a class="el" href="x12rtc_8h-source.html#l00065">X12RTC_SCA_ESC</a>, and <a class="el" href="x12rtc_8c-source.html#l00174">X12RtcReadRegs()</a>.</p>

</div>
</div><p>
<a class="anchor" name="896520f5d3dc5c6997ff5eaff180ef91"></a><!-- doxytag: member="x12rtc.c::X12RtcSetAlarm" ref="896520f5d3dc5c6997ff5eaff180ef91" args="(int idx, CONST struct _tm *tm, int aflgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcSetAlarm           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>aflgs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set alarm of an X12xx hardware clock. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000010">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#31a3f905f07f4fa70d7ecff4c4acf4d0" title="Set alarm date and time of the registered RTC.">NutRtcSetAlarm()</a>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>idx</em>&nbsp;</td><td>Zero based index. Two alarms are supported. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure which contains the date and time information. May be NULL to clear the alarm. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>aflgs</em>&nbsp;</td><td>Each bit enables a specific comparision.<ul>
<li>Bit 0: Seconds</li><li>Bit 1: Minutes</li><li>Bit 2: Hours</li><li>Bit 3: Day of month</li><li>Bit 4: Month</li><li>Bit 7: Day of week (Sunday is zero)</li></ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00374">374</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00070">BIN2BCD</a>, <a class="el" href="memset_8c-source.html#l00088">memset()</a>, <a class="el" href="rtc_8h-source.html#l00057">RTC_ALARM_HOUR</a>, <a class="el" href="rtc_8h-source.html#l00058">RTC_ALARM_MDAY</a>, <a class="el" href="rtc_8h-source.html#l00056">RTC_ALARM_MINUTE</a>, <a class="el" href="rtc_8h-source.html#l00059">RTC_ALARM_MONTH</a>, <a class="el" href="rtc_8h-source.html#l00055">RTC_ALARM_SECOND</a>, <a class="el" href="rtc_8h-source.html#l00060">RTC_ALARM_WDAY</a>, <a class="el" href="x12rtc_8h-source.html#l00077">X12RTC_DTA_EDT</a>, <a class="el" href="x12rtc_8h-source.html#l00088">X12RTC_DWA_EDW</a>, <a class="el" href="x12rtc_8h-source.html#l00073">X12RTC_HRA_EHR</a>, <a class="el" href="x12rtc_8h-source.html#l00069">X12RTC_MNA_EMN</a>, <a class="el" href="x12rtc_8h-source.html#l00081">X12RTC_MOA_EMO</a>, <a class="el" href="x12rtc_8h-source.html#l00065">X12RTC_SCA_ESC</a>, and <a class="el" href="x12rtc_8c-source.html#l00207">X12RtcWrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b07d10a89ab2a8815997e3c2dd3bf41e"></a><!-- doxytag: member="x12rtc.c::X12RtcGetStatus" ref="b07d10a89ab2a8815997e3c2dd3bf41e" args="(uint32_t *sflgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcGetStatus           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>sflgs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Query RTC status flags. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#4ef299e140a7550b55bd50dbeb34c985" title="Query status flags from the registered RTC.">NutRtcGetStatus()</a>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sflgs</em>&nbsp;</td><td>Points to an unsigned long that receives the status flags.<ul>
<li>Bit 0: Power fail.</li><li>Bit 5: Alarm 0 occured.</li><li>Bit 6: Alarm 1 occured.</li></ul>
</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00415">415</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="x12rtc_8h-source.html#l00154">X12RTC_SR</a>, and <a class="el" href="x12rtc_8c-source.html#l00174">X12RtcReadRegs()</a>.</p>

<p>Referenced by <a class="el" href="x12rtc_8c-source.html#l00546">X12Init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1407db5b616d125020d843d602caaafb"></a><!-- doxytag: member="x12rtc.c::X12RtcClearStatus" ref="1407db5b616d125020d843d602caaafb" args="(uint32_t sflgs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12RtcClearStatus           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>sflgs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear RTC status flags. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#d02126b88063e2d99c13b5fdfc380cfe" title="Clear status flags of the registered RTC.">NutRtcClearStatus()</a>.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sflgs</em>&nbsp;</td><td>Status flags to clear.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Always 0. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00436">436</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="8236fbe59011df5bc9db072de31128c3"></a><!-- doxytag: member="x12rtc.c::X12EepromRead" ref="8236fbe59011df5bc9db072de31128c3" args="(unsigned int addr, void *buff, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12EepromRead           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read contents from non-volatile EEPROM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Start location. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Points to a buffer that receives the contents. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Number of bytes to read.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00463">463</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="x12rtc_8c-source.html#l00105">I2C_SLA_EEPROM</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="nvmem_8c-source.html#l00105">NutNvMemLoad()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bee38edf014cf9a82b94c2e0a52d895e"></a><!-- doxytag: member="x12rtc.c::X12EepromWrite" ref="bee38edf014cf9a82b94c2e0a52d895e" args="(unsigned int addr, CONST void *buff, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12EepromWrite           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Store buffer contents in non-volatile EEPROM. 
<p>
The EEPROM of the X122x has a capacity of 512 bytes, while the X1286 is able to store 32 kBytes.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Storage start location. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Points to a buffer that contains the bytes to store. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Number of valid bytes in the buffer.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00488">488</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="arm_8h-source.html#l00143">CONST</a>, <a class="el" href="x12rtc_8c-source.html#l00109">EEPROM_PAGE_SIZE</a>, <a class="el" href="icc_8h-source.html#l00145">free</a>, <a class="el" href="x12rtc_8c-source.html#l00105">I2C_SLA_EEPROM</a>, <a class="el" href="icc_8h-source.html#l00142">malloc</a>, <a class="el" href="memcpy_8c-source.html#l00114">memcpy()</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="nvmem_8c-source.html#l00136">NutNvMemSave()</a>.</p>

</div>
</div><p>
<a class="anchor" name="305d0637a6a98425e7a28badcefa0466"></a><!-- doxytag: member="x12rtc.c::X12Init" ref="305d0637a6a98425e7a28badcefa0466" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int X12Init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the interface to an Intersil X12xx hardware clock. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000013">Deprecated:</a></b></dt><dd>New applications must use <a class="el" href="rtc_8h.html#c47307585fae3e6632d0253eb493c0f4" title="Register a specified RTC.">NutRegisterRtc()</a>.</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00546">546</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

<p>References <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, <a class="el" href="icc_8h-source.html#l00136">printf</a>, <a class="el" href="twif_8c-source.html#l00902">TwInit()</a>, <a class="el" href="x12rtc_8h-source.html#l00148">X128xRTC_SSEC</a>, <a class="el" href="x12rtc_8c-source.html#l00415">X12RtcGetStatus()</a>, and <a class="el" href="x12rtc_8c-source.html#l00174">X12RtcReadRegs()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="8ea7ee804bfcd8c92052c34e8bc173fb"></a><!-- doxytag: member="x12rtc.c::rtcX12x6" ref="8ea7ee804bfcd8c92052c34e8bc173fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTRTC <a class="el" href="x12rtc_8c.html#8ea7ee804bfcd8c92052c34e8bc173fb">rtcX12x6</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="x12rtc_8h.html#305d0637a6a98425e7a28badcefa0466" title="Initialize the interface to an Intersil X12xx hardware clock.">X12Init</a>,            
    <a class="code" href="x12rtc_8h.html#064966fba1b531fd7ccd2b64ae5c521b" title="Get date and time from an X12xx hardware clock.">X12RtcGetClock</a>,     
    <a class="code" href="x12rtc_8h.html#5d3fff18c845694ea7c770e20b243102" title="Set an X12xx hardware clock.">X12RtcSetClock</a>,     
    <a class="code" href="x12rtc_8h.html#b57af922d4203f808a76188b54fa3937" title="Get alarm date and time of an X12xx hardware clock.">X12RtcGetAlarm</a>,     
    <a class="code" href="x12rtc_8h.html#896520f5d3dc5c6997ff5eaff180ef91" title="Set alarm of an X12xx hardware clock.">X12RtcSetAlarm</a>,     
    <a class="code" href="x12rtc_8h.html#b07d10a89ab2a8815997e3c2dd3bf41e" title="Query RTC status flags.">X12RtcGetStatus</a>,    
    <a class="code" href="x12rtc_8h.html#1407db5b616d125020d843d602caaafb" title="Clear RTC status flags.">X12RtcClearStatus</a>   
}
</pre></div>
<p>Definition at line <a class="el" href="x12rtc_8c-source.html#l00443">443</a> of file <a class="el" href="x12rtc_8c-source.html">x12rtc.c</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
