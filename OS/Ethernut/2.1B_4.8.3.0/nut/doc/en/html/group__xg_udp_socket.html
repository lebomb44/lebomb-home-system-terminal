<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>UDP Sockets<br>
<small>
[<a class="el" href="group__xg_socket.html">Socket API</a>]</small>
</h1>Application interface for UDP sockets.  
<a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
Collaboration diagram for UDP Sockets:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__xg_udp_socket.png" border="0" alt="" usemap="#group____xg__udp__socket_map">
<map name="group____xg__udp__socket_map">
<area shape="rect" href="group__xg_socket.html" title="Nut/Net Socket Interface." alt="Socket API" coords="19,5,96,26"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structudp__socket.html">UDPSOCKET</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">UDP socket information structure.  <a href="structudp__socket.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UDPSOCKET *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d">NutUdpCreateSocket</a> (<a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a UDP socket.  <a href="#ge3f0a4c71eecf9a01920852dd0f0592d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g10191929e17f17de9f49c5b1f8822154">NutUdpSendTo</a> (UDPSOCKET *sock, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> addr, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> port, void *data, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a UDP datagram.  <a href="#g10191929e17f17de9f49c5b1f8822154"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g6b8b9b8ddce0e1024f75c7575d8c9e3b">NutUdpReceiveFrom</a> (UDPSOCKET *sock, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *addr, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> *port, void *data, int size, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive a UDP datagram.  <a href="#g6b8b9b8ddce0e1024f75c7575d8c9e3b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g73efaff2acbe9b93f6a27a643471ef63">NutUdpDestroySocket</a> (UDPSOCKET *sock)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close UDP socket.  <a href="#g73efaff2acbe9b93f6a27a643471ef63"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g1cc6c30fe6d110875fc592b09d986926">NutUdpError</a> (UDPSOCKET *sock, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *addr, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> *port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return specific code of the last error and the IP address / port of the host to which the communication failed.  <a href="#g1cc6c30fe6d110875fc592b09d986926"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UDPSOCKET *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g2680591101bc19cee587830f217aeff6">NutUdpFindSocket</a> (<a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Find a matching socket.  <a href="#g2680591101bc19cee587830f217aeff6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g2051b9300c656a4e01b964d054f0a9ec">NutUdpSetSockOpt</a> (UDPSOCKET *sock, int optname, CONST void *optval, int optlen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set value of a UDP socket option.  <a href="#g2051b9300c656a4e01b964d054f0a9ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g47f30a0bb47b1100f0dedd0e5bea6ba2">NutUdpGetSockOpt</a> (UDPSOCKET *sock, int optname, void *optval, int optlen)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a UDP socket option value.  <a href="#g47f30a0bb47b1100f0dedd0e5bea6ba2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#g1bc87627874f208f7b5524ccd8dc0843">NutUdpSetSocketError</a> (UDPSOCKET *sock, <a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> remote_addr, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> remote_port, <a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> error)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a UDP socket error.  <a href="#g1bc87627874f208f7b5524ccd8dc0843"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">UDPSOCKET *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_udp_socket.html#gc2ca0d87aba4402d19cecbc63b1f159c">udpSocketList</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Application interface for UDP sockets. 
<p>
UDP server and client applications typically use this order of API calls<ul>
<li><a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a></li><li><a class="el" href="group__xg_udp_socket.html#g10191929e17f17de9f49c5b1f8822154" title="Send a UDP datagram.">NutUdpSendTo()</a>, <a class="el" href="group__xg_udp_socket.html#g6b8b9b8ddce0e1024f75c7575d8c9e3b" title="Receive a UDP datagram.">NutUdpReceiveFrom()</a></li><li><a class="el" href="group__xg_udp_socket.html#g73efaff2acbe9b93f6a27a643471ef63" title="Close UDP socket.">NutUdpDestroySocket()</a></li></ul>
<p>
Assigning a stream to a UDP socket is not supported. Applications must use <a class="el" href="group__xg_udp_socket.html#g10191929e17f17de9f49c5b1f8822154" title="Send a UDP datagram.">NutUdpSendTo()</a> and <a class="el" href="group__xg_udp_socket.html#g6b8b9b8ddce0e1024f75c7575d8c9e3b" title="Receive a UDP datagram.">NutUdpReceiveFrom()</a>.<p>
For historical reasons, Nut/Net buffers only the last incoming UDP datagram for a specific port by default. Any previously received datagram will be discarded, if it hasn't been passed to the application in the meantime. Most applications will run fine with this. But it will fail for example, if more than one response is expected on a previously broadcasted request. This problem can be solved by calling <a class="el" href="group__xg_udp_socket.html#g2051b9300c656a4e01b964d054f0a9ec" title="Set value of a UDP socket option.">NutUdpSetSockOpt()</a> to specify a receive buffer size.<p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="socket_8h.html" title="UDP and TCP socket interface definitions.">sys/socket.h</a>&gt;</span>

 ...

 UDPSOCKET *sock;
 <a class="code" href="group__xg_nut_o_s.html#ga1a19deefc008737e6397f44d983cfd4" title="Unsigned 16-bit value.">u_short</a> udp_bufsiz = 1024;

 ...

 sock = <a class="code" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket</a>(20191);
 <a class="code" href="group__xg_udp_socket.html#g2051b9300c656a4e01b964d054f0a9ec" title="Set value of a UDP socket option.">NutUdpSetSockOpt</a>(sock, <a class="code" href="socket_8h.html#0db12e960ac303030400d9fd95391b52" title="Receive buffer size.">SO_RCVBUF</a>, &amp;udp_bufsiz, <span class="keyword">sizeof</span>(udp_bufsiz));
</pre></div><p>
Nut/Net supports connectionless UDP sockets only. A Berkley like bind call is not available.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>There is no similar call like <a class="el" href="group__xg_tcp_socket.html#g3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a> available for UDP. </dd></dl>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ge3f0a4c71eecf9a01920852dd0f0592d"></a><!-- doxytag: member="udpsock.c::NutUdpCreateSocket" ref="ge3f0a4c71eecf9a01920852dd0f0592d" args="(uint16_t port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UDPSOCKET* NutUdpCreateSocket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>port</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create a UDP socket. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>Server applications provide the local port number with this parameter. Client applications should pass zero.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Socket descriptor of the newly created UDP socket or 0 if there is not enough memory left. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00195">195</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="icc_8h-source.html#l00143">calloc</a>, <a class="el" href="types_8h-source.html#l00321">htons</a>, <a class="el" href="in_8h-source.html#l00133">IPPROTO_UDP</a>, <a class="el" href="ipdemux_8c-source.html#l00120">NutRegisterIpHandler()</a>, <a class="el" href="udpin_8c-source.html#l00158">NutUdpInput()</a>, and <a class="el" href="udpsock_8c-source.html#l00180">udpSocketList</a>.</p>

<p>Referenced by <a class="el" href="discover_8c-source.html#l00210">DiscoveryResponder()</a>, <a class="el" href="snmpd_8c-source.html#l00118">main()</a>, <a class="el" href="dhcpc_8c-source.html#l01353">NutDhcpClient()</a>, <a class="el" href="resolv_8c-source.html#l00474">NutDnsGetResource()</a>, <a class="el" href="sntp_8c-source.html#l00165">NutSNTPGetTime()</a>, <a class="el" href="wins_8c-source.html#l00093">NutWinsNameQuery()</a>, and <a class="el" href="syslog_8c-source.html#l00403">openlog()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g10191929e17f17de9f49c5b1f8822154"></a><!-- doxytag: member="udpsock.c::NutUdpSendTo" ref="g10191929e17f17de9f49c5b1f8822154" args="(UDPSOCKET *sock, uint32_t addr, uint16_t port, void *data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpSendTo           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a UDP datagram. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>IP address of the remote host in network byte order. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>Remote port number in host byte order. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to a buffer containing the data to send. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Number of bytes to be sent.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. The specific error code can be retrieved by calling <a class="el" href="group__xg_udp_socket.html#g1cc6c30fe6d110875fc592b09d986926" title="Return specific code of the last error and the IP address / port of the host to which...">NutUdpError()</a>. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00241">241</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h-source.html#l00065">ENOMEM</a>, <a class="el" href="memcpy_8c-source.html#l00114">memcpy()</a>, <a class="el" href="netbuf_8h-source.html#l00132">NBAF_APPLICATION</a>, <a class="el" href="netbuf_8c-source.html#l00173">NutNetBufAlloc()</a>, <a class="el" href="netbuf_8c-source.html#l00299">NutNetBufFree()</a>, and <a class="el" href="udpout_8c-source.html#l00152">NutUdpOutput()</a>.</p>

<p>Referenced by <a class="el" href="discover_8c-source.html#l00210">DiscoveryResponder()</a>, <a class="el" href="resolv_8c-source.html#l00474">NutDnsGetResource()</a>, <a class="el" href="sntp_8c-source.html#l00165">NutSNTPGetTime()</a>, <a class="el" href="wins_8c-source.html#l00093">NutWinsNameQuery()</a>, <a class="el" href="snmp__agent_8c-source.html#l00463">SnmpAgent()</a>, <a class="el" href="syslog_8c-source.html#l00142">vsyslog()</a>, and <a class="el" href="syslog_8c-source.html#l00242">vsyslog_P()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g6b8b9b8ddce0e1024f75c7575d8c9e3b"></a><!-- doxytag: member="udpsock.c::NutUdpReceiveFrom" ref="g6b8b9b8ddce0e1024f75c7575d8c9e3b" args="(UDPSOCKET *sock, uint32_t *addr, uint16_t *port, void *data, int size, uint32_t timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpReceiveFrom           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> *&nbsp;</td>
          <td class="paramname"> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receive a UDP datagram. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>IP address of the remote host in network byte order. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>Remote port number in host byte order. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to the buffer that receives the data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of the buffer that receives the data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>Maximum number of milliseconds to wait.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of bytes received, if successful. The return value &lt; 0 indicates an error. The specific error code can be retrieved by calling <a class="el" href="group__xg_udp_socket.html#g1cc6c30fe6d110875fc592b09d986926" title="Return specific code of the last error and the IP address / port of the host to which...">NutUdpError()</a>.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Timeout is limited to the granularity of the system timer. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00282">282</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="types_8h-source.html#l00321">htons</a>, <a class="el" href="memcpy_8c-source.html#l00114">memcpy()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="netbuf_8c-source.html#l00299">NutNetBufFree()</a>, and <a class="el" href="netinet_2udp_8h-source.html#l00119">UDPHDR::uh_sport</a>.</p>

<p>Referenced by <a class="el" href="discover_8c-source.html#l00210">DiscoveryResponder()</a>, <a class="el" href="resolv_8c-source.html#l00474">NutDnsGetResource()</a>, <a class="el" href="sntp_8c-source.html#l00165">NutSNTPGetTime()</a>, <a class="el" href="wins_8c-source.html#l00093">NutWinsNameQuery()</a>, and <a class="el" href="snmp__agent_8c-source.html#l00463">SnmpAgent()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g73efaff2acbe9b93f6a27a643471ef63"></a><!-- doxytag: member="udpsock.c::NutUdpDestroySocket" ref="g73efaff2acbe9b93f6a27a643471ef63" args="(UDPSOCKET *sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpDestroySocket           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close UDP socket. 
<p>
The memory occupied by the socket is immediately released after calling this function. The application must not use the socket after this call.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00339">339</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="icc_8h-source.html#l00145">free</a>, <a class="el" href="netbuf_8c-source.html#l00299">NutNetBufFree()</a>, and <a class="el" href="udpsock_8c-source.html#l00180">udpSocketList</a>.</p>

<p>Referenced by <a class="el" href="syslog_8c-source.html#l00434">closelog()</a>, <a class="el" href="snmpd_8c-source.html#l00118">main()</a>, <a class="el" href="dhcpc_8c-source.html#l01353">NutDhcpClient()</a>, <a class="el" href="resolv_8c-source.html#l00474">NutDnsGetResource()</a>, and <a class="el" href="sntp_8c-source.html#l00165">NutSNTPGetTime()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1cc6c30fe6d110875fc592b09d986926"></a><!-- doxytag: member="udpsock.c::NutUdpError" ref="g1cc6c30fe6d110875fc592b09d986926" args="(UDPSOCKET *sock, uint32_t *addr, uint16_t *port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpError           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> *&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return specific code of the last error and the IP address / port of the host to which the communication failed. 
<p>
Possible error codes are:<ul>
<li>ENOTSOCK: Socket operation on non-socket</li><li>EMSGSIZE: Message too long</li><li>ENOPROTOOPT: Protocol not available</li><li>EOPNOTSUPP: Operation not supported on socket</li><li>ENETUNREACH: Network is unreachable</li><li>ECONNREFUSED: Connection refused</li><li>EHOSTDOWN: Host is down</li><li>EHOSTUNREACH: No route to host</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>IP address of the remote host in network byte order. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>Remote port number in host byte order.</td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000042">Todo:</a></b></dt><dd>Not all error codes are properly set right now. Some socket functions return an error without setting an error code. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00391">391</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h-source.html#l00098">ENOTSOCK</a>, and <a class="el" href="types_8h-source.html#l00339">ntohs</a>.</p>

</div>
</div><p>
<a class="anchor" name="g2680591101bc19cee587830f217aeff6"></a><!-- doxytag: member="udpsock.c::NutUdpFindSocket" ref="g2680591101bc19cee587830f217aeff6" args="(uint16_t port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UDPSOCKET* NutUdpFindSocket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>port</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Find a matching socket. 
<p>
Loop through all sockets and find a matching one.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Applications typically do not need to call this function.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>Local port number.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Socket descriptor. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00425">425</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="udpsock_8c-source.html#l00180">udpSocketList</a>.</p>

<p>Referenced by <a class="el" href="udpin_8c-source.html#l00158">NutUdpInput()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g2051b9300c656a4e01b964d054f0a9ec"></a><!-- doxytag: member="udpsock.c::NutUdpSetSockOpt" ref="g2051b9300c656a4e01b964d054f0a9ec" args="(UDPSOCKET *sock, int optname, CONST void *optval, int optlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpSetSockOpt           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&nbsp;</td>
          <td class="paramname"> <em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>optlen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set value of a UDP socket option. 
<p>
The following values can be set:<p>
<ul>
<li><a class="el" href="socket_8h.html#0db12e960ac303030400d9fd95391b52" title="Receive buffer size.">SO_RCVBUF</a> Socket input buffer size (<a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>).</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optname</em>&nbsp;</td><td>Option to set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optval</em>&nbsp;</td><td>Pointer to the value. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optlen</em>&nbsp;</td><td>Length of the value. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00453">453</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="socket_8h-source.html#l00163">SO_RCVBUF</a>.</p>

<p>Referenced by <a class="el" href="discover_8c-source.html#l00210">DiscoveryResponder()</a>, <a class="el" href="snmpd_8c-source.html#l00118">main()</a>, <a class="el" href="dhcpc_8c-source.html#l01353">NutDhcpClient()</a>, and <a class="el" href="sntp_8c-source.html#l00165">NutSNTPGetTime()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g47f30a0bb47b1100f0dedd0e5bea6ba2"></a><!-- doxytag: member="udpsock.c::NutUdpGetSockOpt" ref="g47f30a0bb47b1100f0dedd0e5bea6ba2" args="(UDPSOCKET *sock, int optname, void *optval, int optlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpGetSockOpt           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>optlen</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get a UDP socket option value. 
<p>
The following values can be set:<p>
<ul>
<li><a class="el" href="socket_8h.html#0db12e960ac303030400d9fd95391b52" title="Receive buffer size.">SO_RCVBUF</a> Socket input buffer size (<a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>).</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optname</em>&nbsp;</td><td>Option to get. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optval</em>&nbsp;</td><td>Points to a buffer receiving the value. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>optlen</em>&nbsp;</td><td>Length of the value buffer.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00490">490</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="socket_8h-source.html#l00163">SO_RCVBUF</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1bc87627874f208f7b5524ccd8dc0843"></a><!-- doxytag: member="udpsock.c::NutUdpSetSocketError" ref="g1bc87627874f208f7b5524ccd8dc0843" args="(UDPSOCKET *sock, uint32_t remote_addr, uint16_t remote_port, uint16_t error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutUdpSetSocketError           </td>
          <td>(</td>
          <td class="paramtype">UDPSOCKET *&nbsp;</td>
          <td class="paramname"> <em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>remote_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>remote_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&nbsp;</td>
          <td class="paramname"> <em>error</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set a UDP socket error. 
<p>
This function should only be used together (and from) the <a class="el" href="structicmp.html" title="ICMP protocol header structure.">icmp</a> input routine<p>
The following values can be set:<p>
<ul>
<li><a class="el" href="errno_8h.html#53e186028fc992c3341ccb0d4d239b24">EHOSTUNREACH</a> Host is unreachable</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sock</em>&nbsp;</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_udp_socket.html#ge3f0a4c71eecf9a01920852dd0f0592d" title="Create a UDP socket.">NutUdpCreateSocket()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>remote_addr</em>&nbsp;</td><td>remote <a class="el" href="structip.html" title="Structure of an internet header.">ip</a> address in network byte order </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>remote_port</em>&nbsp;</td><td>remote port in network byte order </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error</em>&nbsp;</td><td>Error number.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00530">530</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>References <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="gc2ca0d87aba4402d19cecbc63b1f159c"></a><!-- doxytag: member="udpsock.c::udpSocketList" ref="gc2ca0d87aba4402d19cecbc63b1f159c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UDPSOCKET* <a class="el" href="group__xg_udp_socket.html#gc2ca0d87aba4402d19cecbc63b1f159c">udpSocketList</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Global linked list of all UDP sockets. 
<p>Definition at line <a class="el" href="udpsock_8c-source.html#l00180">180</a> of file <a class="el" href="udpsock_8c-source.html">udpsock.c</a>.</p>

<p>Referenced by <a class="el" href="netdebug_8c-source.html#l00173">NutDumpSocketList()</a>, <a class="el" href="udpsock_8c-source.html#l00195">NutUdpCreateSocket()</a>, <a class="el" href="udpsock_8c-source.html#l00339">NutUdpDestroySocket()</a>, and <a class="el" href="udpsock_8c-source.html#l00425">NutUdpFindSocket()</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
