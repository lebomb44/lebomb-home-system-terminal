<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>Thread Management<br>
<small>
[<a class="el" href="group__xg_nut_o_s.html">Nut/OS API</a>]</small>
</h1>Cooperative multi-threading support.  
<a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
Collaboration diagram for Thread Management:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__xg_thread.png" border="0" alt="" usemap="#group____xg__thread_map">
<map name="group____xg__thread_map">
<area shape="rect" href="group__xg_nut_o_s.html" title="Operating System API." alt="Nut/OS API" coords="19,5,99,26"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___n_u_t_t_h_r_e_a_d_i_n_f_o.html">NUTTHREADINFO</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread information structure.  <a href="struct___n_u_t_t_h_r_e_a_d_i_n_f_o.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g4d2458fb9ec9d926a6f87706b19e7e06">NutThreadAddPriQueue</a> (NUTTHREADINFO *td, NUTTHREADINFO *volatile *tqpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a thread to a prioritiy ordered queue.  <a href="#g4d2458fb9ec9d926a6f87706b19e7e06"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#ge45ebad9f604755d5c5ba8adaf9e4f89">NutThreadRemoveQueue</a> (NUTTHREADINFO *td, NUTTHREADINFO *volatile *tqpp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove a thread from a specified queue.  <a href="#ge45ebad9f604755d5c5ba8adaf9e4f89"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gabfac60c4d51b57c2dc422d09a69df5b">NutThreadResume</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Continue with the highest priority thread, which is ready to run.  <a href="#gabfac60c4d51b57c2dc422d09a69df5b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g8730ce8319ffcb5e14a413458125e41a">NutThreadWake</a> (<a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a> timer, <a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a> th)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume a previously suspended thread.  <a href="#g8730ce8319ffcb5e14a413458125e41a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g075836f9a2596c5983b7ba88420afd11">NutThreadYield</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Give up the CPU.  <a href="#g075836f9a2596c5983b7ba88420afd11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g8ebe134e9c404072584e80fb8d7e8985">NutThreadSetPriority</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> level)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the current thread's priority.  <a href="#g8ebe134e9c404072584e80fb8d7e8985"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gd86d73178ce22d0a32ae83ec775c4722">NutThreadExit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End the current thread.  <a href="#gd86d73178ce22d0a32ae83ec775c4722"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gba085dddcb4bf80a0b246bd06618d740">NutThreadDestroy</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free a thread that was previously killed and release memory back to the OS.  <a href="#gba085dddcb4bf80a0b246bd06618d740"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gf8e9b69ee0082bcdb00fd6cdb68f4136">NutThreadKill</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Kill the running thread.  <a href="#gf8e9b69ee0082bcdb00fd6cdb68f4136"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g175aed2a498e36845b8cbfdd99731f75">GetThreadByName</a> (char *name)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Query handle of a thread with a specific name.  <a href="#g175aed2a498e36845b8cbfdd99731f75"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTTHREADINFO *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g1308a2cb119d012de42abc74121c5b06">runningThread</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Currently running thread.  <a href="#g1308a2cb119d012de42abc74121c5b06"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTTHREADINFO *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gac039e42bf2cb431a4bbce9fe50c577b">killedThread</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread to be killed.  <a href="#gac039e42bf2cb431a4bbce9fe50c577b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTTHREADINFO *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#g4795eff325a697d9e5d1cddaf81a251e">nutThreadList</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of all created threads.  <a href="#g4795eff325a697d9e5d1cddaf81a251e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTTHREADINFO *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_thread.html#gc3d0eb03ee830f18f4b8e2c7deaaa4f1">runQueue</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of ready-to-run threads.  <a href="#gc3d0eb03ee830f18f4b8e2c7deaaa4f1"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Cooperative multi-threading support. 
<p>
<a class="anchor" name="xrThread"></a> Typically Nut/OS is at its most useful where there are several concurrent tasks that need to be undertaken at the same time. To support this requirement, Nut/OS offers some kind of light processes called threads. In this context a thread is a sequence of executing software that can be considered to be logically independent from other software that is running on the same CPU.<p>
All threads are executing in the same address space using the same hardware resources, which significantly reduces task switching overhead. Therefore it is important to stop them from causing each other problems. This is particularly an issue where two or more threads need to share a resources like memory locations or peripheral devices.<p>
The system works on the principle that the most urgent thread always runs. One exception to this is if a CPU interrupt arrives and the interrupt has not been disabled. Each thread has a priority which is used to determine how urgent it is. This priority ranges from 0 to 255, with the lowest value indicating the most urgent.<p>
Nut/OS implements cooperative multithreading. That means, that threads are not bound to a fixed timeslice. Unless they are waiting for specific event or explicitely yielding the CPU, they can rely on not being stopped unexpectedly. However, they may be interrupted by hardware interrupt signals. In opposite to pre-emptive multithreading, coorperative multithreading simplifies resource sharing and results in faster and smaller code.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Using the special priority 255 to kill a thread is not required and should be removed.</dd></dl>
To specify a function named Back as an independant thread, one can write <div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="thread_8h.html" title="Thread management definitions.">sys/thread.h</a>&gt;</span>

 <a class="code" href="thread_8h.html#9e196c330bbf6578b06f412df8d19f4c" title="Macro for thread entry definitions.">THREAD</a>(Back, arg)
 {
     <span class="keywordflow">for</span> (;;) {
         <a class="code" href="group__xg_timer.html#gfefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep</a>(1000);
     }
 } 
</pre></div><p>
To start this thread, use <div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="thread_8h.html" title="Thread management definitions.">sys/thread.h</a>&gt;</span>

 <span class="comment">/* Other code here... */</span>

 <a class="code" href="group__xg_nut_arch_avr_os_context_gcc.html#g8357f2631f0c0a9444844e5ea64be50d" title="Create a new thread.">NutThreadCreate</a>(<span class="stringliteral">"Bg"</span>, Back, NULL, 512);
 <span class="comment">/* Execution continues here and concurrently in the background thread.</span>
</pre></div><p>
The functions listed below are hardware independant. Additional API calls are located in the architecture dependant sections.<ul>
<li><a class="el" href="group__xg_nut_arch_avr_os_context_gcc.html">AVR with GNU Compiler</a></li><li><a class="el" href="group__xg_nut_arch_avr_os_context_gcc.html">AVR with ImageCraft Compiler</a></li><li><a class="el" href="group__xg_nut_arch_arm_os_context.html">ARM</a></li><li><a class="el" href="group__xg_nut_arch_unix_os_context.html">Emulator (UNIX)</a> </li></ul>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g4d2458fb9ec9d926a6f87706b19e7e06"></a><!-- doxytag: member="thread.c::NutThreadAddPriQueue" ref="g4d2458fb9ec9d926a6f87706b19e7e06" args="(NUTTHREADINFO *td, NUTTHREADINFO *volatile *tqpp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadAddPriQueue           </td>
          <td>(</td>
          <td class="paramtype">NUTTHREADINFO *&nbsp;</td>
          <td class="paramname"> <em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NUTTHREADINFO *volatile *&nbsp;</td>
          <td class="paramname"> <em>tqpp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a thread to a prioritiy ordered queue. 
<p>
Insert the thread into a specified queue behind the last thread with lower or equal priority.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>td</em>&nbsp;</td><td>Pointer to NUTTHREADINFO of the thread to be inserted in the queue. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tqpp</em>&nbsp;</td><td>Pointer to the root of the queue. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00289">289</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="nutdebug_8h-source.html#l00047">NUTASSERT</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00136">NutEnterCritical</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00147">NutExitCritical</a>, and <a class="el" href="event_8h-source.html#l00120">SIGNALED</a>.</p>

<p>Referenced by <a class="el" href="event_8c-source.html#l00384">NutEventPostAsync()</a>, <a class="el" href="event_8c-source.html#l00196">NutEventTimeout()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="context_8c-source.html#l00221">NutThreadCreate()</a>, <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>, <a class="el" href="os_2thread_8c-source.html#l00450">NutThreadWake()</a>, and <a class="el" href="os_2thread_8c-source.html#l00468">NutThreadYield()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ge45ebad9f604755d5c5ba8adaf9e4f89"></a><!-- doxytag: member="thread.c::NutThreadRemoveQueue" ref="ge45ebad9f604755d5c5ba8adaf9e4f89" args="(NUTTHREADINFO *td, NUTTHREADINFO *volatile *tqpp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadRemoveQueue           </td>
          <td>(</td>
          <td class="paramtype">NUTTHREADINFO *&nbsp;</td>
          <td class="paramname"> <em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NUTTHREADINFO *volatile *&nbsp;</td>
          <td class="paramname"> <em>tqpp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Remove a thread from a specified queue. 
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>Depending on the given queue, CPU interrupts must have been disabled before calling this function.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>td</em>&nbsp;</td><td>Pointer to NUTTHREADINFO of the thread to be removed from the queue. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tqpp</em>&nbsp;</td><td>Pointer to the root of the queue. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00341">341</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00136">NutEnterCritical</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00147">NutExitCritical</a>, and <a class="el" href="event_8h-source.html#l00120">SIGNALED</a>.</p>

<p>Referenced by <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>, and <a class="el" href="os_2thread_8c-source.html#l00468">NutThreadYield()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gabfac60c4d51b57c2dc422d09a69df5b"></a><!-- doxytag: member="thread.c::NutThreadResume" ref="gabfac60c4d51b57c2dc422d09a69df5b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadResume           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Continue with the highest priority thread, which is ready to run. 
<p>
If the currently running thread lost its top position in the queue of ready-to-run threads, then the context will be switched.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000030">Todo:</a></b></dt><dd>Removing a single thread from a wait queue only improves context switching, but may result in an event time-out for remaining threads, although events had been posted already. </dd></dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00382">382</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00136">NutEnterCritical</a>, <a class="el" href="event_8c-source.html#l00384">NutEventPostAsync()</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00147">NutExitCritical</a>, <a class="el" href="os_2thread_8c-source.html#l00266">nutThreadList</a>, <a class="el" href="context__gcc_8c-source.html#l00234">NutThreadSwitch()</a>, <a class="el" href="timer_8c-source.html#l00426">NutTimerProcessElapsed()</a>, <a class="el" href="os_2thread_8c-source.html#l00248">runningThread</a>, <a class="el" href="os_2thread_8c-source.html#l00275">runQueue</a>, <a class="el" href="event_8h-source.html#l00120">SIGNALED</a>, <a class="el" href="thread_8h-source.html#l00199">TDS_READY</a>, <a class="el" href="thread_8h-source.html#l00198">TDS_RUNNING</a>, <a class="el" href="tracer_8h-source.html#l00274">TRACE_ADD_ITEM</a>, and <a class="el" href="tracer_8h-source.html#l00077">TRACE_TAG_THREAD_YIELD</a>.</p>

<p>Referenced by <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, and <a class="el" href="os_2thread_8c-source.html#l00468">NutThreadYield()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8730ce8319ffcb5e14a413458125e41a"></a><!-- doxytag: member="thread.c::NutThreadWake" ref="g8730ce8319ffcb5e14a413458125e41a" args="(HANDLE timer, HANDLE th)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadWake           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&nbsp;</td>
          <td class="paramname"> <em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a>&nbsp;</td>
          <td class="paramname"> <em>th</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resume a previously suspended thread. 
<p>
This routine is called by the system when a sleep timer elapses.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>This routine is used as a timer callback for NutSleep implementation Applications typically do not call this function.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer</em>&nbsp;</td><td>Handle of the elapsed timer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>th</em>&nbsp;</td><td>Handle of the thread to wake up.</td></tr>
  </table>
</dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>Used by the timer module. Should be moved there, because not all applications will use of <a class="el" href="group__xg_timer.html#gfefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep()</a>. </dd></dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00450">450</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="nutdebug_8h-source.html#l00047">NUTASSERT</a>, <a class="el" href="os_2thread_8c-source.html#l00289">NutThreadAddPriQueue()</a>, <a class="el" href="os_2thread_8c-source.html#l00275">runQueue</a>, and <a class="el" href="thread_8h-source.html#l00199">TDS_READY</a>.</p>

<p>Referenced by <a class="el" href="osdebug_8c-source.html#l00205">NutDumpTimerList()</a>, and <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g075836f9a2596c5983b7ba88420afd11"></a><!-- doxytag: member="thread.c::NutThreadYield" ref="g075836f9a2596c5983b7ba88420afd11" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadYield           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Give up the CPU. 
<p>
If another thread within the same or higher priority is ready to run, then the current thread is stopped and the other one is started. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00468">468</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00136">NutEnterCritical</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00147">NutExitCritical</a>, <a class="el" href="os_2thread_8c-source.html#l00289">NutThreadAddPriQueue()</a>, <a class="el" href="os_2thread_8c-source.html#l00341">NutThreadRemoveQueue()</a>, <a class="el" href="os_2thread_8c-source.html#l00382">NutThreadResume()</a>, <a class="el" href="arch_2unix_2os_2nutinit_8c-source.html#l00162">NutUnixThreadYieldHook()</a>, <a class="el" href="os_2thread_8c-source.html#l00248">runningThread</a>, and <a class="el" href="os_2thread_8c-source.html#l00275">runQueue</a>.</p>

<p>Referenced by <a class="el" href="event_8c-source.html#l00533">NutEventBroadcast()</a>, <a class="el" href="event_8c-source.html#l00454">NutEventPost()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="arch_2avr_2os_2nutinit_8c-source.html#l00471">NutIdle()</a>, <a class="el" href="msg_8c-source.html#l00197">NutMsgQSend()</a>, <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, <a class="el" href="tcpsock_8c-source.html#l00764">NutTcpReceive()</a>, <a class="el" href="tcpsock_8c-source.html#l00694">NutTcpSend()</a>, <a class="el" href="tcpsm_8c-source.html#l00863">NutTcpStateCloseEvent()</a>, <a class="el" href="portdio_8c-source.html#l00209">ProcessRequests()</a>, and <a class="el" href="rs232d_8c-source.html#l00133">Receiver()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8ebe134e9c404072584e80fb8d7e8985"></a><!-- doxytag: member="thread.c::NutThreadSetPriority" ref="g8ebe134e9c404072584e80fb8d7e8985" args="(uint8_t level)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> NutThreadSetPriority           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>level</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the current thread's priority. 
<p>
The priority of newly created threads is set to 64, but may be changed when the thread starts running.<p>
Changing the priority level to 255 will kill the calling thread.<p>
When another thread with a higher or equal priority is ready to run, the current thread will be stopped and control of the CPU is passed to the other thread.<p>
The function returns the old priority, which makes it easy to temporarily switch to another priority and later set back the old one.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>New priority level or 255 to kill the thread. Zero specifies the highest priority. The idle thread is running at level 254 (lowest priority). Application threads should use levels from 32 to 253.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The old priority of this thread.</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000032">Todo:</a></b></dt><dd>Using a specific priority level for killing a thread is actually not the best idea. <a class="el" href="group__xg_thread.html#gf8e9b69ee0082bcdb00fd6cdb68f4136" title="Kill the running thread.">NutThreadKill()</a> can be used instead. </dd></dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00518">518</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00136">NutEnterCritical</a>, <a class="el" href="include_2arch_2arm_2atom_8h-source.html#l00147">NutExitCritical</a>, <a class="el" href="os_2thread_8c-source.html#l00289">NutThreadAddPriQueue()</a>, <a class="el" href="os_2thread_8c-source.html#l00594">NutThreadKill()</a>, <a class="el" href="os_2thread_8c-source.html#l00341">NutThreadRemoveQueue()</a>, <a class="el" href="context__gcc_8c-source.html#l00234">NutThreadSwitch()</a>, <a class="el" href="os_2thread_8c-source.html#l00248">runningThread</a>, <a class="el" href="os_2thread_8c-source.html#l00275">runQueue</a>, <a class="el" href="thread_8h-source.html#l00199">TDS_READY</a>, <a class="el" href="thread_8h-source.html#l00198">TDS_RUNNING</a>, <a class="el" href="tracer_8h-source.html#l00274">TRACE_ADD_ITEM</a>, and <a class="el" href="tracer_8h-source.html#l00078">TRACE_TAG_THREAD_SETPRIO</a>.</p>

<p>Referenced by <a class="el" href="ahdlcavr_8c-source.html#l00407">AhdlcRx()</a>, <a class="el" href="sja1000_8c-source.html#l00576">CAN_Tx()</a>, <a class="el" href="cs8900_8c-source.html#l00451">CSNICrx()</a>, <a class="el" href="display_8c-source.html#l00073">Displayer()</a>, <a class="el" href="at91__emac_8c-source.html#l00815">EmacRxThread()</a>, <a class="el" href="hxcodec_8c-source.html#l00267">FeederThread()</a>, <a class="el" href="events_8c-source.html#l00078">High()</a>, <a class="el" href="events_8c-source.html#l00099">Low()</a>, <a class="el" href="httpserv_8c-source.html#l00723">main()</a>, <a class="el" href="nicrtl_8c-source.html#l01287">NicRx()</a>, <a class="el" href="ax88796_8c-source.html#l00792">NicRxAsix()</a>, <a class="el" href="lanc111_8c-source.html#l01188">NicRxLanc()</a>, <a class="el" href="arch_2avr_2os_2nutinit_8c-source.html#l00471">NutIdle()</a>, <a class="el" href="tcpsm_8c-source.html#l01643">NutTcpSm()</a>, <a class="el" href="os_2thread_8c-source.html#l00565">NutThreadExit()</a>, <a class="el" href="rs232d_8c-source.html#l00133">Receiver()</a>, <a class="el" href="scanner_8c-source.html#l00263">Scanner()</a>, <a class="el" href="timers_8c-source.html#l00196">Sleeper1()</a>, <a class="el" href="timers_8c-source.html#l00208">Sleeper2()</a>, <a class="el" href="timers_8c-source.html#l00217">Sleeper3()</a>, <a class="el" href="timers_8c-source.html#l00226">Sleeper4()</a>, <a class="el" href="sntp_8c-source.html#l00134">SNTP_resync()</a>, <a class="el" href="threads_8c-source.html#l00098">Thread1()</a>, <a class="el" href="threads_8c-source.html#l00113">Thread2()</a>, <a class="el" href="timers_8c-source.html#l00148">TimerEvent1()</a>, <a class="el" href="timers_8c-source.html#l00160">TimerEvent2()</a>, <a class="el" href="timers_8c-source.html#l00172">TimerEvent3()</a>, and <a class="el" href="timers_8c-source.html#l00184">TimerEvent4()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd86d73178ce22d0a32ae83ec775c4722"></a><!-- doxytag: member="thread.c::NutThreadExit" ref="gd86d73178ce22d0a32ae83ec775c4722" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadExit           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
End the current thread. 
<p>
Terminates the current thread, in due course the memory associated with the thread will be released back to the OS this is done by the idle thread.<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd><a class="el" href="group__xg_thread.html#gf8e9b69ee0082bcdb00fd6cdb68f4136" title="Kill the running thread.">NutThreadKill()</a> can be used instead of setting the priority level to 255. </dd></dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00565">565</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gba085dddcb4bf80a0b246bd06618d740"></a><!-- doxytag: member="thread.c::NutThreadDestroy" ref="gba085dddcb4bf80a0b246bd06618d740" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadDestroy           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Free a thread that was previously killed and release memory back to the OS. 
<p>
Called when another thread is killed and by the idle thread.<p>
Applications generally do not call this function, however you could call it to try to reclaim memory. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00579">579</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="os_2thread_8c-source.html#l00256">killedThread</a>, and <a class="el" href="heap_8h-source.html#l00120">NutStackFree</a>.</p>

<p>Referenced by <a class="el" href="arch_2avr_2os_2nutinit_8c-source.html#l00471">NutIdle()</a>, and <a class="el" href="os_2thread_8c-source.html#l00594">NutThreadKill()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf8e9b69ee0082bcdb00fd6cdb68f4136"></a><!-- doxytag: member="thread.c::NutThreadKill" ref="gf8e9b69ee0082bcdb00fd6cdb68f4136" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutThreadKill           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Kill the running thread. 
<p>
The thread is moved from the schedule que and<p>
Applications generally do not call this function. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00594">594</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="os_2thread_8c-source.html#l00256">killedThread</a>, <a class="el" href="os_2thread_8c-source.html#l00579">NutThreadDestroy()</a>, <a class="el" href="os_2thread_8c-source.html#l00266">nutThreadList</a>, and <a class="el" href="os_2thread_8c-source.html#l00248">runningThread</a>.</p>

<p>Referenced by <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g175aed2a498e36845b8cbfdd99731f75"></a><!-- doxytag: member="thread.c::GetThreadByName" ref="g175aed2a498e36845b8cbfdd99731f75" args="(char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_nut_o_s.html#ga8c0374618b33785ccb02f74bcfebc46">HANDLE</a> GetThreadByName           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Query handle of a thread with a specific name. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>Case sensitive symbolic name of the thread.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Handle of the thread, if it exists. Otherwise NULL is returned.</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000034">Todo:</a></b></dt><dd>Rarely used helper function. Should be placed in a seperate module. </dd></dl>

<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00627">627</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>References <a class="el" href="os_2thread_8c-source.html#l00266">nutThreadList</a>, <a class="el" href="os_2thread_8c-source.html#l00248">runningThread</a>, and <a class="el" href="strcmp_8c-source.html#l00091">strcmp()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="g1308a2cb119d012de42abc74121c5b06"></a><!-- doxytag: member="thread.c::runningThread" ref="g1308a2cb119d012de42abc74121c5b06" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTTHREADINFO* <a class="el" href="group__xg_thread.html#g1308a2cb119d012de42abc74121c5b06">runningThread</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Currently running thread. 
<p>
Pointer to the NUTTHREADINFO structure of the currently running thread. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00248">248</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>Referenced by <a class="el" href="os_2thread_8c-source.html#l00627">GetThreadByName()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="mutex_8c-source.html#l00147">NutMutexDestroy()</a>, <a class="el" href="mutex_8c-source.html#l00096">NutMutexLock()</a>, <a class="el" href="mutex_8c-source.html#l00114">NutMutexTrylock()</a>, <a class="el" href="mutex_8c-source.html#l00130">NutMutexUnlock()</a>, <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, <a class="el" href="context_8c-source.html#l00221">NutThreadCreate()</a>, <a class="el" href="os_2thread_8c-source.html#l00594">NutThreadKill()</a>, <a class="el" href="os_2thread_8c-source.html#l00382">NutThreadResume()</a>, <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>, <a class="el" href="context__gcc_8c-source.html#l00234">NutThreadSwitch()</a>, and <a class="el" href="os_2thread_8c-source.html#l00468">NutThreadYield()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gac039e42bf2cb431a4bbce9fe50c577b"></a><!-- doxytag: member="thread.c::killedThread" ref="gac039e42bf2cb431a4bbce9fe50c577b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTTHREADINFO* <a class="el" href="group__xg_thread.html#gac039e42bf2cb431a4bbce9fe50c577b">killedThread</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Thread to be killed. 
<p>
Pointer to the NUTTHREADINFO structure of the latest killed thread. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00256">256</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>Referenced by <a class="el" href="os_2thread_8c-source.html#l00579">NutThreadDestroy()</a>, and <a class="el" href="os_2thread_8c-source.html#l00594">NutThreadKill()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g4795eff325a697d9e5d1cddaf81a251e"></a><!-- doxytag: member="thread.c::nutThreadList" ref="g4795eff325a697d9e5d1cddaf81a251e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTTHREADINFO* <a class="el" href="group__xg_thread.html#g4795eff325a697d9e5d1cddaf81a251e">nutThreadList</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List of all created threads. 
<p>
Linked list of NUTTHREADINFO structures of all threads. New threads are put in front. This list contains at least two threads, the main application thread followed by the idle thread. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00266">266</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>Referenced by <a class="el" href="os_2thread_8c-source.html#l00627">GetThreadByName()</a>, <a class="el" href="osdebug_8c-source.html#l00155">NutDumpThreadList()</a>, <a class="el" href="context_8c-source.html#l00221">NutThreadCreate()</a>, <a class="el" href="os_2thread_8c-source.html#l00594">NutThreadKill()</a>, <a class="el" href="os_2thread_8c-source.html#l00382">NutThreadResume()</a>, and <a class="el" href="pppc_8c-source.html#l00191">ProcessRequests()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gc3d0eb03ee830f18f4b8e2c7deaaa4f1"></a><!-- doxytag: member="thread.c::runQueue" ref="gc3d0eb03ee830f18f4b8e2c7deaaa4f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTTHREADINFO* <a class="el" href="group__xg_thread.html#gc3d0eb03ee830f18f4b8e2c7deaaa4f1">runQueue</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List of ready-to-run threads. 
<p>
Priority ordered linked list of NUTTHREADINFO structures of all threads which are ready to run. The idle thread will always remain at the end of this list. 
<p>Definition at line <a class="el" href="os_2thread_8c-source.html#l00275">275</a> of file <a class="el" href="os_2thread_8c-source.html">thread.c</a>.</p>

<p>Referenced by <a class="el" href="event_8c-source.html#l00384">NutEventPostAsync()</a>, <a class="el" href="event_8c-source.html#l00196">NutEventTimeout()</a>, <a class="el" href="event_8c-source.html#l00271">NutEventWait()</a>, <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>, <a class="el" href="context_8c-source.html#l00221">NutThreadCreate()</a>, <a class="el" href="os_2thread_8c-source.html#l00382">NutThreadResume()</a>, <a class="el" href="os_2thread_8c-source.html#l00518">NutThreadSetPriority()</a>, <a class="el" href="context__gcc_8c-source.html#l00234">NutThreadSwitch()</a>, <a class="el" href="os_2thread_8c-source.html#l00450">NutThreadWake()</a>, and <a class="el" href="os_2thread_8c-source.html#l00468">NutThreadYield()</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
