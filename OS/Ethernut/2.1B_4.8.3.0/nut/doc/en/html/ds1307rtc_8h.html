<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
  <div class="navpath"><a class="el" href="dir_81006e530ae69d901a01dddafc7fbce4.html">include</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_29e0dcc87985a941e12843c236561edc.html">dev</a>
  </div>
<div class="contents">
<h1>ds1307rtc.h File Reference</h1>
<p>
<a href="ds1307rtc_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#2c741d320b56f39a9e7c21101bc1d6f6">DS1307Init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the interface to an Dallas DS1307 hardware clock.  <a href="#2c741d320b56f39a9e7c21101bc1d6f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#0b4cdae1f8a5df5ab747ca80cb687750">DS1307RtcGetClock</a> (struct <a class="el" href="struct__tm.html">_tm</a> *tm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get date and time from an DS1307 hardware clock.  <a href="#0b4cdae1f8a5df5ab747ca80cb687750"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#e8422297e760d14be878286551bbf8d0">DS1307RtcSetClock</a> (CONST struct <a class="el" href="struct__tm.html">_tm</a> *tm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the DS1307 hardware clock.  <a href="#e8422297e760d14be878286551bbf8d0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#6b166467a8d4a79e5df62d1ceac997df">DS1307RtcReadRegs</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> addr, <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buff, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read RTC registers.  <a href="#6b166467a8d4a79e5df62d1ceac997df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#fbb31e2b47d8493e64a635d8415b22db">DS1307RtcWrite</a> (CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buff, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write to RTC registers.  <a href="#fbb31e2b47d8493e64a635d8415b22db"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#9a3a486dfc29f6dd9d43ab5f35148a55">DS1307RamRead</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> addr, <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *buff, size_t cnt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read contents from DS1307 RAM.  <a href="#9a3a486dfc29f6dd9d43ab5f35148a55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#a91b7b409c77fddf92ec13817012c692">DS1307RamWrite</a> (<a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> addr, CONST void *buff, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store buffer contents in DS1307 RAM.  <a href="#a91b7b409c77fddf92ec13817012c692"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NUTRTC&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="ds1307rtc_8h.html#9d7219e111b2fc079eef9e96ab7e88c9">rtcDs1307</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="2c741d320b56f39a9e7c21101bc1d6f6"></a><!-- doxytag: member="ds1307rtc.h::DS1307Init" ref="2c741d320b56f39a9e7c21101bc1d6f6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307Init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the interface to an Dallas DS1307 hardware clock. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00228">228</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00089">DS1307RtcReadRegs()</a>, <a class="el" href="ds1307rtc_8c-source.html#l00110">DS1307RtcWrite()</a>, and <a class="el" href="twif_8c-source.html#l00902">TwInit()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0b4cdae1f8a5df5ab747ca80cb687750"></a><!-- doxytag: member="ds1307rtc.h::DS1307RtcGetClock" ref="0b4cdae1f8a5df5ab747ca80cb687750" args="(struct _tm *tm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RtcGetClock           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Get date and time from an DS1307 hardware clock. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure that receives the date and time information.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00126">126</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00065">BCD2BIN</a>, <a class="el" href="ds1307rtc_8c-source.html#l00089">DS1307RtcReadRegs()</a>, <a class="el" href="time_8h-source.html#l00098">tm::tm_hour</a>, <a class="el" href="time_8h-source.html#l00099">tm::tm_mday</a>, <a class="el" href="time_8h-source.html#l00097">tm::tm_min</a>, <a class="el" href="time_8h-source.html#l00100">tm::tm_mon</a>, <a class="el" href="time_8h-source.html#l00096">tm::tm_sec</a>, <a class="el" href="time_8h-source.html#l00102">tm::tm_wday</a>, and <a class="el" href="time_8h-source.html#l00101">tm::tm_year</a>.</p>

</div>
</div><p>
<a class="anchor" name="e8422297e760d14be878286551bbf8d0"></a><!-- doxytag: member="ds1307rtc.h::DS1307RtcSetClock" ref="e8422297e760d14be878286551bbf8d0" args="(CONST struct _tm *tm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RtcSetClock           </td>
          <td>(</td>
          <td class="paramtype">CONST struct <a class="el" href="struct__tm.html">_tm</a> *&nbsp;</td>
          <td class="paramname"> <em>tm</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the DS1307 hardware clock. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tm</em>&nbsp;</td><td>Points to a structure which contains the date and time information.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00151">151</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="rtc_8h-source.html#l00070">BIN2BCD</a>, <a class="el" href="ds1307rtc_8c-source.html#l00110">DS1307RtcWrite()</a>, and <a class="el" href="memset_8c-source.html#l00088">memset()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6b166467a8d4a79e5df62d1ceac997df"></a><!-- doxytag: member="ds1307rtc.h::DS1307RtcReadRegs" ref="6b166467a8d4a79e5df62d1ceac997df" args="(uint8_t addr, uint8_t *buff, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RtcReadRegs           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cnt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read RTC registers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>The first register to read. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Pointer to a buffer that receives the register contents. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnt</em>&nbsp;</td><td>The number of registers to read.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00089">89</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00076">I2C_SLA_RTC</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="ds1307rtc_8c-source.html#l00228">DS1307Init()</a>, <a class="el" href="ds1307rtc_8c-source.html#l00178">DS1307RamRead()</a>, and <a class="el" href="ds1307rtc_8c-source.html#l00126">DS1307RtcGetClock()</a>.</p>

</div>
</div><p>
<a class="anchor" name="fbb31e2b47d8493e64a635d8415b22db"></a><!-- doxytag: member="ds1307rtc.h::DS1307RtcWrite" ref="fbb31e2b47d8493e64a635d8415b22db" args="(CONST uint8_t *buff, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RtcWrite           </td>
          <td>(</td>
          <td class="paramtype">CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cnt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write to RTC registers. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>This buffer must contain all bytes to be transfered to the RTC chip, including the register address. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnt</em>&nbsp;</td><td>Number of valid bytes in the buffer.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00110">110</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00076">I2C_SLA_RTC</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

<p>Referenced by <a class="el" href="ds1307rtc_8c-source.html#l00228">DS1307Init()</a>, and <a class="el" href="ds1307rtc_8c-source.html#l00151">DS1307RtcSetClock()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9a3a486dfc29f6dd9d43ab5f35148a55"></a><!-- doxytag: member="ds1307rtc.h::DS1307RamRead" ref="9a3a486dfc29f6dd9d43ab5f35148a55" args="(uint8_t addr, uint8_t *buff, size_t cnt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RamRead           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>cnt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read contents from DS1307 RAM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Start location. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Points to a buffer that receives the contents. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cnt</em>&nbsp;</td><td>Number of bytes to read.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00178">178</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="ds1307rtc_8c-source.html#l00089">DS1307RtcReadRegs()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a91b7b409c77fddf92ec13817012c692"></a><!-- doxytag: member="ds1307rtc.h::DS1307RamWrite" ref="a91b7b409c77fddf92ec13817012c692" args="(uint8_t addr, CONST void *buff, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DS1307RamWrite           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Store buffer contents in DS1307 RAM. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Storage start location. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>Points to a buffer that contains the bytes to store. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Number of valid bytes in the buffer.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00199">199</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

<p>References <a class="el" href="arm_8h-source.html#l00143">CONST</a>, <a class="el" href="icc_8h-source.html#l00145">free</a>, <a class="el" href="ds1307rtc_8c-source.html#l00076">I2C_SLA_RTC</a>, <a class="el" href="icc_8h-source.html#l00142">malloc</a>, <a class="el" href="memcpy_8c-source.html#l00114">memcpy()</a>, <a class="el" href="event_8h-source.html#l00128">NUT_WAIT_INFINITE</a>, and <a class="el" href="twif_8c-source.html#l00535">TwMasterTransact()</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="9d7219e111b2fc079eef9e96ab7e88c9"></a><!-- doxytag: member="ds1307rtc.h::rtcDs1307" ref="9d7219e111b2fc079eef9e96ab7e88c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NUTRTC <a class="el" href="ds1307rtc_8c.html#9d7219e111b2fc079eef9e96ab7e88c9">rtcDs1307</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="ds1307rtc_8c-source.html#l00252">252</a> of file <a class="el" href="ds1307rtc_8c-source.html">ds1307rtc.c</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
