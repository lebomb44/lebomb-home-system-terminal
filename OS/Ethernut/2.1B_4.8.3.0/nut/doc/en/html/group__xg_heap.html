<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>Memory Management<br>
<small>
[<a class="el" href="group__xg_nut_o_s.html">Nut/OS API</a>]</small>
</h1>Dynamic memory management.  
<a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
Collaboration diagram for Memory Management:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__xg_heap.png" border="0" alt="" usemap="#group____xg__heap_map">
<map name="group____xg__heap_map">
<area shape="rect" href="group__xg_nut_o_s.html" title="Operating System API." alt="Nut/OS API" coords="19,5,99,26"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g95d47f91d7f00d4ab87b6e514dec8206">NUTMEM_GUARD_BYTES</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g3078408821f509d0c6a474af8fdfb7fb">NUT_HEAP_OVERHEAD</a>&nbsp;&nbsp;&nbsp;(sizeof(HEAPNODE) - sizeof(HEAPNODE *))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of bytes used for management information.  <a href="#g3078408821f509d0c6a474af8fdfb7fb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g2c0ad5cc2b9531ce041a4f63fa33558a">NUTMEM_HEAPNODE_MIN</a>&nbsp;&nbsp;&nbsp;(sizeof(HEAPNODE) + (2 * NUTMEM_GUARD_BYTES))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Minimum size of a node.  <a href="#g2c0ad5cc2b9531ce041a4f63fa33558a"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g381d0a123dbf80ca3efe2614aa826e08">malloc</a> (size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a block from heap memory.  <a href="#g381d0a123dbf80ca3efe2614aa826e08"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g9f850d0608418aea291e4c0fdab93826">free</a> (void *p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a block to heap memory.  <a href="#g9f850d0608418aea291e4c0fdab93826"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g3a5eee4ee3b9303ceb44857293da7193">realloc</a> (void *ptr, size_t len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reallocate a block from heap memory.  <a href="#g3a5eee4ee3b9303ceb44857293da7193"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#gafc7e58e483aa68c80da6f65a947654e">NutHeapRootAlloc</a> (HEAPNODE **root, size_t size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate a block from heap memory.  <a href="#gafc7e58e483aa68c80da6f65a947654e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g7caa68f9bbfdbe89120bfc3f28e7ec72">NutHeapRootAllocClear</a> (HEAPNODE **root, size_t size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate an initialized block from heap memory.  <a href="#g7caa68f9bbfdbe89120bfc3f28e7ec72"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g8a52ba39e16ce0c7a1580aa3786dac00">NutHeapRootFree</a> (HEAPNODE **root, void *block)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a block to heap memory.  <a href="#g8a52ba39e16ce0c7a1580aa3786dac00"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g61a7eee2b2956792a4ad1f10afd13f24">NutHeapRootAdd</a> (HEAPNODE **root, void *addr, size_t size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new memory region to the heap.  <a href="#g61a7eee2b2956792a4ad1f10afd13f24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#ge5a364b743b23819485c35a39138cbe6">NutHeapRootAvailable</a> (HEAPNODE **root)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the total number of bytes available.  <a href="#ge5a364b743b23819485c35a39138cbe6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#gb0e4cb4b1ec53909f2b3490d3e47bbec">NutHeapRootRegionAvailable</a> (HEAPNODE **root)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the size of the largest block available.  <a href="#gb0e4cb4b1ec53909f2b3490d3e47bbec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g1077ae5e151b81572d13af095d888f2b">NutHeapRootRealloc</a> (HEAPNODE **root, void *block, size_t size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the size of an allocated memory block.  <a href="#g1077ae5e151b81572d13af095d888f2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g1565e611755ab4a029e2a6170d41e5ba">NutHeapCheck</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check consistency of heap.  <a href="#g1565e611755ab4a029e2a6170d41e5ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g323ea4071a4a4dee6757cad26b31bc4b">NutHeapDump</a> (void *stream)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump heap memory to a given stream.  <a href="#g323ea4071a4a4dee6757cad26b31bc4b"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">HEAPNODE *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_heap.html#g7b66edf4f6978637c042968ce1b4ec08">heapFreeList</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">List of free nodes in normal memory.  <a href="#g7b66edf4f6978637c042968ce1b4ec08"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Dynamic memory management. 
<p>
Dynamic memory allocations are made from the heap. The heap is a global resource containing all of the free memory in the system. The heap is handled as a linked list of unused blocks of memory, the so called free-list.<p>
The heap manager uses best fit, address ordered algorithm to keep the free-list as unfragmented as possible. This strategy is intended to ensure that more useful allocations can be made. We end up with relatively few large free blocks rather than lots of small ones. <hr><h2>Define Documentation</h2>
<a class="anchor" name="g95d47f91d7f00d4ab87b6e514dec8206"></a><!-- doxytag: member="heap.c::NUTMEM_GUARD_BYTES" ref="g95d47f91d7f00d4ab87b6e514dec8206" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUTMEM_GUARD_BYTES&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00065">65</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>Referenced by <a class="el" href="heap_8c-source.html#l00201">NutHeapRootAlloc()</a>, <a class="el" href="heap_8c-source.html#l00328">NutHeapRootFree()</a>, and <a class="el" href="heap_8c-source.html#l00501">NutHeapRootRealloc()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g3078408821f509d0c6a474af8fdfb7fb"></a><!-- doxytag: member="heap.c::NUT_HEAP_OVERHEAD" ref="g3078408821f509d0c6a474af8fdfb7fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUT_HEAP_OVERHEAD&nbsp;&nbsp;&nbsp;(sizeof(HEAPNODE) - sizeof(HEAPNODE *))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Number of bytes used for management information. 
<p>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00069">69</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>Referenced by <a class="el" href="heap_8c-source.html#l00201">NutHeapRootAlloc()</a>, <a class="el" href="heap_8c-source.html#l00452">NutHeapRootAvailable()</a>, <a class="el" href="heap_8c-source.html#l00328">NutHeapRootFree()</a>, <a class="el" href="heap_8c-source.html#l00501">NutHeapRootRealloc()</a>, and <a class="el" href="heap_8c-source.html#l00470">NutHeapRootRegionAvailable()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g2c0ad5cc2b9531ce041a4f63fa33558a"></a><!-- doxytag: member="heap.c::NUTMEM_HEAPNODE_MIN" ref="g2c0ad5cc2b9531ce041a4f63fa33558a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUTMEM_HEAPNODE_MIN&nbsp;&nbsp;&nbsp;(sizeof(HEAPNODE) + (2 * NUTMEM_GUARD_BYTES))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Minimum size of a node. 
<p>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00073">73</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>Referenced by <a class="el" href="heap_8c-source.html#l00201">NutHeapRootAlloc()</a>, and <a class="el" href="heap_8c-source.html#l00501">NutHeapRootRealloc()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g381d0a123dbf80ca3efe2614aa826e08"></a><!-- doxytag: member="malloc.c::malloc" ref="g381d0a123dbf80ca3efe2614aa826e08" args="(size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* malloc           </td>
          <td>(</td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate a block from heap memory. 
<p>
This function simply calls <a class="el" href="heap_8h.html#1506e015e92a840d260b05a41df28fcc">NutHeapAlloc()</a>. It overrides the function of the runtime library, when the application is linked with nutcrt or nutcrtf.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Size of the requested memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Pointer to the allocated memory block if the function is successful or NULL if the requested amount of memory is not available. </dd></dl>

<p>Definition at line <a class="el" href="malloc_8c-source.html#l00064">64</a> of file <a class="el" href="malloc_8c-source.html">malloc.c</a>.</p>

<p>References <a class="el" href="errno_8h-source.html#l00065">ENOMEM</a>, <a class="el" href="errno_8c-source.html#l00042">errno</a>, and <a class="el" href="heap_8h-source.html#l00085">NutHeapAlloc</a>.</p>

</div>
</div><p>
<a class="anchor" name="g9f850d0608418aea291e4c0fdab93826"></a><!-- doxytag: member="malloc.c::free" ref="g9f850d0608418aea291e4c0fdab93826" args="(void *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>p</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a block to heap memory. 
<p>
This function simply calls <a class="el" href="heap_8h.html#b275544ee60e3ed63b5d08adba8fa265">NutHeapFree()</a>. It overrides the function of the runtime library, when the application is linked with nutcrt or nutcrtf.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p</em>&nbsp;</td><td>Points to a memory block previously allocated through a call to <a class="el" href="icc_8h.html#cf143577800376dd931c059ecc61ba06">malloc()</a>. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="malloc_8c-source.html#l00084">84</a> of file <a class="el" href="malloc_8c-source.html">malloc.c</a>.</p>

<p>References <a class="el" href="heap_8h-source.html#l00087">NutHeapFree</a>.</p>

</div>
</div><p>
<a class="anchor" name="g3a5eee4ee3b9303ceb44857293da7193"></a><!-- doxytag: member="realloc.c::realloc" ref="g3a5eee4ee3b9303ceb44857293da7193" args="(void *ptr, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* realloc           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reallocate a block from heap memory. 
<p>
This function simply calls <a class="el" href="heap_8h.html#4f896b7cb5c55bc8fd43debc860e5991">NutHeapRealloc()</a>. It overrides the function of the runtime library, when the application is linked with nutcrt or nutcrtf.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ptr</em>&nbsp;</td><td>Pointer to memory block previously allocated with malloc to be reallocated. If this is NULL, a new block is allocated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Size of the requested memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Pointer to the reallocated memory block if the function is successful or NULL if the requested amount of memory is not available. </dd></dl>

<p>Definition at line <a class="el" href="realloc_8c-source.html#l00066">66</a> of file <a class="el" href="realloc_8c-source.html">realloc.c</a>.</p>

<p>References <a class="el" href="errno_8h-source.html#l00065">ENOMEM</a>, <a class="el" href="errno_8c-source.html#l00042">errno</a>, and <a class="el" href="heap_8h-source.html#l00088">NutHeapRealloc</a>.</p>

</div>
</div><p>
<a class="anchor" name="gafc7e58e483aa68c80da6f65a947654e"></a><!-- doxytag: member="heap.c::NutHeapRootAlloc" ref="gafc7e58e483aa68c80da6f65a947654e" args="(HEAPNODE **root, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* NutHeapRootAlloc           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate a block from heap memory. 
<p>
This functions allocates a memory block of the specified size and returns a pointer to that block.<p>
The actual size of the allocated block is larger than the requested size because of space required for maintenance information. This additional information is invisible to the application.<p>
The routine looks for the smallest block that will meet the required size and releases it to the caller. If the block being requested is usefully smaller than the smallest free block then the block from which the request is being met is split in two. The unused portion is put back into the free-list.<p>
The contents of the allocated block is unspecified. To allocate a block with all bytes set to zero use <a class="el" href="heap_8h.html#98db468befde3388574fcc8e53dd41be">NutHeapAllocClear()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>root</em>&nbsp;</td><td>Points to the linked list of free nodes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of the requested memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Pointer to the allocated memory block if the function is successful or NULL if no free block of the requested size is available. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00201">201</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="heap_8c-source.html#l00069">NUT_HEAP_OVERHEAD</a>, <a class="el" href="heap_8c-source.html#l00065">NUTMEM_GUARD_BYTES</a>, <a class="el" href="heap_8c-source.html#l00073">NUTMEM_HEAPNODE_MIN</a>, and <a class="el" href="types_8h-source.html#l00193">NUTMEM_TOP_ALIGN</a>.</p>

<p>Referenced by <a class="el" href="heap_8c-source.html#l00296">NutHeapRootAllocClear()</a>, and <a class="el" href="heap_8c-source.html#l00501">NutHeapRootRealloc()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7caa68f9bbfdbe89120bfc3f28e7ec72"></a><!-- doxytag: member="heap.c::NutHeapRootAllocClear" ref="g7caa68f9bbfdbe89120bfc3f28e7ec72" args="(HEAPNODE **root, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* NutHeapRootAllocClear           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate an initialized block from heap memory. 
<p>
This functions allocates a memory block of the specified size with all bytes initialized to zero and returns a pointer to that block.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>root</em>&nbsp;</td><td>Points to the linked list of free nodes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of the requested memory block.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Pointer to the allocated memory block if the function is successful or NULL if the requested amount of memory is not available. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00296">296</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="memset_8c-source.html#l00088">memset()</a>, and <a class="el" href="heap_8c-source.html#l00201">NutHeapRootAlloc()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8a52ba39e16ce0c7a1580aa3786dac00"></a><!-- doxytag: member="heap.c::NutHeapRootFree" ref="g8a52ba39e16ce0c7a1580aa3786dac00" args="(HEAPNODE **root, void *block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutHeapRootFree           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>block</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a block to heap memory. 
<p>
An application calls this function, when a previously allocated memory block is no longer needed.<p>
The heap manager checks, if the released block adjoins any other free regions. If it does, then the adjacent free regions are joined together to form one larger region.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>root</em>&nbsp;</td><td>Points to the linked list of free nodes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>block</em>&nbsp;</td><td>Points to a memory block previously allocated.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 if the caller tried to free a block which had been previously released, -2 if the block had been corrupted. Furthermore, -3 is returned if block is a NULL pointer, but using this may change as C99 allows this. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00328">328</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="heap_8c-source.html#l00069">NUT_HEAP_OVERHEAD</a>, <a class="el" href="heap_8c-source.html#l00065">NUTMEM_GUARD_BYTES</a>, and <a class="el" href="panic_8c-source.html#l00063">NUTPANIC()</a>.</p>

<p>Referenced by <a class="el" href="heap_8c-source.html#l00435">NutHeapRootAdd()</a>, and <a class="el" href="heap_8c-source.html#l00501">NutHeapRootRealloc()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g61a7eee2b2956792a4ad1f10afd13f24"></a><!-- doxytag: member="heap.c::NutHeapRootAdd" ref="g61a7eee2b2956792a4ad1f10afd13f24" args="(HEAPNODE **root, void *addr, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutHeapRootAdd           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a new memory region to the heap. 
<p>
This function can be called more than once to manage non-continous memory regions. It is automatically called by Nut/OS during initialization.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Start address of the memory region. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Number of bytes of the memory region. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00435">435</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="heap_8c-source.html#l00328">NutHeapRootFree()</a>, <a class="el" href="types_8h-source.html#l00188">NUTMEM_BOTTOM_ALIGN</a>, and <a class="el" href="types_8h-source.html#l00193">NUTMEM_TOP_ALIGN</a>.</p>

</div>
</div><p>
<a class="anchor" name="ge5a364b743b23819485c35a39138cbe6"></a><!-- doxytag: member="heap.c::NutHeapRootAvailable" ref="ge5a364b743b23819485c35a39138cbe6" args="(HEAPNODE **root)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t NutHeapRootAvailable           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the total number of bytes available. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Number of bytes. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00452">452</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="heap_8c-source.html#l00069">NUT_HEAP_OVERHEAD</a>.</p>

</div>
</div><p>
<a class="anchor" name="gb0e4cb4b1ec53909f2b3490d3e47bbec"></a><!-- doxytag: member="heap.c::NutHeapRootRegionAvailable" ref="gb0e4cb4b1ec53909f2b3490d3e47bbec" args="(HEAPNODE **root)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t NutHeapRootRegionAvailable           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the size of the largest block available. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Number of bytes. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00470">470</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="heap_8c-source.html#l00069">NUT_HEAP_OVERHEAD</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1077ae5e151b81572d13af095d888f2b"></a><!-- doxytag: member="heap.c::NutHeapRootRealloc" ref="g1077ae5e151b81572d13af095d888f2b" args="(HEAPNODE **root, void *block, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* NutHeapRootRealloc           </td>
          <td>(</td>
          <td class="paramtype">HEAPNODE **&nbsp;</td>
          <td class="paramname"> <em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Change the size of an allocated memory block. 
<p>
If more memory is requested than available at that block the data is copied to a new, bigger block.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>block</em>&nbsp;</td><td>Points to a previously allocated memory block. If NULL, then this call is equivalent to <a class="el" href="group__xg_heap.html#gafc7e58e483aa68c80da6f65a947654e" title="Allocate a block from heap memory.">NutHeapRootAlloc()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>The requested new size. If 0, then this call is equivalent to <a class="el" href="group__xg_heap.html#g8a52ba39e16ce0c7a1580aa3786dac00" title="Return a block to heap memory.">NutHeapRootFree()</a>.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to the memory block on success or NULL on failures. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00501">501</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="memcpy_8c-source.html#l00114">memcpy()</a>, <a class="el" href="heap_8c-source.html#l00069">NUT_HEAP_OVERHEAD</a>, <a class="el" href="heap_8c-source.html#l00201">NutHeapRootAlloc()</a>, <a class="el" href="heap_8c-source.html#l00328">NutHeapRootFree()</a>, <a class="el" href="heap_8c-source.html#l00065">NUTMEM_GUARD_BYTES</a>, <a class="el" href="heap_8c-source.html#l00073">NUTMEM_HEAPNODE_MIN</a>, and <a class="el" href="types_8h-source.html#l00193">NUTMEM_TOP_ALIGN</a>.</p>

</div>
</div><p>
<a class="anchor" name="g1565e611755ab4a029e2a6170d41e5ba"></a><!-- doxytag: member="heap.c::NutHeapCheck" ref="g1565e611755ab4a029e2a6170d41e5ba" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutHeapCheck           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Check consistency of heap. 
<p>
Right now this function will just return 0 unless NUTDEBUG_HEAP is defined.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>-1 if any error has been detected, 0 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00638">638</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g323ea4071a4a4dee6757cad26b31bc4b"></a><!-- doxytag: member="heap.c::NutHeapDump" ref="g323ea4071a4a4dee6757cad26b31bc4b" args="(void *stream)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutHeapDump           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>stream</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Dump heap memory to a given stream. 
<p>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00657">657</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>References <a class="el" href="fprintf_8c-source.html#l00068">fprintf()</a>, and <a class="el" href="heap_8c-source.html#l00079">heapFreeList</a>.</p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="g7b66edf4f6978637c042968ce1b4ec08"></a><!-- doxytag: member="heap.c::heapFreeList" ref="g7b66edf4f6978637c042968ce1b4ec08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">HEAPNODE* <a class="el" href="group__xg_heap.html#g7b66edf4f6978637c042968ce1b4ec08">heapFreeList</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
List of free nodes in normal memory. 
<p>

<p>Definition at line <a class="el" href="heap_8c-source.html#l00079">79</a> of file <a class="el" href="heap_8c-source.html">heap.c</a>.</p>

<p>Referenced by <a class="el" href="osdebug_8c-source.html#l00262">NutDumpHeap()</a>, and <a class="el" href="heap_8c-source.html#l00657">NutHeapDump()</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
