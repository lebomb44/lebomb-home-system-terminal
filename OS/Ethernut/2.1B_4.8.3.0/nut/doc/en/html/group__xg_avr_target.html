<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>Nut/OS API</title>
    <link href="nut_en.css" rel="stylesheet" type="text/css">
    <link href="nut_entabs.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="contents">
<h1>AVR Target Programming<br>
<small>
[<a class="el" href="group__xg_hardware_avr.html">Special Hardware</a>]</small>
</h1>AVR target programming via SPI.  
<a href="#_details">More...</a>
<p>

<p>
<div class="dynheader">
Collaboration diagram for AVR Target Programming:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__xg_avr_target.png" border="0" alt="" usemap="#group____xg__avr__target_map">
<map name="group____xg__avr__target_map">
<area shape="rect" href="group__xg_hardware_avr.html" title="Support routines for direct hardware access." alt="Special Hardware" coords="19,5,131,26"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g94ed7c8bf54d7f8798e9b2842083011a">AVRTARGET_CHIPERASE_TIMEOUT</a>&nbsp;&nbsp;&nbsp;200</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum time (in milliseconds) to wait for chip erase done.  <a href="#g94ed7c8bf54d7f8798e9b2842083011a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g10f22257d6d51d985a6e3c261d39ce6a">AVRTARGET_PAGEWRITE_TIMEOUT</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum time (in milliseconds) to wait for page write done.  <a href="#g10f22257d6d51d985a6e3c261d39ce6a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gbbaf412b22afc3f95cfb15105e515669">AVR_FUSES_NEVER_PROG</a>&nbsp;&nbsp;&nbsp;0x00F88062UL</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Safe fuse programming mask.  <a href="#gbbaf412b22afc3f95cfb15105e515669"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#ga37a0d5891af4cbabf364f651c560cae">AVR_FUSES_ALWAYS_PROG</a>&nbsp;&nbsp;&nbsp;0x0000201DUL</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Safe fuse unprogramming mask.  <a href="#ga37a0d5891af4cbabf364f651c560cae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gd263c9d06c6b300d1a461c500a7d4fa3">AVRTARGET_SPI_MODE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gf7ebc0f40a59398183952cb3c2a66016">AVRTARGET_SPI_RATE</a>&nbsp;&nbsp;&nbsp;500000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gea68f8ac7742744778298a48a128c42a">AVRTARGET_NO_SPI_DEVICE</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g54e6496a5d012f337b9588e0df7b6518">AvrTargetInit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize programming interface.  <a href="#g54e6496a5d012f337b9588e0df7b6518"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g3743f56c58ddecff1147c2798103a4cb">AvrTargetSelect</a> (<a class="el" href="group__xg_nut_o_s.html#ge15262a08334eeeacd9a24f219a89d46">ureg_t</a> act)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set or clear the chip select line.  <a href="#g3743f56c58ddecff1147c2798103a4cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g850b833859005617c028ecfdedbe6afb">AvrTargetReset</a> (<a class="el" href="group__xg_nut_o_s.html#ge15262a08334eeeacd9a24f219a89d46">ureg_t</a> act)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set or release the target's reset line.  <a href="#g850b833859005617c028ecfdedbe6afb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gdeb5307b6b76ab9b778595b077a9c035">AvrTargetCmd</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> cmd)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send programming command and return response.  <a href="#gdeb5307b6b76ab9b778595b077a9c035"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g8033081dd65a824f3b3ddd05c5c5a2b6">AvrTargetProgEnable</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable target's programming mode.  <a href="#g8033081dd65a824f3b3ddd05c5c5a2b6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g9846fec6ec027f9495568f6fcceb7772">AvrTargetSignature</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the target's signature.  <a href="#g9846fec6ec027f9495568f6fcceb7772"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#ga37527a6c0d14879adcb60aab7dace26">AvrTargetFusesRead</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve the target's fuses.  <a href="#ga37527a6c0d14879adcb60aab7dace26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gf9269cd32d7133af16d90893967e7fe5">AvrTargetFusesWriteSafe</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> fuses)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Program the target's fuses in a safe way.  <a href="#gf9269cd32d7133af16d90893967e7fe5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g7794aed6338bf7e0362c7a32ae1fa8a6">AvrTargetPollReady</a> (unsigned int tmo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Poll target for becoming ready.  <a href="#g7794aed6338bf7e0362c7a32ae1fa8a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g7f6d9956462cd7a583415d2824a27058">AvrTargetChipErase</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Erase the target chip.  <a href="#g7f6d9956462cd7a583415d2824a27058"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gd79842b5e91a04277c1f74b9308fa3a5">AvrTargetPageLoad</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> page, CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load target's program memory page buffer.  <a href="#gd79842b5e91a04277c1f74b9308fa3a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#g6ade11a102082ad4e37c17de18d62432">AvrTargetPageWrite</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> page)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write page buffer contents to program memory.  <a href="#g6ade11a102082ad4e37c17de18d62432"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_avr_target.html#gca02e891e40a39b4cf81fac5a61b0087">AvrTargetPageVerify</a> (<a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> page, CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Verify program memory page contents.  <a href="#gca02e891e40a39b4cf81fac5a61b0087"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
AVR target programming via SPI. <hr><h2>Define Documentation</h2>
<a class="anchor" name="g94ed7c8bf54d7f8798e9b2842083011a"></a><!-- doxytag: member="avrtarget.c::AVRTARGET_CHIPERASE_TIMEOUT" ref="g94ed7c8bf54d7f8798e9b2842083011a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVRTARGET_CHIPERASE_TIMEOUT&nbsp;&nbsp;&nbsp;200          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum time (in milliseconds) to wait for chip erase done. 
<p>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00066">66</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00421">AvrTargetChipErase()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g10f22257d6d51d985a6e3c261d39ce6a"></a><!-- doxytag: member="avrtarget.c::AVRTARGET_PAGEWRITE_TIMEOUT" ref="g10f22257d6d51d985a6e3c261d39ce6a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVRTARGET_PAGEWRITE_TIMEOUT&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maximum time (in milliseconds) to wait for page write done. 
<p>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00073">73</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00459">AvrTargetPageWrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gbbaf412b22afc3f95cfb15105e515669"></a><!-- doxytag: member="avrtarget.c::AVR_FUSES_NEVER_PROG" ref="gbbaf412b22afc3f95cfb15105e515669" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVR_FUSES_NEVER_PROG&nbsp;&nbsp;&nbsp;0x00F88062UL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Safe fuse programming mask. 
<p>
If a bit is set in this mask, the corresponding fuse should never be programmed to 0.<p>
Used in <a class="el" href="group__xg_avr_target.html#gf9269cd32d7133af16d90893967e7fe5" title="Program the target&#39;s fuses in a safe way.">AvrTargetFusesWriteSafe()</a> to avoid dead chips. However, it is still possible to break hardware. Triple check any new fuse configuration.<p>
This unsigned long value is interpreted as follows:<p>
<ul>
<li>Least significant byte is fuse low byte.</li><li>Second byte is fuse high byte.</li><li>Third byte is fuse extended byte.</li><li>Most significant byte is not used. </li></ul>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00093">93</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00370">AvrTargetFusesWriteSafe()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ga37a0d5891af4cbabf364f651c560cae"></a><!-- doxytag: member="avrtarget.c::AVR_FUSES_ALWAYS_PROG" ref="ga37a0d5891af4cbabf364f651c560cae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVR_FUSES_ALWAYS_PROG&nbsp;&nbsp;&nbsp;0x0000201DUL          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Safe fuse unprogramming mask. 
<p>
If a bit is set in this mask, the corresponding fuse should never be left unprogrammed (set to 1).<p>
Used in <a class="el" href="group__xg_avr_target.html#gf9269cd32d7133af16d90893967e7fe5" title="Program the target&#39;s fuses in a safe way.">AvrTargetFusesWriteSafe()</a> to avoid dead chips. However, it is still possible to break hardware. Triple check any new fuse configuration.<p>
This unsigned long value is interpreted as follows:<p>
<ul>
<li>Least significant byte is fuse low byte.</li><li>Second byte is fuse high byte.</li><li>Third byte is fuse extended byte.</li><li>Most significant byte is not used. </li></ul>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00112">112</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00370">AvrTargetFusesWriteSafe()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd263c9d06c6b300d1a461c500a7d4fa3"></a><!-- doxytag: member="avrtarget.c::AVRTARGET_SPI_MODE" ref="gd263c9d06c6b300d1a461c500a7d4fa3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVRTARGET_SPI_MODE&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00115">115</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf7ebc0f40a59398183952cb3c2a66016"></a><!-- doxytag: member="avrtarget.c::AVRTARGET_SPI_RATE" ref="gf7ebc0f40a59398183952cb3c2a66016" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVRTARGET_SPI_RATE&nbsp;&nbsp;&nbsp;500000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00119">119</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="gea68f8ac7742744778298a48a128c42a"></a><!-- doxytag: member="avrtarget.c::AVRTARGET_NO_SPI_DEVICE" ref="gea68f8ac7742744778298a48a128c42a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AVRTARGET_NO_SPI_DEVICE          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00219">219</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g54e6496a5d012f337b9588e0df7b6518"></a><!-- doxytag: member="avrtarget.c::AvrTargetInit" ref="g54e6496a5d012f337b9588e0df7b6518" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetInit           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize programming interface. 
<p>
Sets the configured SPI mode and rate. This must be called before using any other routine in this module.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00231">231</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g3743f56c58ddecff1147c2798103a4cb"></a><!-- doxytag: member="avrtarget.c::AvrTargetSelect" ref="g3743f56c58ddecff1147c2798103a4cb" args="(ureg_t act)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AvrTargetSelect           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_nut_o_s.html#ge15262a08334eeeacd9a24f219a89d46">ureg_t</a>&nbsp;</td>
          <td class="paramname"> <em>act</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set or clear the chip select line. 
<p>
Must be called before sending programming commands to the target device, even if no chip selects are implemented by the hardware. Beside activating an optional chip select, this routine will also properly initialize the SPI hardware.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>act</em>&nbsp;</td><td>When 0, the chip will be deactivated and the serial peripheral interface may be used to communicate with another device. When not 0, the SPI bus is allocated for the attached AVR target. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00258">258</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="g850b833859005617c028ecfdedbe6afb"></a><!-- doxytag: member="avrtarget.c::AvrTargetReset" ref="g850b833859005617c028ecfdedbe6afb" args="(ureg_t act)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AvrTargetReset           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_nut_o_s.html#ge15262a08334eeeacd9a24f219a89d46">ureg_t</a>&nbsp;</td>
          <td class="paramname"> <em>act</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set or release the target's reset line. 
<p>
The target must be held in reset state during programming.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>on</em>&nbsp;</td><td>When not 0, the reset line will be activated. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00276">276</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="gdeb5307b6b76ab9b778595b077a9c035"></a><!-- doxytag: member="avrtarget.c::AvrTargetCmd" ref="gdeb5307b6b76ab9b778595b077a9c035" args="(uint32_t cmd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> AvrTargetCmd           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>cmd</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send programming command and return response. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>4-byte command.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>4-byte response. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00290">290</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00421">AvrTargetChipErase()</a>, <a class="el" href="avrtarget_8c-source.html#l00346">AvrTargetFusesRead()</a>, <a class="el" href="avrtarget_8c-source.html#l00370">AvrTargetFusesWriteSafe()</a>, <a class="el" href="avrtarget_8c-source.html#l00435">AvrTargetPageLoad()</a>, <a class="el" href="avrtarget_8c-source.html#l00475">AvrTargetPageVerify()</a>, <a class="el" href="avrtarget_8c-source.html#l00459">AvrTargetPageWrite()</a>, <a class="el" href="avrtarget_8c-source.html#l00398">AvrTargetPollReady()</a>, <a class="el" href="avrtarget_8c-source.html#l00310">AvrTargetProgEnable()</a>, and <a class="el" href="avrtarget_8c-source.html#l00327">AvrTargetSignature()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g8033081dd65a824f3b3ddd05c5c5a2b6"></a><!-- doxytag: member="avrtarget.c::AvrTargetProgEnable" ref="g8033081dd65a824f3b3ddd05c5c5a2b6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetProgEnable           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enable target's programming mode. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00310">310</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00085">AVRCMD_PROG_ENABLE</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g9846fec6ec027f9495568f6fcceb7772"></a><!-- doxytag: member="avrtarget.c::AvrTargetSignature" ref="g9846fec6ec027f9495568f6fcceb7772" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> AvrTargetSignature           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieve the target's signature. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Signature in the 3 least significant bytes. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00327">327</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00098">AVRCMD_READ_SIGNATURE_BYTE</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ga37527a6c0d14879adcb60aab7dace26"></a><!-- doxytag: member="avrtarget.c::AvrTargetFusesRead" ref="ga37527a6c0d14879adcb60aab7dace26" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> AvrTargetFusesRead           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieve the target's fuses. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Fuse bits in the 3 least significant bytes. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00346">346</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00102">AVRCMD_READ_FUSE_BITS</a>, <a class="el" href="avrtarget_8h-source.html#l00104">AVRCMD_READ_FUSE_EXT_BITS</a>, <a class="el" href="avrtarget_8h-source.html#l00103">AVRCMD_READ_FUSE_HI_BITS</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gf9269cd32d7133af16d90893967e7fe5"></a><!-- doxytag: member="avrtarget.c::AvrTargetFusesWriteSafe" ref="gf9269cd32d7133af16d90893967e7fe5" args="(uint32_t fuses)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a> AvrTargetFusesWriteSafe           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>fuses</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Program the target's fuses in a safe way. 
<p>
Fuses with corresponding bits set in <a class="el" href="group__xg_avr_target.html#gbbaf412b22afc3f95cfb15105e515669">AVR_FUSES_NEVER_PROG</a> will never be programmed. Fuses with corresponding bits set in <a class="el" href="group__xg_avr_target.html#ga37a0d5891af4cbabf364f651c560cae">AVR_FUSES_ALWAYS_PROG</a> will always be programmed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>fuses</em>&nbsp;</td><td>Fuse bits are expected in the 3 least significant bytes, Lower fuses in the LSB, followed by the high fuses and last no least the extended fuses. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00370">370</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8c-source.html#l00112">AVR_FUSES_ALWAYS_PROG</a>, <a class="el" href="avrtarget_8c-source.html#l00093">AVR_FUSES_NEVER_PROG</a>, <a class="el" href="avrtarget_8h-source.html#l00099">AVRCMD_WRITE_FUSE_BITS</a>, <a class="el" href="avrtarget_8h-source.html#l00101">AVRCMD_WRITE_FUSE_EXT_BITS</a>, <a class="el" href="avrtarget_8h-source.html#l00100">AVRCMD_WRITE_FUSE_HI_BITS</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7794aed6338bf7e0362c7a32ae1fa8a6"></a><!-- doxytag: member="avrtarget.c::AvrTargetPollReady" ref="g7794aed6338bf7e0362c7a32ae1fa8a6" args="(unsigned int tmo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetPollReady           </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>tmo</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Poll target for becoming ready. 
<p>
May switch to another thread while waiting. After switching back to the calling thread, the SPI is re-selected.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tmo</em>&nbsp;</td><td>Maximum number of milliseconds to wait.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on time out. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00398">398</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00106">AVRCMD_POLL_READY</a>, <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>, and <a class="el" href="timer_8c-source.html#l00610">NutSleep()</a>.</p>

<p>Referenced by <a class="el" href="avrtarget_8c-source.html#l00421">AvrTargetChipErase()</a>, and <a class="el" href="avrtarget_8c-source.html#l00459">AvrTargetPageWrite()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g7f6d9956462cd7a583415d2824a27058"></a><!-- doxytag: member="avrtarget.c::AvrTargetChipErase" ref="g7f6d9956462cd7a583415d2824a27058" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetChipErase           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Erase the target chip. 
<p>
Be aware, that this routine calls <a class="el" href="group__xg_avr_target.html#g7794aed6338bf7e0362c7a32ae1fa8a6" title="Poll target for becoming ready.">AvrTargetPollReady()</a>, which may initiate a context switch while waiting for the erase to finish.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on time out. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00421">421</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00086">AVRCMD_CHIP_ERASE</a>, <a class="el" href="avrtarget_8c-source.html#l00066">AVRTARGET_CHIPERASE_TIMEOUT</a>, <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>, and <a class="el" href="avrtarget_8c-source.html#l00398">AvrTargetPollReady()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gd79842b5e91a04277c1f74b9308fa3a5"></a><!-- doxytag: member="avrtarget.c::AvrTargetPageLoad" ref="gd79842b5e91a04277c1f74b9308fa3a5" args="(uint32_t page, CONST uint8_t *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AvrTargetPageLoad           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Load target's program memory page buffer. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>page</em>&nbsp;</td><td>Program memory page number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Points to the data. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00435">435</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00090">AVRCMD_LOAD_PROG_MEM_PAGE_HI</a>, <a class="el" href="avrtarget_8h-source.html#l00089">AVRCMD_LOAD_PROG_MEM_PAGE_LO</a>, <a class="el" href="avrtarget_8h-source.html#l00066">AVRTARGET_PAGESIZE</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
<a class="anchor" name="g6ade11a102082ad4e37c17de18d62432"></a><!-- doxytag: member="avrtarget.c::AvrTargetPageWrite" ref="g6ade11a102082ad4e37c17de18d62432" args="(uint32_t page)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetPageWrite           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>page</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write page buffer contents to program memory. 
<p>
Calls <a class="el" href="group__xg_avr_target.html#g7794aed6338bf7e0362c7a32ae1fa8a6" title="Poll target for becoming ready.">AvrTargetPollReady()</a>, which may initiate a context switch while waiting for the page write to finish.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>page</em>&nbsp;</td><td>Program memory page number.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on time out. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00459">459</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00091">AVRCMD_WRITE_PROG_MEM_PAGE</a>, <a class="el" href="avrtarget_8c-source.html#l00073">AVRTARGET_PAGEWRITE_TIMEOUT</a>, <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>, and <a class="el" href="avrtarget_8c-source.html#l00398">AvrTargetPollReady()</a>.</p>

</div>
</div><p>
<a class="anchor" name="gca02e891e40a39b4cf81fac5a61b0087"></a><!-- doxytag: member="avrtarget.c::AvrTargetPageVerify" ref="gca02e891e40a39b4cf81fac5a61b0087" args="(uint32_t page, CONST uint8_t *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AvrTargetPageVerify           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#06896e8c53f721507066c079052171f8">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST <a class="el" href="group__xg_crt_string.html#gba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Verify program memory page contents. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>page</em>&nbsp;</td><td>Program memory page number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Points to a buffer with the expected contents.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 if the buffer contents equals the memory page contents or -1 if it doesn't. </dd></dl>

<p>Definition at line <a class="el" href="avrtarget_8c-source.html#l00475">475</a> of file <a class="el" href="avrtarget_8c-source.html">avrtarget.c</a>.</p>

<p>References <a class="el" href="avrtarget_8h-source.html#l00088">AVRCMD_READ_PROG_MEM_HI</a>, <a class="el" href="avrtarget_8h-source.html#l00087">AVRCMD_READ_PROG_MEM_LO</a>, <a class="el" href="avrtarget_8h-source.html#l00066">AVRTARGET_PAGESIZE</a>, and <a class="el" href="avrtarget_8c-source.html#l00290">AvrTargetCmd()</a>.</p>

</div>
</div><p>
</div>
<hr>
<address>
  <small>
    &copy;&nbsp;2000-2007 by egnite Software GmbH - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
