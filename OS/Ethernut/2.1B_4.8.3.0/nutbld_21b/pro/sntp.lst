GAS LISTING C:\Temp/ccAxGzuE.s 			page 1


   1               		.file	"sntp.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.data
  11               	.LC0:
  12 0000 736E 7470 		.string	"sntpc"
  12      6300 
  13               		.text
  14               	.global	NutSNTPStartThread
  15               		.type	NutSNTPStartThread, @function
  16               	NutSNTPStartThread:
  17 0000 AF92      		push r10
  18 0002 BF92      		push r11
  19 0004 CF92      		push r12
  20 0006 DF92      		push r13
  21 0008 EF92      		push r14
  22 000a FF92      		push r15
  23 000c 0F93      		push r16
  24 000e 1F93      		push r17
  25 0010 CF93      		push r28
  26 0012 DF93      		push r29
  27               	/* prologue: function */
  28               	/* frame size = 0 */
  29 0014 7B01      		movw r14,r22
  30 0016 8C01      		movw r16,r24
  31 0018 5901      		movw r10,r18
  32 001a 6A01      		movw r12,r20
  33 001c 88E0      		ldi r24,lo8(8)
  34 001e 90E0      		ldi r25,hi8(8)
  35 0020 0E94 0000 		call malloc
  36 0024 EC01      		movw r28,r24
  37 0026 0097      		sbiw r24,0
  38 0028 01F0      		breq .L6
  39               	.L2:
  40 002a E882      		st Y,r14
  41 002c F982      		std Y+1,r15
  42 002e 0A83      		std Y+2,r16
  43 0030 1B83      		std Y+3,r17
  44 0032 AC82      		std Y+4,r10
  45 0034 BD82      		std Y+5,r11
  46 0036 CE82      		std Y+6,r12
  47 0038 DF82      		std Y+7,r13
  48 003a 20E0      		ldi r18,lo8(256)
  49 003c 31E0      		ldi r19,hi8(256)
  50 003e AC01      		movw r20,r24
  51 0040 60E0      		ldi r22,lo8(gs(SNTP_resync))
  52 0042 70E0      		ldi r23,hi8(gs(SNTP_resync))
  53 0044 80E0      		ldi r24,lo8(.LC0)
  54 0046 90E0      		ldi r25,hi8(.LC0)
  55 0048 0E94 0000 		call NutThreadCreate
  56 004c 892B      		or r24,r25
GAS LISTING C:\Temp/ccAxGzuE.s 			page 2


  57 004e 01F0      		breq .L4
  58 0050 20E0      		ldi r18,lo8(0)
  59 0052 30E0      		ldi r19,hi8(0)
  60 0054 00C0      		rjmp .L3
  61               	.L4:
  62 0056 CE01      		movw r24,r28
  63 0058 0E94 0000 		call free
  64               	.L6:
  65 005c 2FEF      		ldi r18,lo8(-1)
  66 005e 3FEF      		ldi r19,hi8(-1)
  67               	.L3:
  68 0060 C901      		movw r24,r18
  69               	/* epilogue start */
  70 0062 DF91      		pop r29
  71 0064 CF91      		pop r28
  72 0066 1F91      		pop r17
  73 0068 0F91      		pop r16
  74 006a FF90      		pop r15
  75 006c EF90      		pop r14
  76 006e DF90      		pop r13
  77 0070 CF90      		pop r12
  78 0072 BF90      		pop r11
  79 0074 AF90      		pop r10
  80 0076 0895      		ret
  81               		.size	NutSNTPStartThread, .-NutSNTPStartThread
  82               	.global	NutSNTPGetTime
  83               		.type	NutSNTPGetTime, @function
  84               	NutSNTPGetTime:
  85 0078 2F92      		push r2
  86 007a 3F92      		push r3
  87 007c 4F92      		push r4
  88 007e 5F92      		push r5
  89 0080 6F92      		push r6
  90 0082 7F92      		push r7
  91 0084 8F92      		push r8
  92 0086 9F92      		push r9
  93 0088 AF92      		push r10
  94 008a BF92      		push r11
  95 008c CF92      		push r12
  96 008e DF92      		push r13
  97 0090 EF92      		push r14
  98 0092 FF92      		push r15
  99 0094 0F93      		push r16
 100 0096 1F93      		push r17
 101 0098 DF93      		push r29
 102 009a CF93      		push r28
 103 009c CDB7      		in r28,__SP_L__
 104 009e DEB7      		in r29,__SP_H__
 105 00a0 2897      		sbiw r28,8
 106 00a2 0FB6      		in __tmp_reg__,__SREG__
 107 00a4 F894      		cli
 108 00a6 DEBF      		out __SP_H__,r29
 109 00a8 0FBE      		out __SREG__,__tmp_reg__
 110 00aa CDBF      		out __SP_L__,r28
 111               	/* prologue: function */
 112               	/* frame size = 8 */
 113 00ac 3C01      		movw r6,r24
GAS LISTING C:\Temp/ccAxGzuE.s 			page 3


 114 00ae 2B01      		movw r4,r22
 115 00b0 6115      		cp r22,__zero_reg__
 116 00b2 7105      		cpc r23,__zero_reg__
 117 00b4 01F4      		brne .+2
 118 00b6 00C0      		rjmp .L8
 119 00b8 0097      		sbiw r24,0
 120 00ba 01F4      		brne .+2
 121 00bc 00C0      		rjmp .L8
 122 00be 80E0      		ldi r24,lo8(256)
 123 00c0 91E0      		ldi r25,hi8(256)
 124 00c2 9C83      		std Y+4,r25
 125 00c4 8B83      		std Y+3,r24
 126 00c6 60E3      		ldi r22,lo8(48)
 127 00c8 70E0      		ldi r23,hi8(48)
 128 00ca 81E0      		ldi r24,lo8(1)
 129 00cc 90E0      		ldi r25,hi8(1)
 130 00ce 0E94 0000 		call calloc
 131 00d2 5C01      		movw r10,r24
 132 00d4 0097      		sbiw r24,0
 133 00d6 01F4      		brne .+2
 134 00d8 00C0      		rjmp .L8
 135 00da 80E0      		ldi r24,lo8(0)
 136 00dc 90E0      		ldi r25,hi8(0)
 137 00de 0E94 0000 		call NutUdpCreateSocket
 138 00e2 4C01      		movw r8,r24
 139 00e4 0097      		sbiw r24,0
 140 00e6 01F4      		brne .+2
 141 00e8 00C0      		rjmp .L9
 142 00ea 22E0      		ldi r18,lo8(2)
 143 00ec 30E0      		ldi r19,hi8(2)
 144 00ee AE01      		movw r20,r28
 145 00f0 4D5F      		subi r20,lo8(-(3))
 146 00f2 5F4F      		sbci r21,hi8(-(3))
 147 00f4 62E0      		ldi r22,lo8(4098)
 148 00f6 70E1      		ldi r23,hi8(4098)
 149 00f8 0E94 0000 		call NutUdpSetSockOpt
 150 00fc 8BE1      		ldi r24,lo8(27)
 151 00fe F501      		movw r30,r10
 152 0100 8083      		st Z,r24
 153 0102 F301      		movw r30,r6
 154 0104 4081      		ld r20,Z
 155 0106 5181      		ldd r21,Z+1
 156 0108 6281      		ldd r22,Z+2
 157 010a 7381      		ldd r23,Z+3
 158 010c 90E3      		ldi r25,lo8(48)
 159 010e E92E      		mov r14,r25
 160 0110 F12C      		mov r15,__zero_reg__
 161 0112 8501      		movw r16,r10
 162 0114 2BE7      		ldi r18,lo8(123)
 163 0116 30E0      		ldi r19,hi8(123)
 164 0118 C401      		movw r24,r8
 165 011a 0E94 0000 		call NutUdpSendTo
 166 011e 892B      		or r24,r25
 167 0120 01F0      		breq .+2
 168 0122 00C0      		rjmp .L10
 169 0124 1E01      		movw r2,r28
 170 0126 0894      		sec
GAS LISTING C:\Temp/ccAxGzuE.s 			page 4


 171 0128 211C      		adc r2,__zero_reg__
 172 012a 311C      		adc r3,__zero_reg__
 173               	.L18:
 174 012c 1D82      		std Y+5,__zero_reg__
 175 012e 1E82      		std Y+6,__zero_reg__
 176 0130 1F82      		std Y+7,__zero_reg__
 177 0132 1886      		std Y+8,__zero_reg__
 178 0134 88E8      		ldi r24,lo8(5000)
 179 0136 C82E      		mov r12,r24
 180 0138 83E1      		ldi r24,hi8(5000)
 181 013a D82E      		mov r13,r24
 182 013c E12C      		mov r14,__zero_reg__
 183 013e F12C      		mov r15,__zero_reg__
 184 0140 00E3      		ldi r16,lo8(48)
 185 0142 10E0      		ldi r17,hi8(48)
 186 0144 9501      		movw r18,r10
 187 0146 A101      		movw r20,r2
 188 0148 BE01      		movw r22,r28
 189 014a 6B5F      		subi r22,lo8(-(5))
 190 014c 7F4F      		sbci r23,hi8(-(5))
 191 014e C401      		movw r24,r8
 192 0150 0E94 0000 		call NutUdpReceiveFrom
 193 0154 1816      		cp __zero_reg__,r24
 194 0156 1906      		cpc __zero_reg__,r25
 195 0158 04F0      		brlt .+2
 196 015a 00C0      		rjmp .L10
 197 015c 8981      		ldd r24,Y+1
 198 015e 9A81      		ldd r25,Y+2
 199 0160 8B37      		cpi r24,123
 200 0162 9105      		cpc r25,__zero_reg__
 201 0164 01F4      		brne .L11
 202 0166 F501      		movw r30,r10
 203 0168 8081      		ld r24,Z
 204 016a 807C      		andi r24,lo8(-64)
 205 016c 803C      		cpi r24,lo8(-64)
 206 016e 01F4      		brne .L12
 207               	.L11:
 208 0170 F301      		movw r30,r6
 209 0172 8081      		ld r24,Z
 210 0174 9181      		ldd r25,Z+1
 211 0176 A281      		ldd r26,Z+2
 212 0178 B381      		ldd r27,Z+3
 213 017a 8F5F      		subi r24,lo8(-1)
 214 017c 9F4F      		sbci r25,hi8(-1)
 215 017e AF4F      		sbci r26,hlo8(-1)
 216 0180 BF4F      		sbci r27,hhi8(-1)
 217 0182 01F0      		breq .L18
 218 0184 00C0      		rjmp .L10
 219               	.L12:
 220 0186 F501      		movw r30,r10
 221 0188 80A5      		ldd r24,Z+40
 222 018a 91A5      		ldd r25,Z+41
 223 018c A2A5      		ldd r26,Z+42
 224 018e B3A5      		ldd r27,Z+43
 225               	/* #APP */
 226               	 ;  305 "../../nut/include/sys/types.h" 1
 227 0190 082E      		mov __tmp_reg__, r24
GAS LISTING C:\Temp/ccAxGzuE.s 			page 5


 228 0192 8B2F      		mov r24, r27
 229 0194 B02D      		mov r27, __tmp_reg__
 230 0196 092E      		mov __tmp_reg__, r25
 231 0198 9A2F      		mov r25, r26
 232 019a A02D      		mov r26, __tmp_reg__
 233               		
 234               	 ;  0 "" 2
 235               	/* #NOAPP */
 236 019c 8058      		subi r24,lo8(-(2085978496))
 237 019e 9E47      		sbci r25,hi8(-(2085978496))
 238 01a0 AA4A      		sbci r26,hlo8(-(2085978496))
 239 01a2 B348      		sbci r27,hhi8(-(2085978496))
 240 01a4 F201      		movw r30,r4
 241 01a6 8083      		st Z,r24
 242 01a8 9183      		std Z+1,r25
 243 01aa A283      		std Z+2,r26
 244 01ac B383      		std Z+3,r27
 245 01ae 8D81      		ldd r24,Y+5
 246 01b0 9E81      		ldd r25,Y+6
 247 01b2 AF81      		ldd r26,Y+7
 248 01b4 B885      		ldd r27,Y+8
 249 01b6 F301      		movw r30,r6
 250 01b8 8083      		st Z,r24
 251 01ba 9183      		std Z+1,r25
 252 01bc A283      		std Z+2,r26
 253 01be B383      		std Z+3,r27
 254 01c0 00E0      		ldi r16,lo8(0)
 255 01c2 10E0      		ldi r17,hi8(0)
 256 01c4 00C0      		rjmp .L14
 257               	.L9:
 258 01c6 0FEF      		ldi r16,lo8(-1)
 259 01c8 1FEF      		ldi r17,hi8(-1)
 260               	.L16:
 261 01ca C501      		movw r24,r10
 262 01cc 0E94 0000 		call free
 263 01d0 00C0      		rjmp .L15
 264               	.L8:
 265 01d2 0FEF      		ldi r16,lo8(-1)
 266 01d4 1FEF      		ldi r17,hi8(-1)
 267               	.L15:
 268 01d6 C801      		movw r24,r16
 269               	/* epilogue start */
 270 01d8 2896      		adiw r28,8
 271 01da 0FB6      		in __tmp_reg__,__SREG__
 272 01dc F894      		cli
 273 01de DEBF      		out __SP_H__,r29
 274 01e0 0FBE      		out __SREG__,__tmp_reg__
 275 01e2 CDBF      		out __SP_L__,r28
 276 01e4 CF91      		pop r28
 277 01e6 DF91      		pop r29
 278 01e8 1F91      		pop r17
 279 01ea 0F91      		pop r16
 280 01ec FF90      		pop r15
 281 01ee EF90      		pop r14
 282 01f0 DF90      		pop r13
 283 01f2 CF90      		pop r12
 284 01f4 BF90      		pop r11
GAS LISTING C:\Temp/ccAxGzuE.s 			page 6


 285 01f6 AF90      		pop r10
 286 01f8 9F90      		pop r9
 287 01fa 8F90      		pop r8
 288 01fc 7F90      		pop r7
 289 01fe 6F90      		pop r6
 290 0200 5F90      		pop r5
 291 0202 4F90      		pop r4
 292 0204 3F90      		pop r3
 293 0206 2F90      		pop r2
 294 0208 0895      		ret
 295               	.L10:
 296 020a 0FEF      		ldi r16,lo8(-1)
 297 020c 1FEF      		ldi r17,hi8(-1)
 298               	.L14:
 299 020e C401      		movw r24,r8
 300 0210 0E94 0000 		call NutUdpDestroySocket
 301 0214 00C0      		rjmp .L16
 302               		.size	NutSNTPGetTime, .-NutSNTPGetTime
 303               	.global	SNTP_resync
 304               		.type	SNTP_resync, @function
 305               	SNTP_resync:
 306 0216 DF93      		push r29
 307 0218 CF93      		push r28
 308 021a CDB7      		in r28,__SP_L__
 309 021c DEB7      		in r29,__SP_H__
 310 021e 2897      		sbiw r28,8
 311 0220 0FB6      		in __tmp_reg__,__SREG__
 312 0222 F894      		cli
 313 0224 DEBF      		out __SP_H__,r29
 314 0226 0FBE      		out __SREG__,__tmp_reg__
 315 0228 CDBF      		out __SP_L__,r28
 316               	/* prologue: function */
 317               	/* frame size = 8 */
 318 022a FC01      		movw r30,r24
 319 022c E080      		ld r14,Z
 320 022e F180      		ldd r15,Z+1
 321 0230 0281      		ldd r16,Z+2
 322 0232 1381      		ldd r17,Z+3
 323 0234 8480      		ldd r8,Z+4
 324 0236 9580      		ldd r9,Z+5
 325 0238 A680      		ldd r10,Z+6
 326 023a B780      		ldd r11,Z+7
 327 023c E982      		std Y+1,r14
 328 023e FA82      		std Y+2,r15
 329 0240 0B83      		std Y+3,r16
 330 0242 1C83      		std Y+4,r17
 331 0244 0E94 0000 		call free
 332 0248 8FE3      		ldi r24,lo8(63)
 333 024a 0E94 0000 		call NutThreadSetPriority
 334 024e CC24      		clr r12
 335 0250 DD24      		clr r13
 336 0252 25E0      		ldi r18,lo8(5)
 337 0254 622E      		mov r6,r18
 338 0256 712C      		mov r7,__zero_reg__
 339 0258 6C0E      		add r6,r28
 340 025a 7D1E      		adc r7,r29
 341 025c 2E01      		movw r4,r28
GAS LISTING C:\Temp/ccAxGzuE.s 			page 7


 342 025e 0894      		sec
 343 0260 411C      		adc r4,__zero_reg__
 344 0262 511C      		adc r5,__zero_reg__
 345               	.L26:
 346 0264 B301      		movw r22,r6
 347 0266 C201      		movw r24,r4
 348 0268 0E94 0000 		call NutSNTPGetTime
 349 026c 892B      		or r24,r25
 350 026e 01F0      		breq .L21
 351 0270 8981      		ldd r24,Y+1
 352 0272 9A81      		ldd r25,Y+2
 353 0274 AB81      		ldd r26,Y+3
 354 0276 BC81      		ldd r27,Y+4
 355 0278 8E15      		cp r24,r14
 356 027a 9F05      		cpc r25,r15
 357 027c A007      		cpc r26,r16
 358 027e B107      		cpc r27,r17
 359 0280 01F0      		breq .L22
 360 0282 8FEF      		ldi r24,lo8(-1)
 361 0284 E816      		cp r14,r24
 362 0286 8FEF      		ldi r24,hi8(-1)
 363 0288 F806      		cpc r15,r24
 364 028a 8FEF      		ldi r24,hlo8(-1)
 365 028c 0807      		cpc r16,r24
 366 028e 8FEF      		ldi r24,hhi8(-1)
 367 0290 1807      		cpc r17,r24
 368 0292 01F4      		brne .L22
 369 0294 E982      		std Y+1,r14
 370 0296 FA82      		std Y+2,r15
 371 0298 0B83      		std Y+3,r16
 372 029a 1C83      		std Y+4,r17
 373 029c 00C0      		rjmp .L26
 374               	.L22:
 375 029e 83E0      		ldi r24,lo8(3)
 376 02a0 C816      		cp r12,r24
 377 02a2 D104      		cpc r13,__zero_reg__
 378 02a4 04F0      		brlt .L24
 379 02a6 60E3      		ldi r22,lo8(30000)
 380 02a8 75E7      		ldi r23,hi8(30000)
 381 02aa 80E0      		ldi r24,hlo8(30000)
 382 02ac 90E0      		ldi r25,hhi8(30000)
 383 02ae 00C0      		rjmp .L27
 384               	.L24:
 385 02b0 0894      		sec
 386 02b2 C11C      		adc r12,__zero_reg__
 387 02b4 D11C      		adc r13,__zero_reg__
 388 02b6 68E8      		ldi r22,lo8(5000)
 389 02b8 73E1      		ldi r23,hi8(5000)
 390 02ba 80E0      		ldi r24,hlo8(5000)
 391 02bc 90E0      		ldi r25,hhi8(5000)
 392 02be 0E94 0000 		call NutSleep
 393 02c2 00C0      		rjmp .L26
 394               	.L21:
 395 02c4 C301      		movw r24,r6
 396 02c6 0E94 0000 		call stime
 397 02ca C501      		movw r24,r10
 398 02cc B401      		movw r22,r8
GAS LISTING C:\Temp/ccAxGzuE.s 			page 8


 399               	.L27:
 400 02ce 0E94 0000 		call NutSleep
 401 02d2 CC24      		clr r12
 402 02d4 DD24      		clr r13
 403 02d6 00C0      		rjmp .L26
 404               		.size	SNTP_resync, .-SNTP_resync
GAS LISTING C:\Temp/ccAxGzuE.s 			page 9


DEFINED SYMBOLS
                            *ABS*:00000000 sntp.c
  C:\Temp/ccAxGzuE.s:2      *ABS*:0000003f __SREG__
  C:\Temp/ccAxGzuE.s:3      *ABS*:0000003e __SP_H__
  C:\Temp/ccAxGzuE.s:4      *ABS*:0000003d __SP_L__
  C:\Temp/ccAxGzuE.s:5      *ABS*:00000034 __CCP__
  C:\Temp/ccAxGzuE.s:6      *ABS*:00000000 __tmp_reg__
  C:\Temp/ccAxGzuE.s:7      *ABS*:00000001 __zero_reg__
  C:\Temp/ccAxGzuE.s:16     .text:00000000 NutSNTPStartThread
  C:\Temp/ccAxGzuE.s:305    .text:00000216 SNTP_resync
  C:\Temp/ccAxGzuE.s:84     .text:00000078 NutSNTPGetTime

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
malloc
NutThreadCreate
free
calloc
NutUdpCreateSocket
NutUdpSetSockOpt
NutUdpSendTo
NutUdpReceiveFrom
NutUdpDestroySocket
NutThreadSetPriority
NutSleep
stime
