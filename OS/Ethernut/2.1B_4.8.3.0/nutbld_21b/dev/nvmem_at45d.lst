GAS LISTING C:\Temp/ccajr1PH.s 			page 1


   1               		.file	"nvmem_at45d.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.text
  11               	.global	SpiAt45dConfigSize
  12               		.type	SpiAt45dConfigSize, @function
  13               	SpiAt45dConfigSize:
  14 0000 CF93      		push r28
  15 0002 DF93      		push r29
  16               	/* prologue: function */
  17               	/* frame size = 0 */
  18 0004 8091 0000 		lds r24,devSysConf
  19 0008 9091 0000 		lds r25,(devSysConf)+1
  20 000c 892B      		or r24,r25
  21 000e 01F4      		brne .L2
  22 0010 C091 0000 		lds r28,devSpiAt45d0+15
  23 0014 D091 0000 		lds r29,(devSpiAt45d0+15)+1
  24 0018 8881      		ld r24,Y
  25 001a 9981      		ldd r25,Y+1
  26 001c 892B      		or r24,r25
  27 001e 01F4      		brne .L3
  28 0020 80E0      		ldi r24,lo8(spiBus0Avr)
  29 0022 90E0      		ldi r25,hi8(spiBus0Avr)
  30 0024 9983      		std Y+1,r25
  31 0026 8883      		st Y,r24
  32               	.L3:
  33 0028 1B86      		std Y+11,__zero_reg__
  34 002a E881      		ld r30,Y
  35 002c F981      		ldd r31,Y+1
  36 002e 0084      		ldd __tmp_reg__,Z+8
  37 0030 F185      		ldd r31,Z+9
  38 0032 E02D      		mov r30,__tmp_reg__
  39 0034 CE01      		movw r24,r28
  40 0036 0995      		icall
  41 0038 892B      		or r24,r25
  42 003a 01F4      		brne .L4
  43 003c 8881      		ld r24,Y
  44 003e 9981      		ldd r25,Y+1
  45 0040 0E94 0000 		call NutEventPost
  46 0044 C0E0      		ldi r28,lo8(devSpiAt45d0)
  47 0046 D0E0      		ldi r29,hi8(devSpiAt45d0)
  48 0048 CE01      		movw r24,r28
  49 004a 0E94 0000 		call SpiAt45dInit
  50 004e 892B      		or r24,r25
  51 0050 01F4      		brne .L4
  52 0052 D093 0000 		sts (devSysConf)+1,r29
  53 0056 C093 0000 		sts devSysConf,r28
  54               	.L2:
  55 005a 8091 0000 		lds r24,devSysConf
  56 005e 9091 0000 		lds r25,(devSysConf)+1
  57 0062 0E94 0000 		call SpiAt45dPageSize
GAS LISTING C:\Temp/ccajr1PH.s 			page 2


  58 0066 9C01      		movw r18,r24
  59 0068 00C0      		rjmp .L5
  60               	.L4:
  61 006a 20E0      		ldi r18,lo8(0)
  62 006c 30E0      		ldi r19,hi8(0)
  63               	.L5:
  64 006e C901      		movw r24,r18
  65               	/* epilogue start */
  66 0070 DF91      		pop r29
  67 0072 CF91      		pop r28
  68 0074 0895      		ret
  69               		.size	SpiAt45dConfigSize, .-SpiAt45dConfigSize
  70               	.global	SpiAt45dConfigWrite
  71               		.type	SpiAt45dConfigWrite, @function
  72               	SpiAt45dConfigWrite:
  73 0076 2F92      		push r2
  74 0078 3F92      		push r3
  75 007a 4F92      		push r4
  76 007c 5F92      		push r5
  77 007e 6F92      		push r6
  78 0080 7F92      		push r7
  79 0082 8F92      		push r8
  80 0084 9F92      		push r9
  81 0086 AF92      		push r10
  82 0088 BF92      		push r11
  83 008a CF92      		push r12
  84 008c DF92      		push r13
  85 008e EF92      		push r14
  86 0090 FF92      		push r15
  87 0092 0F93      		push r16
  88 0094 1F93      		push r17
  89 0096 CF93      		push r28
  90 0098 DF93      		push r29
  91               	/* prologue: function */
  92               	/* frame size = 0 */
  93 009a 2C01      		movw r4,r24
  94 009c 362E      		mov r3,r22
  95 009e 272E      		mov r2,r23
  96 00a0 3A01      		movw r6,r20
  97 00a2 0E94 0000 		call SpiAt45dConfigSize
  98 00a6 5C01      		movw r10,r24
  99 00a8 C301      		movw r24,r6
 100 00aa 840D      		add r24,r4
 101 00ac 951D      		adc r25,r5
 102 00ae A816      		cp r10,r24
 103 00b0 B906      		cpc r11,r25
 104 00b2 00F4      		brsh .+2
 105 00b4 00C0      		rjmp .L8
 106 00b6 C501      		movw r24,r10
 107 00b8 0E94 0000 		call malloc
 108 00bc EC01      		movw r28,r24
 109 00be 0097      		sbiw r24,0
 110 00c0 01F4      		brne .+2
 111 00c2 00C0      		rjmp .L8
 112 00c4 8091 0000 		lds r24,devSysConf
 113 00c8 9091 0000 		lds r25,(devSysConf)+1
 114 00cc 0E94 0000 		call SpiAt45dPages
GAS LISTING C:\Temp/ccajr1PH.s 			page 3


 115 00d0 6B01      		movw r12,r22
 116 00d2 7C01      		movw r14,r24
 117 00d4 0894      		sec
 118 00d6 C108      		sbc r12,__zero_reg__
 119 00d8 D108      		sbc r13,__zero_reg__
 120 00da E108      		sbc r14,__zero_reg__
 121 00dc F108      		sbc r15,__zero_reg__
 122 00de 8501      		movw r16,r10
 123 00e0 9E01      		movw r18,r28
 124 00e2 B701      		movw r22,r14
 125 00e4 A601      		movw r20,r12
 126 00e6 8091 0000 		lds r24,devSysConf
 127 00ea 9091 0000 		lds r25,(devSysConf)+1
 128 00ee 0E94 0000 		call SpiAt45dPageRead
 129 00f2 4C01      		movw r8,r24
 130 00f4 8A15      		cp r24,r10
 131 00f6 9B05      		cpc r25,r11
 132 00f8 01F4      		brne .L9
 133 00fa 8E01      		movw r16,r28
 134 00fc 040D      		add r16,r4
 135 00fe 151D      		adc r17,r5
 136 0100 A301      		movw r20,r6
 137 0102 632D      		mov r22,r3
 138 0104 722D      		mov r23,r2
 139 0106 C801      		movw r24,r16
 140 0108 0E94 0000 		call memcmp
 141 010c 0097      		sbiw r24,0
 142 010e 01F0      		breq .L10
 143 0110 A301      		movw r20,r6
 144 0112 632D      		mov r22,r3
 145 0114 722D      		mov r23,r2
 146 0116 C801      		movw r24,r16
 147 0118 0E94 0000 		call memcpy
 148 011c 8401      		movw r16,r8
 149 011e 9E01      		movw r18,r28
 150 0120 B701      		movw r22,r14
 151 0122 A601      		movw r20,r12
 152 0124 8091 0000 		lds r24,devSysConf
 153 0128 9091 0000 		lds r25,(devSysConf)+1
 154 012c 0E94 0000 		call SpiAt45dPageWrite
 155 0130 8815      		cp r24,r8
 156 0132 9905      		cpc r25,r9
 157 0134 01F0      		breq .L10
 158               	.L9:
 159 0136 0FEF      		ldi r16,lo8(-1)
 160 0138 1FEF      		ldi r17,hi8(-1)
 161 013a 00C0      		rjmp .L12
 162               	.L10:
 163 013c 00E0      		ldi r16,lo8(0)
 164 013e 10E0      		ldi r17,hi8(0)
 165               	.L12:
 166 0140 CE01      		movw r24,r28
 167 0142 0E94 0000 		call free
 168 0146 00C0      		rjmp .L13
 169               	.L8:
 170 0148 0FEF      		ldi r16,lo8(-1)
 171 014a 1FEF      		ldi r17,hi8(-1)
GAS LISTING C:\Temp/ccajr1PH.s 			page 4


 172               	.L13:
 173 014c C801      		movw r24,r16
 174               	/* epilogue start */
 175 014e DF91      		pop r29
 176 0150 CF91      		pop r28
 177 0152 1F91      		pop r17
 178 0154 0F91      		pop r16
 179 0156 FF90      		pop r15
 180 0158 EF90      		pop r14
 181 015a DF90      		pop r13
 182 015c CF90      		pop r12
 183 015e BF90      		pop r11
 184 0160 AF90      		pop r10
 185 0162 9F90      		pop r9
 186 0164 8F90      		pop r8
 187 0166 7F90      		pop r7
 188 0168 6F90      		pop r6
 189 016a 5F90      		pop r5
 190 016c 4F90      		pop r4
 191 016e 3F90      		pop r3
 192 0170 2F90      		pop r2
 193 0172 0895      		ret
 194               		.size	SpiAt45dConfigWrite, .-SpiAt45dConfigWrite
 195               	.global	SpiAt45dConfigRead
 196               		.type	SpiAt45dConfigRead, @function
 197               	SpiAt45dConfigRead:
 198 0174 8F92      		push r8
 199 0176 9F92      		push r9
 200 0178 AF92      		push r10
 201 017a BF92      		push r11
 202 017c CF92      		push r12
 203 017e DF92      		push r13
 204 0180 EF92      		push r14
 205 0182 FF92      		push r15
 206 0184 0F93      		push r16
 207 0186 1F93      		push r17
 208 0188 CF93      		push r28
 209 018a DF93      		push r29
 210               	/* prologue: function */
 211               	/* frame size = 0 */
 212 018c 5C01      		movw r10,r24
 213 018e 962E      		mov r9,r22
 214 0190 872E      		mov r8,r23
 215 0192 6A01      		movw r12,r20
 216 0194 0E94 0000 		call SpiAt45dConfigSize
 217 0198 7C01      		movw r14,r24
 218 019a C601      		movw r24,r12
 219 019c 8A0D      		add r24,r10
 220 019e 9B1D      		adc r25,r11
 221 01a0 E816      		cp r14,r24
 222 01a2 F906      		cpc r15,r25
 223 01a4 00F0      		brlo .L16
 224 01a6 C701      		movw r24,r14
 225 01a8 0E94 0000 		call malloc
 226 01ac EC01      		movw r28,r24
 227 01ae 0097      		sbiw r24,0
 228 01b0 01F0      		breq .L16
GAS LISTING C:\Temp/ccajr1PH.s 			page 5


 229 01b2 8091 0000 		lds r24,devSysConf
 230 01b6 9091 0000 		lds r25,(devSysConf)+1
 231 01ba 0E94 0000 		call SpiAt45dPages
 232 01be AB01      		movw r20,r22
 233 01c0 BC01      		movw r22,r24
 234 01c2 4150      		subi r20,lo8(-(-1))
 235 01c4 5040      		sbci r21,hi8(-(-1))
 236 01c6 6040      		sbci r22,hlo8(-(-1))
 237 01c8 7040      		sbci r23,hhi8(-(-1))
 238 01ca 8701      		movw r16,r14
 239 01cc 9E01      		movw r18,r28
 240 01ce 8091 0000 		lds r24,devSysConf
 241 01d2 9091 0000 		lds r25,(devSysConf)+1
 242 01d6 0E94 0000 		call SpiAt45dPageRead
 243 01da 8E15      		cp r24,r14
 244 01dc 9F05      		cpc r25,r15
 245 01de 01F0      		breq .L17
 246 01e0 0FEF      		ldi r16,lo8(-1)
 247 01e2 1FEF      		ldi r17,hi8(-1)
 248 01e4 00C0      		rjmp .L18
 249               	.L17:
 250 01e6 CE01      		movw r24,r28
 251 01e8 8A0D      		add r24,r10
 252 01ea 9B1D      		adc r25,r11
 253 01ec A601      		movw r20,r12
 254 01ee BC01      		movw r22,r24
 255 01f0 892D      		mov r24,r9
 256 01f2 982D      		mov r25,r8
 257 01f4 0E94 0000 		call memcpy
 258 01f8 00E0      		ldi r16,lo8(0)
 259 01fa 10E0      		ldi r17,hi8(0)
 260               	.L18:
 261 01fc CE01      		movw r24,r28
 262 01fe 0E94 0000 		call free
 263 0202 00C0      		rjmp .L20
 264               	.L16:
 265 0204 0FEF      		ldi r16,lo8(-1)
 266 0206 1FEF      		ldi r17,hi8(-1)
 267               	.L20:
 268 0208 C801      		movw r24,r16
 269               	/* epilogue start */
 270 020a DF91      		pop r29
 271 020c CF91      		pop r28
 272 020e 1F91      		pop r17
 273 0210 0F91      		pop r16
 274 0212 FF90      		pop r15
 275 0214 EF90      		pop r14
 276 0216 DF90      		pop r13
 277 0218 CF90      		pop r12
 278 021a BF90      		pop r11
 279 021c AF90      		pop r10
 280 021e 9F90      		pop r9
 281 0220 8F90      		pop r8
 282 0222 0895      		ret
 283               		.size	SpiAt45dConfigRead, .-SpiAt45dConfigRead
 284               		.lcomm devSysConf,2
GAS LISTING C:\Temp/ccajr1PH.s 			page 6


DEFINED SYMBOLS
                            *ABS*:00000000 nvmem_at45d.c
  C:\Temp/ccajr1PH.s:2      *ABS*:0000003f __SREG__
  C:\Temp/ccajr1PH.s:3      *ABS*:0000003e __SP_H__
  C:\Temp/ccajr1PH.s:4      *ABS*:0000003d __SP_L__
  C:\Temp/ccajr1PH.s:5      *ABS*:00000034 __CCP__
  C:\Temp/ccajr1PH.s:6      *ABS*:00000000 __tmp_reg__
  C:\Temp/ccajr1PH.s:7      *ABS*:00000001 __zero_reg__
  C:\Temp/ccajr1PH.s:13     .text:00000000 SpiAt45dConfigSize
                             .bss:00000000 devSysConf
  C:\Temp/ccajr1PH.s:72     .text:00000076 SpiAt45dConfigWrite
  C:\Temp/ccajr1PH.s:197    .text:00000174 SpiAt45dConfigRead

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
devSpiAt45d0
spiBus0Avr
NutEventPost
SpiAt45dInit
SpiAt45dPageSize
malloc
SpiAt45dPages
SpiAt45dPageRead
memcmp
memcpy
SpiAt45dPageWrite
free
