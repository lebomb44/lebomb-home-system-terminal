GAS LISTING C:\Temp/cc64q1PH.s 			page 1


   1               		.file	"phatfs.c"
   2               	__SREG__ = 0x3f
   3               	__SP_H__ = 0x3e
   4               	__SP_L__ = 0x3d
   5               	__CCP__  = 0x34
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  10               		.text
  11               	.global	PhatFileWrite_P
  12               		.type	PhatFileWrite_P, @function
  13               	PhatFileWrite_P:
  14               	/* prologue: function */
  15               	/* frame size = 0 */
  16 0000 8FEF      		ldi r24,lo8(-1)
  17 0002 9FEF      		ldi r25,hi8(-1)
  18               	/* epilogue start */
  19 0004 0895      		ret
  20               		.size	PhatFileWrite_P, .-PhatFileWrite_P
  21               		.type	PhatFileSize, @function
  22               	PhatFileSize:
  23               	/* prologue: function */
  24               	/* frame size = 0 */
  25 0006 DC01      		movw r26,r24
  26 0008 1496      		adiw r26,4
  27 000a ED91      		ld r30,X+
  28 000c FC91      		ld r31,X
  29 000e 1597      		sbiw r26,4+1
  30 0010 64A9      		ldd r22,Z+52
  31 0012 75A9      		ldd r23,Z+53
  32 0014 86A9      		ldd r24,Z+54
  33 0016 97A9      		ldd r25,Z+55
  34               	/* epilogue start */
  35 0018 0895      		ret
  36               		.size	PhatFileSize, .-PhatFileSize
  37               		.type	PhatInit, @function
  38               	PhatInit:
  39               	/* prologue: function */
  40               	/* frame size = 0 */
  41 001a 80E0      		ldi r24,lo8(0)
  42 001c 90E0      		ldi r25,hi8(0)
  43               	/* epilogue start */
  44 001e 0895      		ret
  45               		.size	PhatInit, .-PhatInit
  46               		.type	PhatApiFileWrite_P, @function
  47               	PhatApiFileWrite_P:
  48 0020 0F93      		push r16
  49 0022 1F93      		push r17
  50               	/* prologue: function */
  51               	/* frame size = 0 */
  52 0024 DC01      		movw r26,r24
  53 0026 1296      		adiw r26,2
  54 0028 ED91      		ld r30,X+
  55 002a FC91      		ld r31,X
  56 002c 1397      		sbiw r26,2+1
  57 002e 0189      		ldd r16,Z+17
GAS LISTING C:\Temp/cc64q1PH.s 			page 2


  58 0030 1289      		ldd r17,Z+18
  59 0032 0E5E      		subi r16,lo8(-(18))
  60 0034 1F4F      		sbci r17,hi8(-(18))
  61 0036 40E0      		ldi r20,lo8(0)
  62 0038 50E0      		ldi r21,hi8(0)
  63 003a 60E0      		ldi r22,hlo8(0)
  64 003c 70E0      		ldi r23,hhi8(0)
  65 003e C801      		movw r24,r16
  66 0040 0E94 0000 		call NutEventWait
  67 0044 C801      		movw r24,r16
  68 0046 0E94 0000 		call NutEventPost
  69 004a 8FEF      		ldi r24,lo8(-1)
  70 004c 9FEF      		ldi r25,hi8(-1)
  71               	/* epilogue start */
  72 004e 1F91      		pop r17
  73 0050 0F91      		pop r16
  74 0052 0895      		ret
  75               		.size	PhatApiFileWrite_P, .-PhatApiFileWrite_P
  76               		.type	SearchFreeCluster, @function
  77               	SearchFreeCluster:
  78 0054 6F92      		push r6
  79 0056 7F92      		push r7
  80 0058 8F92      		push r8
  81 005a 9F92      		push r9
  82 005c AF92      		push r10
  83 005e BF92      		push r11
  84 0060 CF92      		push r12
  85 0062 DF92      		push r13
  86 0064 EF92      		push r14
  87 0066 FF92      		push r15
  88 0068 0F93      		push r16
  89 006a 1F93      		push r17
  90 006c DF93      		push r29
  91 006e CF93      		push r28
  92 0070 00D0      		rcall .
  93 0072 00D0      		rcall .
  94 0074 CDB7      		in r28,__SP_L__
  95 0076 DEB7      		in r29,__SP_H__
  96               	/* prologue: function */
  97               	/* frame size = 4 */
  98 0078 4C01      		movw r8,r24
  99 007a 5801      		movw r10,r16
 100 007c 6901      		movw r12,r18
 101 007e 81E0      		ldi r24,lo8(1)
 102 0080 90E0      		ldi r25,hi8(1)
 103 0082 A0E0      		ldi r26,hlo8(1)
 104 0084 B0E0      		ldi r27,hhi8(1)
 105 0086 8983      		std Y+1,r24
 106 0088 9A83      		std Y+2,r25
 107 008a AB83      		std Y+3,r26
 108 008c BC83      		std Y+4,r27
 109 008e D401      		movw r26,r8
 110 0090 5196      		adiw r26,17
 111 0092 ED91      		ld r30,X+
 112 0094 FC91      		ld r31,X
 113 0096 5297      		sbiw r26,17+1
 114 0098 0190      		ld __tmp_reg__,Z+
GAS LISTING C:\Temp/cc64q1PH.s 			page 3


 115 009a F081      		ld r31,Z
 116 009c E02D      		mov r30,__tmp_reg__
 117 009e E032      		cpi r30,32
 118 00a0 F105      		cpc r31,__zero_reg__
 119 00a2 01F4      		brne .L10
 120 00a4 242F      		mov r18,r20
 121 00a6 352F      		mov r19,r21
 122 00a8 C901      		movw r24,r18
 123 00aa DB01      		movw r26,r22
 124 00ac 7C01      		movw r14,r24
 125 00ae 8D01      		movw r16,r26
 126 00b0 2FEF      		ldi r18,lo8(-1)
 127 00b2 3FEF      		ldi r19,hi8(-1)
 128 00b4 3E01      		movw r6,r28
 129 00b6 0894      		sec
 130 00b8 611C      		adc r6,__zero_reg__
 131 00ba 711C      		adc r7,__zero_reg__
 132 00bc 00C0      		rjmp .L11
 133               	.L14:
 134 00be 9301      		movw r18,r6
 135 00c0 B801      		movw r22,r16
 136 00c2 A701      		movw r20,r14
 137 00c4 C401      		movw r24,r8
 138 00c6 0E94 0000 		call Phat32GetClusterLink
 139 00ca 9C01      		movw r18,r24
 140 00cc 97FD      		sbrc r25,7
 141 00ce 00C0      		rjmp .L12
 142 00d0 8981      		ldd r24,Y+1
 143 00d2 9A81      		ldd r25,Y+2
 144 00d4 AB81      		ldd r26,Y+3
 145 00d6 BC81      		ldd r27,Y+4
 146 00d8 0097      		sbiw r24,0
 147 00da A105      		cpc r26,__zero_reg__
 148 00dc B105      		cpc r27,__zero_reg__
 149 00de 01F4      		brne .+2
 150 00e0 00C0      		rjmp .L13
 151 00e2 0894      		sec
 152 00e4 E11C      		adc r14,__zero_reg__
 153 00e6 F11C      		adc r15,__zero_reg__
 154 00e8 011D      		adc r16,__zero_reg__
 155 00ea 111D      		adc r17,__zero_reg__
 156               	.L11:
 157 00ec EA14      		cp r14,r10
 158 00ee FB04      		cpc r15,r11
 159 00f0 0C05      		cpc r16,r12
 160 00f2 1D05      		cpc r17,r13
 161 00f4 00F0      		brlo .L14
 162 00f6 00C0      		rjmp .L13
 163               	.L10:
 164 00f8 7097      		sbiw r30,16
 165 00fa 01F0      		breq .L15
 166 00fc 242F      		mov r18,r20
 167 00fe 352F      		mov r19,r21
 168 0100 C901      		movw r24,r18
 169 0102 DB01      		movw r26,r22
 170 0104 7C01      		movw r14,r24
 171 0106 8D01      		movw r16,r26
GAS LISTING C:\Temp/cc64q1PH.s 			page 4


 172 0108 2FEF      		ldi r18,lo8(-1)
 173 010a 3FEF      		ldi r19,hi8(-1)
 174 010c 3E01      		movw r6,r28
 175 010e 0894      		sec
 176 0110 611C      		adc r6,__zero_reg__
 177 0112 711C      		adc r7,__zero_reg__
 178 0114 00C0      		rjmp .L16
 179               	.L15:
 180 0116 242F      		mov r18,r20
 181 0118 352F      		mov r19,r21
 182 011a C901      		movw r24,r18
 183 011c DB01      		movw r26,r22
 184 011e 7C01      		movw r14,r24
 185 0120 8D01      		movw r16,r26
 186 0122 2FEF      		ldi r18,lo8(-1)
 187 0124 3FEF      		ldi r19,hi8(-1)
 188 0126 3E01      		movw r6,r28
 189 0128 0894      		sec
 190 012a 611C      		adc r6,__zero_reg__
 191 012c 711C      		adc r7,__zero_reg__
 192 012e 00C0      		rjmp .L17
 193               	.L18:
 194 0130 9301      		movw r18,r6
 195 0132 B801      		movw r22,r16
 196 0134 A701      		movw r20,r14
 197 0136 C401      		movw r24,r8
 198 0138 0E94 0000 		call Phat16GetClusterLink
 199 013c 9C01      		movw r18,r24
 200 013e 97FD      		sbrc r25,7
 201 0140 00C0      		rjmp .L12
 202 0142 8981      		ldd r24,Y+1
 203 0144 9A81      		ldd r25,Y+2
 204 0146 AB81      		ldd r26,Y+3
 205 0148 BC81      		ldd r27,Y+4
 206 014a 0097      		sbiw r24,0
 207 014c A105      		cpc r26,__zero_reg__
 208 014e B105      		cpc r27,__zero_reg__
 209 0150 01F0      		breq .L13
 210 0152 0894      		sec
 211 0154 E11C      		adc r14,__zero_reg__
 212 0156 F11C      		adc r15,__zero_reg__
 213 0158 011D      		adc r16,__zero_reg__
 214 015a 111D      		adc r17,__zero_reg__
 215               	.L17:
 216 015c EA14      		cp r14,r10
 217 015e FB04      		cpc r15,r11
 218 0160 0C05      		cpc r16,r12
 219 0162 1D05      		cpc r17,r13
 220 0164 00F0      		brlo .L18
 221 0166 00C0      		rjmp .L13
 222               	.L19:
 223 0168 9301      		movw r18,r6
 224 016a B801      		movw r22,r16
 225 016c A701      		movw r20,r14
 226 016e C401      		movw r24,r8
 227 0170 0E94 0000 		call Phat12GetClusterLink
 228 0174 9C01      		movw r18,r24
GAS LISTING C:\Temp/cc64q1PH.s 			page 5


 229 0176 97FD      		sbrc r25,7
 230 0178 00C0      		rjmp .L12
 231 017a 8981      		ldd r24,Y+1
 232 017c 9A81      		ldd r25,Y+2
 233 017e AB81      		ldd r26,Y+3
 234 0180 BC81      		ldd r27,Y+4
 235 0182 0097      		sbiw r24,0
 236 0184 A105      		cpc r26,__zero_reg__
 237 0186 B105      		cpc r27,__zero_reg__
 238 0188 01F0      		breq .L13
 239 018a 0894      		sec
 240 018c E11C      		adc r14,__zero_reg__
 241 018e F11C      		adc r15,__zero_reg__
 242 0190 011D      		adc r16,__zero_reg__
 243 0192 111D      		adc r17,__zero_reg__
 244               	.L16:
 245 0194 EA14      		cp r14,r10
 246 0196 FB04      		cpc r15,r11
 247 0198 0C05      		cpc r16,r12
 248 019a 1D05      		cpc r17,r13
 249 019c 00F0      		brlo .L19
 250               	.L13:
 251 019e 232B      		or r18,r19
 252 01a0 01F4      		brne .L12
 253 01a2 8981      		ldd r24,Y+1
 254 01a4 9A81      		ldd r25,Y+2
 255 01a6 AB81      		ldd r26,Y+3
 256 01a8 BC81      		ldd r27,Y+4
 257 01aa 0097      		sbiw r24,0
 258 01ac A105      		cpc r26,__zero_reg__
 259 01ae B105      		cpc r27,__zero_reg__
 260 01b0 01F0      		breq .L20
 261               	.L12:
 262 01b2 EE24      		clr r14
 263 01b4 FF24      		clr r15
 264 01b6 8701      		movw r16,r14
 265               	.L20:
 266 01b8 B701      		movw r22,r14
 267 01ba C801      		movw r24,r16
 268               	/* epilogue start */
 269 01bc 0F90      		pop __tmp_reg__
 270 01be 0F90      		pop __tmp_reg__
 271 01c0 0F90      		pop __tmp_reg__
 272 01c2 0F90      		pop __tmp_reg__
 273 01c4 CF91      		pop r28
 274 01c6 DF91      		pop r29
 275 01c8 1F91      		pop r17
 276 01ca 0F91      		pop r16
 277 01cc FF90      		pop r15
 278 01ce EF90      		pop r14
 279 01d0 DF90      		pop r13
 280 01d2 CF90      		pop r12
 281 01d4 BF90      		pop r11
 282 01d6 AF90      		pop r10
 283 01d8 9F90      		pop r9
 284 01da 8F90      		pop r8
 285 01dc 7F90      		pop r7
GAS LISTING C:\Temp/cc64q1PH.s 			page 6


 286 01de 6F90      		pop r6
 287 01e0 0895      		ret
 288               		.size	SearchFreeCluster, .-SearchFreeCluster
 289               		.type	AllocCluster, @function
 290               	AllocCluster:
 291 01e2 EF92      		push r14
 292 01e4 FF92      		push r15
 293 01e6 0F93      		push r16
 294 01e8 1F93      		push r17
 295 01ea CF93      		push r28
 296 01ec DF93      		push r29
 297               	/* prologue: function */
 298               	/* frame size = 0 */
 299 01ee 7C01      		movw r14,r24
 300 01f0 FC01      		movw r30,r24
 301 01f2 C189      		ldd r28,Z+17
 302 01f4 D289      		ldd r29,Z+18
 303 01f6 2E81      		ldd r18,Y+6
 304 01f8 3F81      		ldd r19,Y+7
 305 01fa 4885      		ldd r20,Y+8
 306 01fc 5985      		ldd r21,Y+9
 307 01fe 2230      		cpi r18,lo8(2)
 308 0200 3105      		cpc r19,__zero_reg__
 309 0202 4105      		cpc r20,__zero_reg__
 310 0204 5105      		cpc r21,__zero_reg__
 311 0206 00F0      		brlo .L23
 312 0208 88A9      		ldd r24,Y+48
 313 020a 99A9      		ldd r25,Y+49
 314 020c AAA9      		ldd r26,Y+50
 315 020e BBA9      		ldd r27,Y+51
 316 0210 2817      		cp r18,r24
 317 0212 3907      		cpc r19,r25
 318 0214 4A07      		cpc r20,r26
 319 0216 5B07      		cpc r21,r27
 320 0218 00F0      		brlo .L24
 321               	.L23:
 322 021a 82E0      		ldi r24,lo8(2)
 323 021c 90E0      		ldi r25,hi8(2)
 324 021e A0E0      		ldi r26,hlo8(2)
 325 0220 B0E0      		ldi r27,hhi8(2)
 326 0222 8E83      		std Y+6,r24
 327 0224 9F83      		std Y+7,r25
 328 0226 A887      		std Y+8,r26
 329 0228 B987      		std Y+9,r27
 330               	.L24:
 331 022a 08A9      		ldd r16,Y+48
 332 022c 19A9      		ldd r17,Y+49
 333 022e 2AA9      		ldd r18,Y+50
 334 0230 3BA9      		ldd r19,Y+51
 335 0232 4E81      		ldd r20,Y+6
 336 0234 5F81      		ldd r21,Y+7
 337 0236 6885      		ldd r22,Y+8
 338 0238 7985      		ldd r23,Y+9
 339 023a C701      		movw r24,r14
 340 023c 0E94 0000 		call SearchFreeCluster
 341 0240 9B01      		movw r18,r22
 342 0242 AC01      		movw r20,r24
GAS LISTING C:\Temp/cc64q1PH.s 			page 7


 343 0244 6230      		cpi r22,lo8(2)
 344 0246 7105      		cpc r23,__zero_reg__
 345 0248 8105      		cpc r24,__zero_reg__
 346 024a 9105      		cpc r25,__zero_reg__
 347 024c 00F4      		brsh .L25
 348 024e 0E81      		ldd r16,Y+6
 349 0250 1F81      		ldd r17,Y+7
 350 0252 2885      		ldd r18,Y+8
 351 0254 3985      		ldd r19,Y+9
 352 0256 42E0      		ldi r20,lo8(2)
 353 0258 50E0      		ldi r21,hi8(2)
 354 025a 60E0      		ldi r22,hlo8(2)
 355 025c 70E0      		ldi r23,hhi8(2)
 356 025e C701      		movw r24,r14
 357 0260 0E94 0000 		call SearchFreeCluster
 358 0264 9B01      		movw r18,r22
 359 0266 AC01      		movw r20,r24
 360 0268 6230      		cpi r22,lo8(2)
 361 026a 7105      		cpc r23,__zero_reg__
 362 026c 8105      		cpc r24,__zero_reg__
 363 026e 9105      		cpc r25,__zero_reg__
 364 0270 00F4      		brsh .L25
 365 0272 1E82      		std Y+6,__zero_reg__
 366 0274 1F82      		std Y+7,__zero_reg__
 367 0276 1886      		std Y+8,__zero_reg__
 368 0278 1986      		std Y+9,__zero_reg__
 369 027a 8CE1      		ldi r24,lo8(28)
 370 027c 90E0      		ldi r25,hi8(28)
 371 027e 9093 0000 		sts (errno)+1,r25
 372 0282 8093 0000 		sts errno,r24
 373 0286 20E0      		ldi r18,lo8(0)
 374 0288 30E0      		ldi r19,hi8(0)
 375 028a 40E0      		ldi r20,hlo8(0)
 376 028c 50E0      		ldi r21,hhi8(0)
 377 028e 00C0      		rjmp .L26
 378               	.L25:
 379 0290 2E83      		std Y+6,r18
 380 0292 3F83      		std Y+7,r19
 381 0294 4887      		std Y+8,r20
 382 0296 5987      		std Y+9,r21
 383               	.L26:
 384 0298 B901      		movw r22,r18
 385 029a CA01      		movw r24,r20
 386               	/* epilogue start */
 387 029c DF91      		pop r29
 388 029e CF91      		pop r28
 389 02a0 1F91      		pop r17
 390 02a2 0F91      		pop r16
 391 02a4 FF90      		pop r15
 392 02a6 EF90      		pop r14
 393 02a8 0895      		ret
 394               		.size	AllocCluster, .-AllocCluster
 395               	.global	PhatFileRead
 396               		.type	PhatFileRead, @function
 397               	PhatFileRead:
 398 02aa 2F92      		push r2
 399 02ac 3F92      		push r3
GAS LISTING C:\Temp/cc64q1PH.s 			page 8


 400 02ae 4F92      		push r4
 401 02b0 5F92      		push r5
 402 02b2 6F92      		push r6
 403 02b4 7F92      		push r7
 404 02b6 8F92      		push r8
 405 02b8 9F92      		push r9
 406 02ba AF92      		push r10
 407 02bc BF92      		push r11
 408 02be CF92      		push r12
 409 02c0 DF92      		push r13
 410 02c2 EF92      		push r14
 411 02c4 FF92      		push r15
 412 02c6 0F93      		push r16
 413 02c8 1F93      		push r17
 414 02ca DF93      		push r29
 415 02cc CF93      		push r28
 416 02ce 00D0      		rcall .
 417 02d0 00D0      		rcall .
 418 02d2 CDB7      		in r28,__SP_L__
 419 02d4 DEB7      		in r29,__SP_H__
 420               	/* prologue: function */
 421               	/* frame size = 4 */
 422 02d6 3C01      		movw r6,r24
 423 02d8 2A01      		movw r4,r20
 424 02da 4B01      		movw r8,r22
 425 02dc DC01      		movw r26,r24
 426 02de 1296      		adiw r26,2
 427 02e0 2D90      		ld r2,X+
 428 02e2 3C90      		ld r3,X
 429 02e4 1397      		sbiw r26,2+1
 430 02e6 F101      		movw r30,r2
 431 02e8 A188      		ldd r10,Z+17
 432 02ea B288      		ldd r11,Z+18
 433 02ec 1496      		adiw r26,4
 434 02ee 8C91      		ld r24,X
 435 02f0 1497      		sbiw r26,4
 436 02f2 1596      		adiw r26,5
 437 02f4 9C91      		ld r25,X
 438 02f6 6115      		cp r22,__zero_reg__
 439 02f8 7105      		cpc r23,__zero_reg__
 440 02fa 01F4      		brne .+2
 441 02fc 00C0      		rjmp .L29
 442 02fe 4115      		cp r20,__zero_reg__
 443 0300 5105      		cpc r21,__zero_reg__
 444 0302 01F4      		brne .+2
 445 0304 00C0      		rjmp .L29
 446 0306 8C01      		movw r16,r24
 447 0308 D801      		movw r26,r16
 448 030a 9396      		adiw r26,35
 449 030c 8C91      		ld r24,X
 450 030e 9397      		sbiw r26,35
 451 0310 84FD      		sbrc r24,4
 452 0312 00C0      		rjmp .L30
 453 0314 CD90      		ld r12,X+
 454 0316 DD90      		ld r13,X+
 455 0318 ED90      		ld r14,X+
 456 031a FC90      		ld r15,X
GAS LISTING C:\Temp/cc64q1PH.s 			page 9


 457 031c 1397      		sbiw r26,3
 458 031e D496      		adiw r26,52
 459 0320 2D91      		ld r18,X+
 460 0322 3D91      		ld r19,X+
 461 0324 4D91      		ld r20,X+
 462 0326 5C91      		ld r21,X
 463 0328 D797      		sbiw r26,52+3
 464 032a C201      		movw r24,r4
 465 032c AA27      		clr r26
 466 032e 97FD      		sbrc r25,7
 467 0330 A095      		com r26
 468 0332 BA2F      		mov r27,r26
 469 0334 8C0D      		add r24,r12
 470 0336 9D1D      		adc r25,r13
 471 0338 AE1D      		adc r26,r14
 472 033a BF1D      		adc r27,r15
 473 033c 8217      		cp r24,r18
 474 033e 9307      		cpc r25,r19
 475 0340 A407      		cpc r26,r20
 476 0342 B507      		cpc r27,r21
 477 0344 00F0      		brlo .L30
 478 0346 2901      		movw r4,r18
 479 0348 4C18      		sub r4,r12
 480 034a 5D08      		sbc r5,r13
 481               	.L30:
 482 034c CC24      		clr r12
 483 034e DD24      		clr r13
 484 0350 00C0      		rjmp .L31
 485               	.L43:
 486 0352 F501      		movw r30,r10
 487 0354 8689      		ldd r24,Z+22
 488 0356 9789      		ldd r25,Z+23
 489 0358 A0E0      		ldi r26,lo8(0)
 490 035a B0E0      		ldi r27,hi8(0)
 491 035c F801      		movw r30,r16
 492 035e 2485      		ldd r18,Z+12
 493 0360 3585      		ldd r19,Z+13
 494 0362 4685      		ldd r20,Z+14
 495 0364 5785      		ldd r21,Z+15
 496 0366 2817      		cp r18,r24
 497 0368 3907      		cpc r19,r25
 498 036a 4A07      		cpc r20,r26
 499 036c 5B07      		cpc r21,r27
 500 036e 00F4      		brsh .+2
 501 0370 00C0      		rjmp .L32
 502 0372 C301      		movw r24,r6
 503 0374 0E94 0000 		call IsFixedRootDir
 504 0378 D801      		movw r26,r16
 505 037a 1896      		adiw r26,8
 506 037c 2D91      		ld r18,X+
 507 037e 3D91      		ld r19,X+
 508 0380 4D91      		ld r20,X+
 509 0382 5C91      		ld r21,X
 510 0384 1B97      		sbiw r26,8+3
 511 0386 892B      		or r24,r25
 512 0388 01F0      		breq .L33
 513 038a 2F5F      		subi r18,lo8(-(1))
GAS LISTING C:\Temp/cc64q1PH.s 			page 10


 514 038c 3F4F      		sbci r19,hi8(-(1))
 515 038e 4F4F      		sbci r20,hlo8(-(1))
 516 0390 5F4F      		sbci r21,hhi8(-(1))
 517 0392 F501      		movw r30,r10
 518 0394 86A1      		ldd r24,Z+38
 519 0396 97A1      		ldd r25,Z+39
 520 0398 A0E0      		ldi r26,lo8(0)
 521 039a B0E0      		ldi r27,hi8(0)
 522 039c 2817      		cp r18,r24
 523 039e 3907      		cpc r19,r25
 524 03a0 4A07      		cpc r20,r26
 525 03a2 5B07      		cpc r21,r27
 526 03a4 00F4      		brsh .+2
 527 03a6 00C0      		rjmp .L36
 528 03a8 00C0      		rjmp .L34
 529               	.L33:
 530 03aa 2F5F      		subi r18,lo8(-(1))
 531 03ac 3F4F      		sbci r19,hi8(-(1))
 532 03ae 4F4F      		sbci r20,hlo8(-(1))
 533 03b0 5F4F      		sbci r21,hhi8(-(1))
 534 03b2 F501      		movw r30,r10
 535 03b4 808D      		ldd r24,Z+24
 536 03b6 918D      		ldd r25,Z+25
 537 03b8 A0E0      		ldi r26,lo8(0)
 538 03ba B0E0      		ldi r27,hi8(0)
 539 03bc 2817      		cp r18,r24
 540 03be 3907      		cpc r19,r25
 541 03c0 4A07      		cpc r20,r26
 542 03c2 5B07      		cpc r21,r27
 543 03c4 00F4      		brsh .+2
 544 03c6 00C0      		rjmp .L36
 545 03c8 8081      		ld r24,Z
 546 03ca 9181      		ldd r25,Z+1
 547 03cc 8032      		cpi r24,32
 548 03ce 9105      		cpc r25,__zero_reg__
 549 03d0 01F4      		brne .L37
 550 03d2 D801      		movw r26,r16
 551 03d4 1496      		adiw r26,4
 552 03d6 4D91      		ld r20,X+
 553 03d8 5D91      		ld r21,X+
 554 03da 6D91      		ld r22,X+
 555 03dc 7C91      		ld r23,X
 556 03de 1797      		sbiw r26,4+3
 557 03e0 9E01      		movw r18,r28
 558 03e2 2F5F      		subi r18,lo8(-(1))
 559 03e4 3F4F      		sbci r19,hi8(-(1))
 560 03e6 C101      		movw r24,r2
 561 03e8 0E94 0000 		call Phat32GetClusterLink
 562 03ec 892B      		or r24,r25
 563 03ee 01F0      		breq .+2
 564 03f0 00C0      		rjmp .L34
 565 03f2 8981      		ldd r24,Y+1
 566 03f4 9A81      		ldd r25,Y+2
 567 03f6 AB81      		ldd r26,Y+3
 568 03f8 BC81      		ldd r27,Y+4
 569 03fa 885F      		subi r24,lo8(268435448)
 570 03fc 9F4F      		sbci r25,hi8(268435448)
GAS LISTING C:\Temp/cc64q1PH.s 			page 11


 571 03fe AF4F      		sbci r26,hlo8(268435448)
 572 0400 BF40      		sbci r27,hhi8(268435448)
 573 0402 00F0      		brlo .L38
 574 0404 00C0      		rjmp .L34
 575               	.L37:
 576 0406 D801      		movw r26,r16
 577 0408 1496      		adiw r26,4
 578 040a 4D91      		ld r20,X+
 579 040c 5D91      		ld r21,X+
 580 040e 6D91      		ld r22,X+
 581 0410 7C91      		ld r23,X
 582 0412 1797      		sbiw r26,4+3
 583 0414 4097      		sbiw r24,16
 584 0416 01F4      		brne .L39
 585 0418 9E01      		movw r18,r28
 586 041a 2F5F      		subi r18,lo8(-(1))
 587 041c 3F4F      		sbci r19,hi8(-(1))
 588 041e C101      		movw r24,r2
 589 0420 0E94 0000 		call Phat16GetClusterLink
 590 0424 892B      		or r24,r25
 591 0426 01F0      		breq .+2
 592 0428 00C0      		rjmp .L34
 593 042a 8981      		ldd r24,Y+1
 594 042c 9A81      		ldd r25,Y+2
 595 042e AB81      		ldd r26,Y+3
 596 0430 BC81      		ldd r27,Y+4
 597 0432 885F      		subi r24,lo8(65528)
 598 0434 9F4F      		sbci r25,hi8(65528)
 599 0436 A040      		sbci r26,hlo8(65528)
 600 0438 B040      		sbci r27,hhi8(65528)
 601 043a 00F0      		brlo .L38
 602 043c 00C0      		rjmp .L34
 603               	.L39:
 604 043e 9E01      		movw r18,r28
 605 0440 2F5F      		subi r18,lo8(-(1))
 606 0442 3F4F      		sbci r19,hi8(-(1))
 607 0444 C101      		movw r24,r2
 608 0446 0E94 0000 		call Phat12GetClusterLink
 609 044a 892B      		or r24,r25
 610 044c 01F0      		breq .+2
 611 044e 00C0      		rjmp .L34
 612 0450 8981      		ldd r24,Y+1
 613 0452 9A81      		ldd r25,Y+2
 614 0454 AB81      		ldd r26,Y+3
 615 0456 BC81      		ldd r27,Y+4
 616 0458 885F      		subi r24,lo8(4088)
 617 045a 9F40      		sbci r25,hi8(4088)
 618 045c A040      		sbci r26,hlo8(4088)
 619 045e B040      		sbci r27,hhi8(4088)
 620 0460 00F0      		brlo .+2
 621 0462 00C0      		rjmp .L34
 622               	.L38:
 623 0464 D801      		movw r26,r16
 624 0466 1896      		adiw r26,8
 625 0468 1D92      		st X+,__zero_reg__
 626 046a 1D92      		st X+,__zero_reg__
 627 046c 1D92      		st X+,__zero_reg__
GAS LISTING C:\Temp/cc64q1PH.s 			page 12


 628 046e 1C92      		st X,__zero_reg__
 629 0470 1B97      		sbiw r26,8+3
 630 0472 1496      		adiw r26,4
 631 0474 8D91      		ld r24,X+
 632 0476 9D91      		ld r25,X+
 633 0478 0D90      		ld __tmp_reg__,X+
 634 047a BC91      		ld r27,X
 635 047c A02D      		mov r26,__tmp_reg__
 636 047e F801      		movw r30,r16
 637 0480 808B      		std Z+16,r24
 638 0482 918B      		std Z+17,r25
 639 0484 A28B      		std Z+18,r26
 640 0486 B38B      		std Z+19,r27
 641 0488 8981      		ldd r24,Y+1
 642 048a 9A81      		ldd r25,Y+2
 643 048c AB81      		ldd r26,Y+3
 644 048e BC81      		ldd r27,Y+4
 645 0490 8483      		std Z+4,r24
 646 0492 9583      		std Z+5,r25
 647 0494 A683      		std Z+6,r26
 648 0496 B783      		std Z+7,r27
 649 0498 00C0      		rjmp .L35
 650               	.L36:
 651 049a D801      		movw r26,r16
 652 049c 1896      		adiw r26,8
 653 049e 2D93      		st X+,r18
 654 04a0 3D93      		st X+,r19
 655 04a2 4D93      		st X+,r20
 656 04a4 5C93      		st X,r21
 657 04a6 1B97      		sbiw r26,8+3
 658               	.L35:
 659 04a8 F801      		movw r30,r16
 660 04aa 1486      		std Z+12,__zero_reg__
 661 04ac 1586      		std Z+13,__zero_reg__
 662 04ae 1686      		std Z+14,__zero_reg__
 663 04b0 1786      		std Z+15,__zero_reg__
 664               	.L32:
 665 04b2 D801      		movw r26,r16
 666 04b4 1496      		adiw r26,4
 667 04b6 4D91      		ld r20,X+
 668 04b8 5D91      		ld r21,X+
 669 04ba 6D91      		ld r22,X+
 670 04bc 7C91      		ld r23,X
 671 04be 1797      		sbiw r26,4+3
 672 04c0 C301      		movw r24,r6
 673 04c2 0E94 0000 		call PhatClusterSector
 674 04c6 DC01      		movw r26,r24
 675 04c8 CB01      		movw r24,r22
 676 04ca F801      		movw r30,r16
 677 04cc 4085      		ldd r20,Z+8
 678 04ce 5185      		ldd r21,Z+9
 679 04d0 6285      		ldd r22,Z+10
 680 04d2 7385      		ldd r23,Z+11
 681 04d4 480F      		add r20,r24
 682 04d6 591F      		adc r21,r25
 683 04d8 6A1F      		adc r22,r26
 684 04da 7B1F      		adc r23,r27
GAS LISTING C:\Temp/cc64q1PH.s 			page 13


 685 04dc D301      		movw r26,r6
 686 04de 1296      		adiw r26,2
 687 04e0 8D91      		ld r24,X+
 688 04e2 9C91      		ld r25,X
 689 04e4 1397      		sbiw r26,2+1
 690 04e6 0E94 0000 		call PhatSectorLoad
 691 04ea FC01      		movw r30,r24
 692 04ec 97FF      		sbrs r25,7
 693 04ee 00C0      		rjmp .L40
 694 04f0 CC24      		clr r12
 695 04f2 CA94      		dec r12
 696 04f4 DC2C      		mov r13,r12
 697 04f6 00C0      		rjmp .L34
 698               	.L40:
 699 04f8 D801      		movw r26,r16
 700 04fa 1C96      		adiw r26,12
 701 04fc 4D91      		ld r20,X+
 702 04fe 5D91      		ld r21,X+
 703 0500 6D91      		ld r22,X+
 704 0502 7C91      		ld r23,X
 705 0504 1F97      		sbiw r26,12+3
 706 0506 D501      		movw r26,r10
 707 0508 5696      		adiw r26,22
 708 050a 8D91      		ld r24,X+
 709 050c 9C91      		ld r25,X
 710 050e 5797      		sbiw r26,22+1
 711 0510 841B      		sub r24,r20
 712 0512 950B      		sbc r25,r21
 713 0514 7201      		movw r14,r4
 714 0516 EC18      		sub r14,r12
 715 0518 FD08      		sbc r15,r13
 716 051a 8E15      		cp r24,r14
 717 051c 9F05      		cpc r25,r15
 718 051e 04F4      		brge .L41
 719 0520 7C01      		movw r14,r24
 720               	.L41:
 721 0522 9401      		movw r18,r8
 722 0524 2C0D      		add r18,r12
 723 0526 3D1D      		adc r19,r13
 724 0528 83E0      		ldi r24,3
 725 052a EE0F      	1:	lsl r30
 726 052c FF1F      		rol r31
 727 052e 8A95      		dec r24
 728 0530 01F4      		brne 1b
 729 0532 EA0D      		add r30,r10
 730 0534 FB1D      		adc r31,r11
 731 0536 8285      		ldd r24,Z+10
 732 0538 9385      		ldd r25,Z+11
 733 053a 840F      		add r24,r20
 734 053c 951F      		adc r25,r21
 735 053e A701      		movw r20,r14
 736 0540 BC01      		movw r22,r24
 737 0542 C901      		movw r24,r18
 738 0544 0E94 0000 		call memcpy
 739 0548 9701      		movw r18,r14
 740 054a 4427      		clr r20
 741 054c 37FD      		sbrc r19,7
GAS LISTING C:\Temp/cc64q1PH.s 			page 14


 742 054e 4095      		com r20
 743 0550 542F      		mov r21,r20
 744 0552 F801      		movw r30,r16
 745 0554 8081      		ld r24,Z
 746 0556 9181      		ldd r25,Z+1
 747 0558 A281      		ldd r26,Z+2
 748 055a B381      		ldd r27,Z+3
 749 055c 820F      		add r24,r18
 750 055e 931F      		adc r25,r19
 751 0560 A41F      		adc r26,r20
 752 0562 B51F      		adc r27,r21
 753 0564 8083      		st Z,r24
 754 0566 9183      		std Z+1,r25
 755 0568 A283      		std Z+2,r26
 756 056a B383      		std Z+3,r27
 757 056c 8485      		ldd r24,Z+12
 758 056e 9585      		ldd r25,Z+13
 759 0570 A685      		ldd r26,Z+14
 760 0572 B785      		ldd r27,Z+15
 761 0574 820F      		add r24,r18
 762 0576 931F      		adc r25,r19
 763 0578 A41F      		adc r26,r20
 764 057a B51F      		adc r27,r21
 765 057c 8487      		std Z+12,r24
 766 057e 9587      		std Z+13,r25
 767 0580 A687      		std Z+14,r26
 768 0582 B787      		std Z+15,r27
 769 0584 CE0C      		add r12,r14
 770 0586 DF1C      		adc r13,r15
 771               	.L31:
 772 0588 C414      		cp r12,r4
 773 058a D504      		cpc r13,r5
 774 058c 04F4      		brge .+2
 775 058e 00C0      		rjmp .L43
 776 0590 00C0      		rjmp .L34
 777               	.L29:
 778 0592 CC24      		clr r12
 779 0594 DD24      		clr r13
 780               	.L34:
 781 0596 C601      		movw r24,r12
 782               	/* epilogue start */
 783 0598 0F90      		pop __tmp_reg__
 784 059a 0F90      		pop __tmp_reg__
 785 059c 0F90      		pop __tmp_reg__
 786 059e 0F90      		pop __tmp_reg__
 787 05a0 CF91      		pop r28
 788 05a2 DF91      		pop r29
 789 05a4 1F91      		pop r17
 790 05a6 0F91      		pop r16
 791 05a8 FF90      		pop r15
 792 05aa EF90      		pop r14
 793 05ac DF90      		pop r13
 794 05ae CF90      		pop r12
 795 05b0 BF90      		pop r11
 796 05b2 AF90      		pop r10
 797 05b4 9F90      		pop r9
 798 05b6 8F90      		pop r8
GAS LISTING C:\Temp/cc64q1PH.s 			page 15


 799 05b8 7F90      		pop r7
 800 05ba 6F90      		pop r6
 801 05bc 5F90      		pop r5
 802 05be 4F90      		pop r4
 803 05c0 3F90      		pop r3
 804 05c2 2F90      		pop r2
 805 05c4 0895      		ret
 806               		.size	PhatFileRead, .-PhatFileRead
 807               		.type	PhatApiFileRead, @function
 808               	PhatApiFileRead:
 809 05c6 AF92      		push r10
 810 05c8 BF92      		push r11
 811 05ca CF92      		push r12
 812 05cc DF92      		push r13
 813 05ce EF92      		push r14
 814 05d0 FF92      		push r15
 815 05d2 0F93      		push r16
 816 05d4 1F93      		push r17
 817               	/* prologue: function */
 818               	/* frame size = 0 */
 819 05d6 6C01      		movw r12,r24
 820 05d8 5B01      		movw r10,r22
 821 05da 7A01      		movw r14,r20
 822 05dc DC01      		movw r26,r24
 823 05de 1296      		adiw r26,2
 824 05e0 ED91      		ld r30,X+
 825 05e2 FC91      		ld r31,X
 826 05e4 1397      		sbiw r26,2+1
 827 05e6 0189      		ldd r16,Z+17
 828 05e8 1289      		ldd r17,Z+18
 829 05ea 0E5E      		subi r16,lo8(-(18))
 830 05ec 1F4F      		sbci r17,hi8(-(18))
 831 05ee 40E0      		ldi r20,lo8(0)
 832 05f0 50E0      		ldi r21,hi8(0)
 833 05f2 60E0      		ldi r22,hlo8(0)
 834 05f4 70E0      		ldi r23,hhi8(0)
 835 05f6 C801      		movw r24,r16
 836 05f8 0E94 0000 		call NutEventWait
 837 05fc A701      		movw r20,r14
 838 05fe B501      		movw r22,r10
 839 0600 C601      		movw r24,r12
 840 0602 0E94 0000 		call PhatFileRead
 841 0606 F82E      		mov r15,r24
 842 0608 E92E      		mov r14,r25
 843 060a C801      		movw r24,r16
 844 060c 0E94 0000 		call NutEventPost
 845 0610 8F2D      		mov r24,r15
 846 0612 9E2D      		mov r25,r14
 847               	/* epilogue start */
 848 0614 1F91      		pop r17
 849 0616 0F91      		pop r16
 850 0618 FF90      		pop r15
 851 061a EF90      		pop r14
 852 061c DF90      		pop r13
 853 061e CF90      		pop r12
 854 0620 BF90      		pop r11
 855 0622 AF90      		pop r10
GAS LISTING C:\Temp/cc64q1PH.s 			page 16


 856 0624 0895      		ret
 857               		.size	PhatApiFileRead, .-PhatApiFileRead
 858               		.type	PhatFileFlush, @function
 859               	PhatFileFlush:
 860 0626 EF92      		push r14
 861 0628 FF92      		push r15
 862 062a 0F93      		push r16
 863 062c 1F93      		push r17
 864 062e CF93      		push r28
 865 0630 DF93      		push r29
 866               	/* prologue: function */
 867               	/* frame size = 0 */
 868 0632 7C01      		movw r14,r24
 869 0634 DC01      		movw r26,r24
 870 0636 1296      		adiw r26,2
 871 0638 ED91      		ld r30,X+
 872 063a FC91      		ld r31,X
 873 063c 1397      		sbiw r26,2+1
 874 063e 0189      		ldd r16,Z+17
 875 0640 1289      		ldd r17,Z+18
 876 0642 0E94 0000 		call PhatDirEntryUpdate
 877 0646 EC01      		movw r28,r24
 878 0648 0097      		sbiw r24,0
 879 064a 01F4      		brne .L48
 880 064c 0C5E      		subi r16,lo8(-(20))
 881 064e 1F4F      		sbci r17,hi8(-(20))
 882 0650 40E0      		ldi r20,lo8(0)
 883 0652 50E0      		ldi r21,hi8(0)
 884 0654 60E0      		ldi r22,hlo8(0)
 885 0656 70E0      		ldi r23,hhi8(0)
 886 0658 C801      		movw r24,r16
 887 065a 0E94 0000 		call NutEventWait
 888 065e 6FEF      		ldi r22,lo8(-1)
 889 0660 7FEF      		ldi r23,hi8(-1)
 890 0662 F701      		movw r30,r14
 891 0664 8281      		ldd r24,Z+2
 892 0666 9381      		ldd r25,Z+3
 893 0668 0E94 0000 		call PhatSectorFlush
 894 066c EC01      		movw r28,r24
 895 066e C801      		movw r24,r16
 896 0670 0E94 0000 		call NutEventPost
 897               	.L48:
 898 0674 CE01      		movw r24,r28
 899               	/* epilogue start */
 900 0676 DF91      		pop r29
 901 0678 CF91      		pop r28
 902 067a 1F91      		pop r17
 903 067c 0F91      		pop r16
 904 067e FF90      		pop r15
 905 0680 EF90      		pop r14
 906 0682 0895      		ret
 907               		.size	PhatFileFlush, .-PhatFileFlush
 908               		.type	AllocNextCluster, @function
 909               	AllocNextCluster:
 910 0684 8F92      		push r8
 911 0686 9F92      		push r9
 912 0688 AF92      		push r10
GAS LISTING C:\Temp/cc64q1PH.s 			page 17


 913 068a BF92      		push r11
 914 068c CF92      		push r12
 915 068e DF92      		push r13
 916 0690 EF92      		push r14
 917 0692 FF92      		push r15
 918 0694 0F93      		push r16
 919 0696 1F93      		push r17
 920 0698 CF93      		push r28
 921 069a DF93      		push r29
 922               	/* prologue: function */
 923               	/* frame size = 0 */
 924 069c FC01      		movw r30,r24
 925 069e C281      		ldd r28,Z+2
 926 06a0 D381      		ldd r29,Z+3
 927 06a2 1481      		ldd r17,Z+4
 928 06a4 0581      		ldd r16,Z+5
 929 06a6 9988      		ldd r9,Y+17
 930 06a8 8A88      		ldd r8,Y+18
 931 06aa CE01      		movw r24,r28
 932 06ac 0E94 0000 		call AllocCluster
 933 06b0 6B01      		movw r12,r22
 934 06b2 7C01      		movw r14,r24
 935 06b4 82E0      		ldi r24,lo8(2)
 936 06b6 C816      		cp r12,r24
 937 06b8 D104      		cpc r13,__zero_reg__
 938 06ba E104      		cpc r14,__zero_reg__
 939 06bc F104      		cpc r15,__zero_reg__
 940 06be 00F4      		brsh .+2
 941 06c0 00C0      		rjmp .L51
 942 06c2 E12F      		mov r30,r17
 943 06c4 F02F      		mov r31,r16
 944 06c6 A92C      		mov r10,r9
 945 06c8 B82C      		mov r11,r8
 946 06ca D501      		movw r26,r10
 947 06cc 8D91      		ld r24,X+
 948 06ce 9C91      		ld r25,X
 949 06d0 8032      		cpi r24,32
 950 06d2 9105      		cpc r25,__zero_reg__
 951 06d4 01F4      		brne .L52
 952 06d6 4481      		ldd r20,Z+4
 953 06d8 5581      		ldd r21,Z+5
 954 06da 6681      		ldd r22,Z+6
 955 06dc 7781      		ldd r23,Z+7
 956 06de 9701      		movw r18,r14
 957 06e0 8601      		movw r16,r12
 958 06e2 CE01      		movw r24,r28
 959 06e4 0E94 0000 		call Phat32SetClusterLink
 960 06e8 892B      		or r24,r25
 961 06ea 01F0      		breq .+2
 962 06ec 00C0      		rjmp .L51
 963 06ee 0FEF      		ldi r16,lo8(268435455)
 964 06f0 1FEF      		ldi r17,hi8(268435455)
 965 06f2 2FEF      		ldi r18,hlo8(268435455)
 966 06f4 3FE0      		ldi r19,hhi8(268435455)
 967 06f6 B701      		movw r22,r14
 968 06f8 A601      		movw r20,r12
 969 06fa CE01      		movw r24,r28
GAS LISTING C:\Temp/cc64q1PH.s 			page 18


 970 06fc 0E94 0000 		call Phat32SetClusterLink
 971 0700 00C0      		rjmp .L57
 972               	.L52:
 973 0702 4481      		ldd r20,Z+4
 974 0704 5581      		ldd r21,Z+5
 975 0706 6681      		ldd r22,Z+6
 976 0708 7781      		ldd r23,Z+7
 977 070a 4097      		sbiw r24,16
 978 070c 01F4      		brne .L54
 979 070e 9701      		movw r18,r14
 980 0710 8601      		movw r16,r12
 981 0712 CE01      		movw r24,r28
 982 0714 0E94 0000 		call Phat16SetClusterLink
 983 0718 892B      		or r24,r25
 984 071a 01F4      		brne .L51
 985 071c 0FEF      		ldi r16,lo8(65535)
 986 071e 1FEF      		ldi r17,hi8(65535)
 987 0720 20E0      		ldi r18,hlo8(65535)
 988 0722 30E0      		ldi r19,hhi8(65535)
 989 0724 B701      		movw r22,r14
 990 0726 A601      		movw r20,r12
 991 0728 CE01      		movw r24,r28
 992 072a 0E94 0000 		call Phat16SetClusterLink
 993 072e 00C0      		rjmp .L57
 994               	.L54:
 995 0730 9701      		movw r18,r14
 996 0732 8601      		movw r16,r12
 997 0734 CE01      		movw r24,r28
 998 0736 0E94 0000 		call Phat12SetClusterLink
 999 073a 892B      		or r24,r25
 1000 073c 01F4      		brne .L51
 1001 073e 0FEF      		ldi r16,lo8(4095)
 1002 0740 1FE0      		ldi r17,hi8(4095)
 1003 0742 20E0      		ldi r18,hlo8(4095)
 1004 0744 30E0      		ldi r19,hhi8(4095)
 1005 0746 B701      		movw r22,r14
 1006 0748 A601      		movw r20,r12
 1007 074a CE01      		movw r24,r28
 1008 074c 0E94 0000 		call Phat12SetClusterLink
 1009               	.L57:
 1010 0750 892B      		or r24,r25
 1011 0752 01F4      		brne .L51
 1012 0754 F501      		movw r30,r10
 1013 0756 8281      		ldd r24,Z+2
 1014 0758 9381      		ldd r25,Z+3
 1015 075a A481      		ldd r26,Z+4
 1016 075c B581      		ldd r27,Z+5
 1017 075e 0197      		sbiw r24,1
 1018 0760 A109      		sbc r26,__zero_reg__
 1019 0762 B109      		sbc r27,__zero_reg__
 1020 0764 8283      		std Z+2,r24
 1021 0766 9383      		std Z+3,r25
 1022 0768 A483      		std Z+4,r26
 1023 076a B583      		std Z+5,r27
 1024 076c 00C0      		rjmp .L55
 1025               	.L51:
 1026 076e CC24      		clr r12
GAS LISTING C:\Temp/cc64q1PH.s 			page 19


 1027 0770 DD24      		clr r13
 1028 0772 7601      		movw r14,r12
 1029               	.L55:
 1030 0774 B601      		movw r22,r12
 1031 0776 C701      		movw r24,r14
 1032               	/* epilogue start */
 1033 0778 DF91      		pop r29
 1034 077a CF91      		pop r28
 1035 077c 1F91      		pop r17
 1036 077e 0F91      		pop r16
 1037 0780 FF90      		pop r15
 1038 0782 EF90      		pop r14
 1039 0784 DF90      		pop r13
 1040 0786 CF90      		pop r12
 1041 0788 BF90      		pop r11
 1042 078a AF90      		pop r10
 1043 078c 9F90      		pop r9
 1044 078e 8F90      		pop r8
 1045 0790 0895      		ret
 1046               		.size	AllocNextCluster, .-AllocNextCluster
 1047               	.global	AllocFirstCluster
 1048               		.type	AllocFirstCluster, @function
 1049               	AllocFirstCluster:
 1050 0792 8F92      		push r8
 1051 0794 9F92      		push r9
 1052 0796 AF92      		push r10
 1053 0798 BF92      		push r11
 1054 079a CF92      		push r12
 1055 079c DF92      		push r13
 1056 079e EF92      		push r14
 1057 07a0 FF92      		push r15
 1058 07a2 0F93      		push r16
 1059 07a4 1F93      		push r17
 1060 07a6 CF93      		push r28
 1061 07a8 DF93      		push r29
 1062               	/* prologue: function */
 1063               	/* frame size = 0 */
 1064 07aa FC01      		movw r30,r24
 1065 07ac A280      		ldd r10,Z+2
 1066 07ae B380      		ldd r11,Z+3
 1067 07b0 D501      		movw r26,r10
 1068 07b2 5196      		adiw r26,17
 1069 07b4 1C91      		ld r17,X
 1070 07b6 5197      		sbiw r26,17
 1071 07b8 5296      		adiw r26,18
 1072 07ba 0C91      		ld r16,X
 1073 07bc 9480      		ldd r9,Z+4
 1074 07be 8580      		ldd r8,Z+5
 1075 07c0 C501      		movw r24,r10
 1076 07c2 0E94 0000 		call AllocCluster
 1077 07c6 6B01      		movw r12,r22
 1078 07c8 7C01      		movw r14,r24
 1079 07ca 6230      		cpi r22,lo8(2)
 1080 07cc 7105      		cpc r23,__zero_reg__
 1081 07ce 8105      		cpc r24,__zero_reg__
 1082 07d0 9105      		cpc r25,__zero_reg__
 1083 07d2 00F4      		brsh .+2
GAS LISTING C:\Temp/cc64q1PH.s 			page 20


 1084 07d4 00C0      		rjmp .L59
 1085 07d6 C12F      		mov r28,r17
 1086 07d8 D02F      		mov r29,r16
 1087 07da E92D      		mov r30,r9
 1088 07dc F82D      		mov r31,r8
 1089 07de C701      		movw r24,r14
 1090 07e0 AA27      		clr r26
 1091 07e2 BB27      		clr r27
 1092 07e4 95A7      		std Z+45,r25
 1093 07e6 84A7      		std Z+44,r24
 1094 07e8 D3AA      		std Z+51,r13
 1095 07ea C2AA      		std Z+50,r12
 1096 07ec E05C      		subi r30,lo8(-(64))
 1097 07ee FF4F      		sbci r31,hi8(-(64))
 1098 07f0 81E0      		ldi r24,lo8(1)
 1099 07f2 90E0      		ldi r25,hi8(1)
 1100 07f4 9183      		std Z+1,r25
 1101 07f6 8083      		st Z,r24
 1102 07f8 8881      		ld r24,Y
 1103 07fa 9981      		ldd r25,Y+1
 1104 07fc 8032      		cpi r24,32
 1105 07fe 9105      		cpc r25,__zero_reg__
 1106 0800 01F4      		brne .L60
 1107 0802 0FEF      		ldi r16,lo8(268435455)
 1108 0804 1FEF      		ldi r17,hi8(268435455)
 1109 0806 2FEF      		ldi r18,hlo8(268435455)
 1110 0808 3FE0      		ldi r19,hhi8(268435455)
 1111 080a B701      		movw r22,r14
 1112 080c A601      		movw r20,r12
 1113 080e C501      		movw r24,r10
 1114 0810 0E94 0000 		call Phat32SetClusterLink
 1115 0814 00C0      		rjmp .L65
 1116               	.L60:
 1117 0816 4097      		sbiw r24,16
 1118 0818 01F4      		brne .L62
 1119 081a 0FEF      		ldi r16,lo8(65535)
 1120 081c 1FEF      		ldi r17,hi8(65535)
 1121 081e 20E0      		ldi r18,hlo8(65535)
 1122 0820 30E0      		ldi r19,hhi8(65535)
 1123 0822 B701      		movw r22,r14
 1124 0824 A601      		movw r20,r12
 1125 0826 C501      		movw r24,r10
 1126 0828 0E94 0000 		call Phat16SetClusterLink
 1127 082c 00C0      		rjmp .L65
 1128               	.L62:
 1129 082e 0FEF      		ldi r16,lo8(4095)
 1130 0830 1FE0      		ldi r17,hi8(4095)
 1131 0832 20E0      		ldi r18,hlo8(4095)
 1132 0834 30E0      		ldi r19,hhi8(4095)
 1133 0836 B701      		movw r22,r14
 1134 0838 A601      		movw r20,r12
 1135 083a C501      		movw r24,r10
 1136 083c 0E94 0000 		call Phat12SetClusterLink
 1137               	.L65:
 1138 0840 892B      		or r24,r25
 1139 0842 01F4      		brne .L59
 1140 0844 8A81      		ldd r24,Y+2
GAS LISTING C:\Temp/cc64q1PH.s 			page 21


 1141 0846 9B81      		ldd r25,Y+3
 1142 0848 AC81      		ldd r26,Y+4
 1143 084a BD81      		ldd r27,Y+5
 1144 084c 0197      		sbiw r24,1
 1145 084e A109      		sbc r26,__zero_reg__
 1146 0850 B109      		sbc r27,__zero_reg__
 1147 0852 8A83      		std Y+2,r24
 1148 0854 9B83      		std Y+3,r25
 1149 0856 AC83      		std Y+4,r26
 1150 0858 BD83      		std Y+5,r27
 1151 085a 00C0      		rjmp .L63
 1152               	.L59:
 1153 085c CC24      		clr r12
 1154 085e DD24      		clr r13
 1155 0860 7601      		movw r14,r12
 1156               	.L63:
 1157 0862 B601      		movw r22,r12
 1158 0864 C701      		movw r24,r14
 1159               	/* epilogue start */
 1160 0866 DF91      		pop r29
 1161 0868 CF91      		pop r28
 1162 086a 1F91      		pop r17
 1163 086c 0F91      		pop r16
 1164 086e FF90      		pop r15
 1165 0870 EF90      		pop r14
 1166 0872 DF90      		pop r13
 1167 0874 CF90      		pop r12
 1168 0876 BF90      		pop r11
 1169 0878 AF90      		pop r10
 1170 087a 9F90      		pop r9
 1171 087c 8F90      		pop r8
 1172 087e 0895      		ret
 1173               		.size	AllocFirstCluster, .-AllocFirstCluster
 1174               	.global	PhatFileWrite
 1175               		.type	PhatFileWrite, @function
 1176               	PhatFileWrite:
 1177 0880 2F92      		push r2
 1178 0882 3F92      		push r3
 1179 0884 4F92      		push r4
 1180 0886 5F92      		push r5
 1181 0888 6F92      		push r6
 1182 088a 7F92      		push r7
 1183 088c 8F92      		push r8
 1184 088e 9F92      		push r9
 1185 0890 AF92      		push r10
 1186 0892 BF92      		push r11
 1187 0894 CF92      		push r12
 1188 0896 DF92      		push r13
 1189 0898 EF92      		push r14
 1190 089a FF92      		push r15
 1191 089c 0F93      		push r16
 1192 089e 1F93      		push r17
 1193 08a0 DF93      		push r29
 1194 08a2 CF93      		push r28
 1195 08a4 CDB7      		in r28,__SP_L__
 1196 08a6 DEB7      		in r29,__SP_H__
 1197 08a8 2C97      		sbiw r28,12
GAS LISTING C:\Temp/cc64q1PH.s 			page 22


 1198 08aa 0FB6      		in __tmp_reg__,__SREG__
 1199 08ac F894      		cli
 1200 08ae DEBF      		out __SP_H__,r29
 1201 08b0 0FBE      		out __SREG__,__tmp_reg__
 1202 08b2 CDBF      		out __SP_L__,r28
 1203               	/* prologue: function */
 1204               	/* frame size = 12 */
 1205 08b4 2C01      		movw r4,r24
 1206 08b6 5C87      		std Y+12,r21
 1207 08b8 4B87      		std Y+11,r20
 1208 08ba DC01      		movw r26,r24
 1209 08bc 1296      		adiw r26,2
 1210 08be 0D90      		ld __tmp_reg__,X+
 1211 08c0 BC91      		ld r27,X
 1212 08c2 A02D      		mov r26,__tmp_reg__
 1213 08c4 BE83      		std Y+6,r27
 1214 08c6 AD83      		std Y+5,r26
 1215 08c8 FC01      		movw r30,r24
 1216 08ca 8480      		ldd r8,Z+4
 1217 08cc 9580      		ldd r9,Z+5
 1218 08ce 5196      		adiw r26,17
 1219 08d0 9C91      		ld r25,X
 1220 08d2 5197      		sbiw r26,17
 1221 08d4 5296      		adiw r26,18
 1222 08d6 2C91      		ld r18,X
 1223 08d8 D401      		movw r26,r8
 1224 08da 9396      		adiw r26,35
 1225 08dc 8C91      		ld r24,X
 1226 08de 80FF      		sbrs r24,0
 1227 08e0 00C0      		rjmp .L67
 1228 08e2 8DE0      		ldi r24,lo8(13)
 1229 08e4 90E0      		ldi r25,hi8(13)
 1230 08e6 00C0      		rjmp .L90
 1231               	.L67:
 1232 08e8 1B01      		movw r2,r22
 1233 08ea 6115      		cp r22,__zero_reg__
 1234 08ec 7105      		cpc r23,__zero_reg__
 1235 08ee 01F0      		breq .L69
 1236 08f0 EB85      		ldd r30,Y+11
 1237 08f2 FC85      		ldd r31,Y+12
 1238 08f4 EF2B      		or r30,r31
 1239 08f6 01F4      		brne .L70
 1240               	.L69:
 1241 08f8 C201      		movw r24,r4
 1242 08fa 0E94 0000 		call PhatFileFlush
 1243 08fe 8C01      		movw r16,r24
 1244 0900 00C0      		rjmp .L68
 1245               	.L70:
 1246 0902 692E      		mov r6,r25
 1247 0904 722E      		mov r7,r18
 1248 0906 84FD      		sbrc r24,4
 1249 0908 00C0      		rjmp .L71
 1250 090a D301      		movw r26,r6
 1251 090c 5896      		adiw r26,24
 1252 090e 2D91      		ld r18,X+
 1253 0910 3C91      		ld r19,X
 1254 0912 5997      		sbiw r26,24+1
GAS LISTING C:\Temp/cc64q1PH.s 			page 23


 1255 0914 5696      		adiw r26,22
 1256 0916 8D91      		ld r24,X+
 1257 0918 9C91      		ld r25,X
 1258 091a 5797      		sbiw r26,22+1
 1259 091c 289F      		mul r18,r24
 1260 091e 7001      		movw r14,r0
 1261 0920 299F      		mul r18,r25
 1262 0922 F00C      		add r15,r0
 1263 0924 389F      		mul r19,r24
 1264 0926 F00C      		add r15,r0
 1265 0928 1124      		clr r1
 1266 092a 00E0      		ldi r16,lo8(0)
 1267 092c 10E0      		ldi r17,hi8(0)
 1268 092e D401      		movw r26,r8
 1269 0930 D496      		adiw r26,52
 1270 0932 8D91      		ld r24,X+
 1271 0934 9D91      		ld r25,X+
 1272 0936 0D90      		ld __tmp_reg__,X+
 1273 0938 BC91      		ld r27,X
 1274 093a A02D      		mov r26,__tmp_reg__
 1275 093c 8F83      		std Y+7,r24
 1276 093e 9887      		std Y+8,r25
 1277 0940 A987      		std Y+9,r26
 1278 0942 BA87      		std Y+10,r27
 1279 0944 BC01      		movw r22,r24
 1280 0946 CD01      		movw r24,r26
 1281 0948 6150      		subi r22,lo8(-(-1))
 1282 094a 7040      		sbci r23,hi8(-(-1))
 1283 094c 8040      		sbci r24,hlo8(-(-1))
 1284 094e 9040      		sbci r25,hhi8(-(-1))
 1285 0950 6E0D      		add r22,r14
 1286 0952 7F1D      		adc r23,r15
 1287 0954 801F      		adc r24,r16
 1288 0956 911F      		adc r25,r17
 1289 0958 A801      		movw r20,r16
 1290 095a 9701      		movw r18,r14
 1291 095c 0E94 0000 		call __udivmodsi4
 1292 0960 5901      		movw r10,r18
 1293 0962 6A01      		movw r12,r20
 1294 0964 F401      		movw r30,r8
 1295 0966 6081      		ld r22,Z
 1296 0968 7181      		ldd r23,Z+1
 1297 096a 8281      		ldd r24,Z+2
 1298 096c 9381      		ldd r25,Z+3
 1299 096e 6150      		subi r22,lo8(-(-1))
 1300 0970 7040      		sbci r23,hi8(-(-1))
 1301 0972 8040      		sbci r24,hlo8(-(-1))
 1302 0974 9040      		sbci r25,hhi8(-(-1))
 1303 0976 6E0D      		add r22,r14
 1304 0978 7F1D      		adc r23,r15
 1305 097a 801F      		adc r24,r16
 1306 097c 911F      		adc r25,r17
 1307 097e AB85      		ldd r26,Y+11
 1308 0980 BC85      		ldd r27,Y+12
 1309 0982 9D01      		movw r18,r26
 1310 0984 4427      		clr r20
 1311 0986 37FD      		sbrc r19,7
GAS LISTING C:\Temp/cc64q1PH.s 			page 24


 1312 0988 4095      		com r20
 1313 098a 542F      		mov r21,r20
 1314 098c 620F      		add r22,r18
 1315 098e 731F      		adc r23,r19
 1316 0990 841F      		adc r24,r20
 1317 0992 951F      		adc r25,r21
 1318 0994 A801      		movw r20,r16
 1319 0996 9701      		movw r18,r14
 1320 0998 0E94 0000 		call __udivmodsi4
 1321 099c 7901      		movw r14,r18
 1322 099e 8A01      		movw r16,r20
 1323 09a0 AE14      		cp r10,r14
 1324 09a2 BF04      		cpc r11,r15
 1325 09a4 C006      		cpc r12,r16
 1326 09a6 D106      		cpc r13,r17
 1327 09a8 00F4      		brsh .L72
 1328 09aa EA18      		sub r14,r10
 1329 09ac FB08      		sbc r15,r11
 1330 09ae 0C09      		sbc r16,r12
 1331 09b0 1D09      		sbc r17,r13
 1332 09b2 F301      		movw r30,r6
 1333 09b4 8281      		ldd r24,Z+2
 1334 09b6 9381      		ldd r25,Z+3
 1335 09b8 A481      		ldd r26,Z+4
 1336 09ba B581      		ldd r27,Z+5
 1337 09bc 8E15      		cp r24,r14
 1338 09be 9F05      		cpc r25,r15
 1339 09c0 A007      		cpc r26,r16
 1340 09c2 B107      		cpc r27,r17
 1341 09c4 00F4      		brsh .L72
 1342 09c6 8CE1      		ldi r24,lo8(28)
 1343 09c8 90E0      		ldi r25,hi8(28)
 1344               	.L90:
 1345 09ca 9093 0000 		sts (errno)+1,r25
 1346 09ce 8093 0000 		sts errno,r24
 1347 09d2 00C0      		rjmp .L73
 1348               	.L72:
 1349 09d4 8F81      		ldd r24,Y+7
 1350 09d6 9885      		ldd r25,Y+8
 1351 09d8 A985      		ldd r26,Y+9
 1352 09da BA85      		ldd r27,Y+10
 1353 09dc 0097      		sbiw r24,0
 1354 09de A105      		cpc r26,__zero_reg__
 1355 09e0 B105      		cpc r27,__zero_reg__
 1356 09e2 01F4      		brne .L71
 1357 09e4 C201      		movw r24,r4
 1358 09e6 0E94 0000 		call AllocFirstCluster
 1359 09ea 6230      		cpi r22,lo8(2)
 1360 09ec 7105      		cpc r23,__zero_reg__
 1361 09ee 8105      		cpc r24,__zero_reg__
 1362 09f0 9105      		cpc r25,__zero_reg__
 1363 09f2 00F4      		brsh .+2
 1364 09f4 00C0      		rjmp .L73
 1365 09f6 6983      		std Y+1,r22
 1366 09f8 7A83      		std Y+2,r23
 1367 09fa 8B83      		std Y+3,r24
 1368 09fc 9C83      		std Y+4,r25
GAS LISTING C:\Temp/cc64q1PH.s 			page 25


 1369 09fe D401      		movw r26,r8
 1370 0a00 5096      		adiw r26,16
 1371 0a02 6D93      		st X+,r22
 1372 0a04 7D93      		st X+,r23
 1373 0a06 8D93      		st X+,r24
 1374 0a08 9C93      		st X,r25
 1375 0a0a 5397      		sbiw r26,16+3
 1376 0a0c F401      		movw r30,r8
 1377 0a0e 6483      		std Z+4,r22
 1378 0a10 7583      		std Z+5,r23
 1379 0a12 8683      		std Z+6,r24
 1380 0a14 9783      		std Z+7,r25
 1381               	.L71:
 1382 0a16 CC24      		clr r12
 1383 0a18 DD24      		clr r13
 1384 0a1a 5E01      		movw r10,r28
 1385 0a1c 0894      		sec
 1386 0a1e A11C      		adc r10,__zero_reg__
 1387 0a20 B11C      		adc r11,__zero_reg__
 1388 0a22 00C0      		rjmp .L74
 1389               	.L85:
 1390 0a24 D301      		movw r26,r6
 1391 0a26 5696      		adiw r26,22
 1392 0a28 8D91      		ld r24,X+
 1393 0a2a 9C91      		ld r25,X
 1394 0a2c 5797      		sbiw r26,22+1
 1395 0a2e A0E0      		ldi r26,lo8(0)
 1396 0a30 B0E0      		ldi r27,hi8(0)
 1397 0a32 F401      		movw r30,r8
 1398 0a34 2485      		ldd r18,Z+12
 1399 0a36 3585      		ldd r19,Z+13
 1400 0a38 4685      		ldd r20,Z+14
 1401 0a3a 5785      		ldd r21,Z+15
 1402 0a3c 2817      		cp r18,r24
 1403 0a3e 3907      		cpc r19,r25
 1404 0a40 4A07      		cpc r20,r26
 1405 0a42 5B07      		cpc r21,r27
 1406 0a44 00F4      		brsh .+2
 1407 0a46 00C0      		rjmp .L75
 1408 0a48 C201      		movw r24,r4
 1409 0a4a 0E94 0000 		call IsFixedRootDir
 1410 0a4e D401      		movw r26,r8
 1411 0a50 1896      		adiw r26,8
 1412 0a52 2D91      		ld r18,X+
 1413 0a54 3D91      		ld r19,X+
 1414 0a56 4D91      		ld r20,X+
 1415 0a58 5C91      		ld r21,X
 1416 0a5a 1B97      		sbiw r26,8+3
 1417 0a5c 892B      		or r24,r25
 1418 0a5e 01F0      		breq .L76
 1419 0a60 2F5F      		subi r18,lo8(-(1))
 1420 0a62 3F4F      		sbci r19,hi8(-(1))
 1421 0a64 4F4F      		sbci r20,hlo8(-(1))
 1422 0a66 5F4F      		sbci r21,hhi8(-(1))
 1423 0a68 F301      		movw r30,r6
 1424 0a6a 86A1      		ldd r24,Z+38
 1425 0a6c 97A1      		ldd r25,Z+39
GAS LISTING C:\Temp/cc64q1PH.s 			page 26


 1426 0a6e A0E0      		ldi r26,lo8(0)
 1427 0a70 B0E0      		ldi r27,hi8(0)
 1428 0a72 2817      		cp r18,r24
 1429 0a74 3907      		cpc r19,r25
 1430 0a76 4A07      		cpc r20,r26
 1431 0a78 5B07      		cpc r21,r27
 1432 0a7a 00F4      		brsh .+2
 1433 0a7c 00C0      		rjmp .L79
 1434 0a7e 00C0      		rjmp .L77
 1435               	.L76:
 1436 0a80 2F5F      		subi r18,lo8(-(1))
 1437 0a82 3F4F      		sbci r19,hi8(-(1))
 1438 0a84 4F4F      		sbci r20,hlo8(-(1))
 1439 0a86 5F4F      		sbci r21,hhi8(-(1))
 1440 0a88 F301      		movw r30,r6
 1441 0a8a 808D      		ldd r24,Z+24
 1442 0a8c 918D      		ldd r25,Z+25
 1443 0a8e A0E0      		ldi r26,lo8(0)
 1444 0a90 B0E0      		ldi r27,hi8(0)
 1445 0a92 2817      		cp r18,r24
 1446 0a94 3907      		cpc r19,r25
 1447 0a96 4A07      		cpc r20,r26
 1448 0a98 5B07      		cpc r21,r27
 1449 0a9a 00F4      		brsh .+2
 1450 0a9c 00C0      		rjmp .L79
 1451 0a9e 8081      		ld r24,Z
 1452 0aa0 9181      		ldd r25,Z+1
 1453 0aa2 8032      		cpi r24,32
 1454 0aa4 9105      		cpc r25,__zero_reg__
 1455 0aa6 01F4      		brne .L80
 1456 0aa8 D401      		movw r26,r8
 1457 0aaa 1496      		adiw r26,4
 1458 0aac 4D91      		ld r20,X+
 1459 0aae 5D91      		ld r21,X+
 1460 0ab0 6D91      		ld r22,X+
 1461 0ab2 7C91      		ld r23,X
 1462 0ab4 1797      		sbiw r26,4+3
 1463 0ab6 9501      		movw r18,r10
 1464 0ab8 8D81      		ldd r24,Y+5
 1465 0aba 9E81      		ldd r25,Y+6
 1466 0abc 0E94 0000 		call Phat32GetClusterLink
 1467 0ac0 892B      		or r24,r25
 1468 0ac2 01F0      		breq .+2
 1469 0ac4 00C0      		rjmp .L73
 1470 0ac6 8981      		ldd r24,Y+1
 1471 0ac8 9A81      		ldd r25,Y+2
 1472 0aca AB81      		ldd r26,Y+3
 1473 0acc BC81      		ldd r27,Y+4
 1474 0ace 885F      		subi r24,lo8(268435448)
 1475 0ad0 9F4F      		sbci r25,hi8(268435448)
 1476 0ad2 AF4F      		sbci r26,hlo8(268435448)
 1477 0ad4 BF40      		sbci r27,hhi8(268435448)
 1478 0ad6 00F4      		brsh .+2
 1479 0ad8 00C0      		rjmp .L81
 1480 0ada 00C0      		rjmp .L89
 1481               	.L80:
 1482 0adc D401      		movw r26,r8
GAS LISTING C:\Temp/cc64q1PH.s 			page 27


 1483 0ade 1496      		adiw r26,4
 1484 0ae0 4D91      		ld r20,X+
 1485 0ae2 5D91      		ld r21,X+
 1486 0ae4 6D91      		ld r22,X+
 1487 0ae6 7C91      		ld r23,X
 1488 0ae8 1797      		sbiw r26,4+3
 1489 0aea 4097      		sbiw r24,16
 1490 0aec 01F4      		brne .L82
 1491 0aee 9501      		movw r18,r10
 1492 0af0 8D81      		ldd r24,Y+5
 1493 0af2 9E81      		ldd r25,Y+6
 1494 0af4 0E94 0000 		call Phat16GetClusterLink
 1495 0af8 892B      		or r24,r25
 1496 0afa 01F0      		breq .+2
 1497 0afc 00C0      		rjmp .L73
 1498 0afe 8981      		ldd r24,Y+1
 1499 0b00 9A81      		ldd r25,Y+2
 1500 0b02 AB81      		ldd r26,Y+3
 1501 0b04 BC81      		ldd r27,Y+4
 1502 0b06 885F      		subi r24,lo8(65528)
 1503 0b08 9F4F      		sbci r25,hi8(65528)
 1504 0b0a A040      		sbci r26,hlo8(65528)
 1505 0b0c B040      		sbci r27,hhi8(65528)
 1506 0b0e 00F0      		brlo .L81
 1507 0b10 00C0      		rjmp .L89
 1508               	.L82:
 1509 0b12 9501      		movw r18,r10
 1510 0b14 8D81      		ldd r24,Y+5
 1511 0b16 9E81      		ldd r25,Y+6
 1512 0b18 0E94 0000 		call Phat12GetClusterLink
 1513 0b1c 892B      		or r24,r25
 1514 0b1e 01F0      		breq .+2
 1515 0b20 00C0      		rjmp .L73
 1516 0b22 8981      		ldd r24,Y+1
 1517 0b24 9A81      		ldd r25,Y+2
 1518 0b26 AB81      		ldd r26,Y+3
 1519 0b28 BC81      		ldd r27,Y+4
 1520 0b2a 885F      		subi r24,lo8(4088)
 1521 0b2c 9F40      		sbci r25,hi8(4088)
 1522 0b2e A040      		sbci r26,hlo8(4088)
 1523 0b30 B040      		sbci r27,hhi8(4088)
 1524 0b32 00F0      		brlo .L81
 1525               	.L89:
 1526 0b34 C201      		movw r24,r4
 1527 0b36 0E94 0000 		call AllocNextCluster
 1528 0b3a 6230      		cpi r22,lo8(2)
 1529 0b3c 7105      		cpc r23,__zero_reg__
 1530 0b3e 8105      		cpc r24,__zero_reg__
 1531 0b40 9105      		cpc r25,__zero_reg__
 1532 0b42 00F4      		brsh .+2
 1533 0b44 00C0      		rjmp .L73
 1534 0b46 6983      		std Y+1,r22
 1535 0b48 7A83      		std Y+2,r23
 1536 0b4a 8B83      		std Y+3,r24
 1537 0b4c 9C83      		std Y+4,r25
 1538               	.L81:
 1539 0b4e D401      		movw r26,r8
GAS LISTING C:\Temp/cc64q1PH.s 			page 28


 1540 0b50 1896      		adiw r26,8
 1541 0b52 1D92      		st X+,__zero_reg__
 1542 0b54 1D92      		st X+,__zero_reg__
 1543 0b56 1D92      		st X+,__zero_reg__
 1544 0b58 1C92      		st X,__zero_reg__
 1545 0b5a 1B97      		sbiw r26,8+3
 1546 0b5c 1496      		adiw r26,4
 1547 0b5e 8D91      		ld r24,X+
 1548 0b60 9D91      		ld r25,X+
 1549 0b62 0D90      		ld __tmp_reg__,X+
 1550 0b64 BC91      		ld r27,X
 1551 0b66 A02D      		mov r26,__tmp_reg__
 1552 0b68 F401      		movw r30,r8
 1553 0b6a 808B      		std Z+16,r24
 1554 0b6c 918B      		std Z+17,r25
 1555 0b6e A28B      		std Z+18,r26
 1556 0b70 B38B      		std Z+19,r27
 1557 0b72 8981      		ldd r24,Y+1
 1558 0b74 9A81      		ldd r25,Y+2
 1559 0b76 AB81      		ldd r26,Y+3
 1560 0b78 BC81      		ldd r27,Y+4
 1561 0b7a 8483      		std Z+4,r24
 1562 0b7c 9583      		std Z+5,r25
 1563 0b7e A683      		std Z+6,r26
 1564 0b80 B783      		std Z+7,r27
 1565 0b82 00C0      		rjmp .L78
 1566               	.L79:
 1567 0b84 D401      		movw r26,r8
 1568 0b86 1896      		adiw r26,8
 1569 0b88 2D93      		st X+,r18
 1570 0b8a 3D93      		st X+,r19
 1571 0b8c 4D93      		st X+,r20
 1572 0b8e 5C93      		st X,r21
 1573 0b90 1B97      		sbiw r26,8+3
 1574               	.L78:
 1575 0b92 F401      		movw r30,r8
 1576 0b94 1486      		std Z+12,__zero_reg__
 1577 0b96 1586      		std Z+13,__zero_reg__
 1578 0b98 1686      		std Z+14,__zero_reg__
 1579 0b9a 1786      		std Z+15,__zero_reg__
 1580               	.L75:
 1581 0b9c D401      		movw r26,r8
 1582 0b9e 1496      		adiw r26,4
 1583 0ba0 4D91      		ld r20,X+
 1584 0ba2 5D91      		ld r21,X+
 1585 0ba4 6D91      		ld r22,X+
 1586 0ba6 7C91      		ld r23,X
 1587 0ba8 1797      		sbiw r26,4+3
 1588 0baa C201      		movw r24,r4
 1589 0bac 0E94 0000 		call PhatClusterSector
 1590 0bb0 DC01      		movw r26,r24
 1591 0bb2 CB01      		movw r24,r22
 1592 0bb4 F401      		movw r30,r8
 1593 0bb6 4085      		ldd r20,Z+8
 1594 0bb8 5185      		ldd r21,Z+9
 1595 0bba 6285      		ldd r22,Z+10
 1596 0bbc 7385      		ldd r23,Z+11
GAS LISTING C:\Temp/cc64q1PH.s 			page 29


 1597 0bbe 480F      		add r20,r24
 1598 0bc0 591F      		adc r21,r25
 1599 0bc2 6A1F      		adc r22,r26
 1600 0bc4 7B1F      		adc r23,r27
 1601 0bc6 D201      		movw r26,r4
 1602 0bc8 1296      		adiw r26,2
 1603 0bca 8D91      		ld r24,X+
 1604 0bcc 9C91      		ld r25,X
 1605 0bce 1397      		sbiw r26,2+1
 1606 0bd0 0E94 0000 		call PhatSectorLoad
 1607 0bd4 8C01      		movw r16,r24
 1608 0bd6 97FD      		sbrc r25,7
 1609 0bd8 00C0      		rjmp .L73
 1610 0bda F401      		movw r30,r8
 1611 0bdc 4485      		ldd r20,Z+12
 1612 0bde 5585      		ldd r21,Z+13
 1613 0be0 6685      		ldd r22,Z+14
 1614 0be2 7785      		ldd r23,Z+15
 1615 0be4 D301      		movw r26,r6
 1616 0be6 5696      		adiw r26,22
 1617 0be8 8D91      		ld r24,X+
 1618 0bea 9C91      		ld r25,X
 1619 0bec 5797      		sbiw r26,22+1
 1620 0bee 841B      		sub r24,r20
 1621 0bf0 950B      		sbc r25,r21
 1622 0bf2 EB84      		ldd r14,Y+11
 1623 0bf4 FC84      		ldd r15,Y+12
 1624 0bf6 EC18      		sub r14,r12
 1625 0bf8 FD08      		sbc r15,r13
 1626 0bfa 8E15      		cp r24,r14
 1627 0bfc 9F05      		cpc r25,r15
 1628 0bfe 04F4      		brge .L83
 1629 0c00 7C01      		movw r14,r24
 1630               	.L83:
 1631 0c02 F801      		movw r30,r16
 1632 0c04 33E0      		ldi r19,3
 1633 0c06 EE0F      	1:	lsl r30
 1634 0c08 FF1F      		rol r31
 1635 0c0a 3A95      		dec r19
 1636 0c0c 01F4      		brne 1b
 1637 0c0e E60D      		add r30,r6
 1638 0c10 F71D      		adc r31,r7
 1639 0c12 2285      		ldd r18,Z+10
 1640 0c14 3385      		ldd r19,Z+11
 1641 0c16 240F      		add r18,r20
 1642 0c18 351F      		adc r19,r21
 1643 0c1a C101      		movw r24,r2
 1644 0c1c 8C0D      		add r24,r12
 1645 0c1e 9D1D      		adc r25,r13
 1646 0c20 A701      		movw r20,r14
 1647 0c22 BC01      		movw r22,r24
 1648 0c24 C901      		movw r24,r18
 1649 0c26 0E94 0000 		call memcpy
 1650 0c2a 0E5F      		subi r16,lo8(-(2))
 1651 0c2c 1F4F      		sbci r17,hi8(-(2))
 1652 0c2e 23E0      		ldi r18,3
 1653 0c30 000F      	1:	lsl r16
GAS LISTING C:\Temp/cc64q1PH.s 			page 30


 1654 0c32 111F      		rol r17
 1655 0c34 2A95      		dec r18
 1656 0c36 01F4      		brne 1b
 1657 0c38 060D      		add r16,r6
 1658 0c3a 171D      		adc r17,r7
 1659 0c3c 41E0      		ldi r20,lo8(1)
 1660 0c3e 50E0      		ldi r21,hi8(1)
 1661 0c40 F801      		movw r30,r16
 1662 0c42 5183      		std Z+1,r21
 1663 0c44 4083      		st Z,r20
 1664 0c46 9701      		movw r18,r14
 1665 0c48 4427      		clr r20
 1666 0c4a 37FD      		sbrc r19,7
 1667 0c4c 4095      		com r20
 1668 0c4e 542F      		mov r21,r20
 1669 0c50 F401      		movw r30,r8
 1670 0c52 8081      		ld r24,Z
 1671 0c54 9181      		ldd r25,Z+1
 1672 0c56 A281      		ldd r26,Z+2
 1673 0c58 B381      		ldd r27,Z+3
 1674 0c5a 820F      		add r24,r18
 1675 0c5c 931F      		adc r25,r19
 1676 0c5e A41F      		adc r26,r20
 1677 0c60 B51F      		adc r27,r21
 1678 0c62 8083      		st Z,r24
 1679 0c64 9183      		std Z+1,r25
 1680 0c66 A283      		std Z+2,r26
 1681 0c68 B383      		std Z+3,r27
 1682 0c6a 8485      		ldd r24,Z+12
 1683 0c6c 9585      		ldd r25,Z+13
 1684 0c6e A685      		ldd r26,Z+14
 1685 0c70 B785      		ldd r27,Z+15
 1686 0c72 820F      		add r24,r18
 1687 0c74 931F      		adc r25,r19
 1688 0c76 A41F      		adc r26,r20
 1689 0c78 B51F      		adc r27,r21
 1690 0c7a 8487      		std Z+12,r24
 1691 0c7c 9587      		std Z+13,r25
 1692 0c7e A687      		std Z+14,r26
 1693 0c80 B787      		std Z+15,r27
 1694 0c82 CE0C      		add r12,r14
 1695 0c84 DF1C      		adc r13,r15
 1696               	.L74:
 1697 0c86 4B85      		ldd r20,Y+11
 1698 0c88 5C85      		ldd r21,Y+12
 1699 0c8a C416      		cp r12,r20
 1700 0c8c D506      		cpc r13,r21
 1701 0c8e 04F4      		brge .+2
 1702 0c90 00C0      		rjmp .L85
 1703               	.L77:
 1704 0c92 8601      		movw r16,r12
 1705 0c94 1C14      		cp __zero_reg__,r12
 1706 0c96 1D04      		cpc __zero_reg__,r13
 1707 0c98 04F4      		brge .L68
 1708 0c9a D401      		movw r26,r8
 1709 0c9c 9396      		adiw r26,35
 1710 0c9e 8C91      		ld r24,X
GAS LISTING C:\Temp/cc64q1PH.s 			page 31


 1711 0ca0 84FD      		sbrc r24,4
 1712 0ca2 00C0      		rjmp .L68
 1713 0ca4 B401      		movw r22,r8
 1714 0ca6 605D      		subi r22,lo8(-(48))
 1715 0ca8 7F4F      		sbci r23,hi8(-(48))
 1716 0caa C401      		movw r24,r8
 1717 0cac 8E96      		adiw r24,46
 1718 0cae 0E94 0000 		call GetDosTimeStamp
 1719 0cb2 F401      		movw r30,r8
 1720 0cb4 80A9      		ldd r24,Z+48
 1721 0cb6 91A9      		ldd r25,Z+49
 1722 0cb8 93A7      		std Z+43,r25
 1723 0cba 82A7      		std Z+42,r24
 1724 0cbc 83A1      		ldd r24,Z+35
 1725 0cbe 8062      		ori r24,lo8(32)
 1726 0cc0 83A3      		std Z+35,r24
 1727 0cc2 2081      		ld r18,Z
 1728 0cc4 3181      		ldd r19,Z+1
 1729 0cc6 4281      		ldd r20,Z+2
 1730 0cc8 5381      		ldd r21,Z+3
 1731 0cca 84A9      		ldd r24,Z+52
 1732 0ccc 95A9      		ldd r25,Z+53
 1733 0cce A6A9      		ldd r26,Z+54
 1734 0cd0 B7A9      		ldd r27,Z+55
 1735 0cd2 8217      		cp r24,r18
 1736 0cd4 9307      		cpc r25,r19
 1737 0cd6 A407      		cpc r26,r20
 1738 0cd8 B507      		cpc r27,r21
 1739 0cda 00F4      		brsh .L86
 1740 0cdc D401      		movw r26,r8
 1741 0cde D496      		adiw r26,52
 1742 0ce0 2D93      		st X+,r18
 1743 0ce2 3D93      		st X+,r19
 1744 0ce4 4D93      		st X+,r20
 1745 0ce6 5C93      		st X,r21
 1746 0ce8 D797      		sbiw r26,52+3
 1747               	.L86:
 1748 0cea E0E4      		ldi r30,lo8(64)
 1749 0cec F0E0      		ldi r31,hi8(64)
 1750 0cee 8E0E      		add r8,r30
 1751 0cf0 9F1E      		adc r9,r31
 1752 0cf2 81E0      		ldi r24,lo8(1)
 1753 0cf4 90E0      		ldi r25,hi8(1)
 1754 0cf6 D401      		movw r26,r8
 1755 0cf8 8D93      		st X+,r24
 1756 0cfa 9C93      		st X,r25
 1757 0cfc 00C0      		rjmp .L68
 1758               	.L73:
 1759 0cfe 0FEF      		ldi r16,lo8(-1)
 1760 0d00 1FEF      		ldi r17,hi8(-1)
 1761               	.L68:
 1762 0d02 C801      		movw r24,r16
 1763               	/* epilogue start */
 1764 0d04 2C96      		adiw r28,12
 1765 0d06 0FB6      		in __tmp_reg__,__SREG__
 1766 0d08 F894      		cli
 1767 0d0a DEBF      		out __SP_H__,r29
GAS LISTING C:\Temp/cc64q1PH.s 			page 32


 1768 0d0c 0FBE      		out __SREG__,__tmp_reg__
 1769 0d0e CDBF      		out __SP_L__,r28
 1770 0d10 CF91      		pop r28
 1771 0d12 DF91      		pop r29
 1772 0d14 1F91      		pop r17
 1773 0d16 0F91      		pop r16
 1774 0d18 FF90      		pop r15
 1775 0d1a EF90      		pop r14
 1776 0d1c DF90      		pop r13
 1777 0d1e CF90      		pop r12
 1778 0d20 BF90      		pop r11
 1779 0d22 AF90      		pop r10
 1780 0d24 9F90      		pop r9
 1781 0d26 8F90      		pop r8
 1782 0d28 7F90      		pop r7
 1783 0d2a 6F90      		pop r6
 1784 0d2c 5F90      		pop r5
 1785 0d2e 4F90      		pop r4
 1786 0d30 3F90      		pop r3
 1787 0d32 2F90      		pop r2
 1788 0d34 0895      		ret
 1789               		.size	PhatFileWrite, .-PhatFileWrite
 1790               		.type	PhatApiFileWrite, @function
 1791               	PhatApiFileWrite:
 1792 0d36 AF92      		push r10
 1793 0d38 BF92      		push r11
 1794 0d3a CF92      		push r12
 1795 0d3c DF92      		push r13
 1796 0d3e EF92      		push r14
 1797 0d40 FF92      		push r15
 1798 0d42 0F93      		push r16
 1799 0d44 1F93      		push r17
 1800               	/* prologue: function */
 1801               	/* frame size = 0 */
 1802 0d46 6C01      		movw r12,r24
 1803 0d48 5B01      		movw r10,r22
 1804 0d4a 7A01      		movw r14,r20
 1805 0d4c DC01      		movw r26,r24
 1806 0d4e 1296      		adiw r26,2
 1807 0d50 ED91      		ld r30,X+
 1808 0d52 FC91      		ld r31,X
 1809 0d54 1397      		sbiw r26,2+1
 1810 0d56 0189      		ldd r16,Z+17
 1811 0d58 1289      		ldd r17,Z+18
 1812 0d5a 0E5E      		subi r16,lo8(-(18))
 1813 0d5c 1F4F      		sbci r17,hi8(-(18))
 1814 0d5e 40E0      		ldi r20,lo8(0)
 1815 0d60 50E0      		ldi r21,hi8(0)
 1816 0d62 60E0      		ldi r22,hlo8(0)
 1817 0d64 70E0      		ldi r23,hhi8(0)
 1818 0d66 C801      		movw r24,r16
 1819 0d68 0E94 0000 		call NutEventWait
 1820 0d6c A701      		movw r20,r14
 1821 0d6e B501      		movw r22,r10
 1822 0d70 C601      		movw r24,r12
 1823 0d72 0E94 0000 		call PhatFileWrite
 1824 0d76 F82E      		mov r15,r24
GAS LISTING C:\Temp/cc64q1PH.s 			page 33


 1825 0d78 E92E      		mov r14,r25
 1826 0d7a C801      		movw r24,r16
 1827 0d7c 0E94 0000 		call NutEventPost
 1828 0d80 8F2D      		mov r24,r15
 1829 0d82 9E2D      		mov r25,r14
 1830               	/* epilogue start */
 1831 0d84 1F91      		pop r17
 1832 0d86 0F91      		pop r16
 1833 0d88 FF90      		pop r15
 1834 0d8a EF90      		pop r14
 1835 0d8c DF90      		pop r13
 1836 0d8e CF90      		pop r12
 1837 0d90 BF90      		pop r11
 1838 0d92 AF90      		pop r10
 1839 0d94 0895      		ret
 1840               		.size	PhatApiFileWrite, .-PhatApiFileWrite
 1841               	.global	PhatFileClose
 1842               		.type	PhatFileClose, @function
 1843               	PhatFileClose:
 1844 0d96 0F93      		push r16
 1845 0d98 1F93      		push r17
 1846 0d9a CF93      		push r28
 1847 0d9c DF93      		push r29
 1848               	/* prologue: function */
 1849               	/* frame size = 0 */
 1850 0d9e EC01      		movw r28,r24
 1851 0da0 0197      		sbiw r24,1
 1852 0da2 8E5F      		subi r24,lo8(-2)
 1853 0da4 9F4F      		sbci r25,hi8(-2)
 1854 0da6 00F0      		brlo .L94
 1855 0da8 89E0      		ldi r24,lo8(9)
 1856 0daa 90E0      		ldi r25,hi8(9)
 1857 0dac 9093 0000 		sts (errno)+1,r25
 1858 0db0 8093 0000 		sts errno,r24
 1859 0db4 0FEF      		ldi r16,lo8(-1)
 1860 0db6 1FEF      		ldi r17,hi8(-1)
 1861 0db8 00C0      		rjmp .L95
 1862               	.L94:
 1863 0dba CE01      		movw r24,r28
 1864 0dbc 0E94 0000 		call PhatFileFlush
 1865 0dc0 8C01      		movw r16,r24
 1866 0dc2 8C81      		ldd r24,Y+4
 1867 0dc4 9D81      		ldd r25,Y+5
 1868 0dc6 0097      		sbiw r24,0
 1869 0dc8 01F0      		breq .L96
 1870 0dca 0E94 0000 		call free
 1871               	.L96:
 1872 0dce CE01      		movw r24,r28
 1873 0dd0 0E94 0000 		call free
 1874               	.L95:
 1875 0dd4 C801      		movw r24,r16
 1876               	/* epilogue start */
 1877 0dd6 DF91      		pop r29
 1878 0dd8 CF91      		pop r28
 1879 0dda 1F91      		pop r17
 1880 0ddc 0F91      		pop r16
 1881 0dde 0895      		ret
GAS LISTING C:\Temp/cc64q1PH.s 			page 34


 1882               		.size	PhatFileClose, .-PhatFileClose
 1883               		.type	PhatApiFileClose, @function
 1884               	PhatApiFileClose:
 1885 0de0 EF92      		push r14
 1886 0de2 FF92      		push r15
 1887 0de4 0F93      		push r16
 1888 0de6 1F93      		push r17
 1889               	/* prologue: function */
 1890               	/* frame size = 0 */
 1891 0de8 7C01      		movw r14,r24
 1892 0dea DC01      		movw r26,r24
 1893 0dec 1296      		adiw r26,2
 1894 0dee ED91      		ld r30,X+
 1895 0df0 FC91      		ld r31,X
 1896 0df2 1397      		sbiw r26,2+1
 1897 0df4 0189      		ldd r16,Z+17
 1898 0df6 1289      		ldd r17,Z+18
 1899 0df8 0E5E      		subi r16,lo8(-(18))
 1900 0dfa 1F4F      		sbci r17,hi8(-(18))
 1901 0dfc 40E0      		ldi r20,lo8(0)
 1902 0dfe 50E0      		ldi r21,hi8(0)
 1903 0e00 60E0      		ldi r22,hlo8(0)
 1904 0e02 70E0      		ldi r23,hhi8(0)
 1905 0e04 C801      		movw r24,r16
 1906 0e06 0E94 0000 		call NutEventWait
 1907 0e0a C701      		movw r24,r14
 1908 0e0c 0E94 0000 		call PhatFileClose
 1909 0e10 F82E      		mov r15,r24
 1910 0e12 E92E      		mov r14,r25
 1911 0e14 C801      		movw r24,r16
 1912 0e16 0E94 0000 		call NutEventPost
 1913 0e1a 8F2D      		mov r24,r15
 1914 0e1c 9E2D      		mov r25,r14
 1915               	/* epilogue start */
 1916 0e1e 1F91      		pop r17
 1917 0e20 0F91      		pop r16
 1918 0e22 FF90      		pop r15
 1919 0e24 EF90      		pop r14
 1920 0e26 0895      		ret
 1921               		.size	PhatApiFileClose, .-PhatApiFileClose
 1922               		.type	PhatApiIOCtl, @function
 1923               	PhatApiIOCtl:
 1924 0e28 AF92      		push r10
 1925 0e2a BF92      		push r11
 1926 0e2c CF92      		push r12
 1927 0e2e DF92      		push r13
 1928 0e30 EF92      		push r14
 1929 0e32 FF92      		push r15
 1930 0e34 0F93      		push r16
 1931 0e36 1F93      		push r17
 1932 0e38 CF93      		push r28
 1933 0e3a DF93      		push r29
 1934               	/* prologue: function */
 1935               	/* frame size = 0 */
 1936 0e3c 7C01      		movw r14,r24
 1937 0e3e 8B01      		movw r16,r22
 1938 0e40 EA01      		movw r28,r20
GAS LISTING C:\Temp/cc64q1PH.s 			page 35


 1939 0e42 DC01      		movw r26,r24
 1940 0e44 5196      		adiw r26,17
 1941 0e46 AD90      		ld r10,X+
 1942 0e48 BC90      		ld r11,X
 1943 0e4a 5297      		sbiw r26,17+1
 1944 0e4c B1E1      		ldi r27,hi8(4400)
 1945 0e4e 6033      		cpi r22,lo8(4400)
 1946 0e50 7B07      		cpc r23,r27
 1947 0e52 01F4      		brne .+2
 1948 0e54 00C0      		rjmp .L101
 1949 0e56 A114      		cp r10,__zero_reg__
 1950 0e58 B104      		cpc r11,__zero_reg__
 1951 0e5a 01F0      		breq .L102
 1952 0e5c 40E0      		ldi r20,lo8(0)
 1953 0e5e 50E0      		ldi r21,hi8(0)
 1954 0e60 60E0      		ldi r22,hlo8(0)
 1955 0e62 70E0      		ldi r23,hhi8(0)
 1956 0e64 C501      		movw r24,r10
 1957 0e66 4296      		adiw r24,18
 1958 0e68 0E94 0000 		call NutEventWait
 1959               	.L102:
 1960 0e6c E1E1      		ldi r30,hi8(4373)
 1961 0e6e 0531      		cpi r16,lo8(4373)
 1962 0e70 1E07      		cpc r17,r30
 1963 0e72 01F4      		brne .+2
 1964 0e74 00C0      		rjmp .L109
 1965 0e76 F1E1      		ldi r31,hi8(4374)
 1966 0e78 0631      		cpi r16,lo8(4374)
 1967 0e7a 1F07      		cpc r17,r31
 1968 0e7c 04F4      		brge .L114
 1969 0e7e 21E1      		ldi r18,hi8(4370)
 1970 0e80 0231      		cpi r16,lo8(4370)
 1971 0e82 1207      		cpc r17,r18
 1972 0e84 01F4      		brne .+2
 1973 0e86 00C0      		rjmp .L106
 1974 0e88 81E1      		ldi r24,hi8(4371)
 1975 0e8a 0331      		cpi r16,lo8(4371)
 1976 0e8c 1807      		cpc r17,r24
 1977 0e8e 04F4      		brge .L115
 1978 0e90 A1E1      		ldi r26,hi8(4353)
 1979 0e92 0130      		cpi r16,lo8(4353)
 1980 0e94 1A07      		cpc r17,r26
 1981 0e96 01F0      		breq .L104
 1982 0e98 B1E1      		ldi r27,hi8(4369)
 1983 0e9a 0131      		cpi r16,lo8(4369)
 1984 0e9c 1B07      		cpc r17,r27
 1985 0e9e 01F0      		breq .+2
 1986 0ea0 00C0      		rjmp .L103
 1987 0ea2 00C0      		rjmp .L125
 1988               	.L115:
 1989 0ea4 E1E1      		ldi r30,hi8(4371)
 1990 0ea6 0331      		cpi r16,lo8(4371)
 1991 0ea8 1E07      		cpc r17,r30
 1992 0eaa 01F0      		breq .L107
 1993 0eac F1E1      		ldi r31,hi8(4372)
 1994 0eae 0431      		cpi r16,lo8(4372)
 1995 0eb0 1F07      		cpc r17,r31
GAS LISTING C:\Temp/cc64q1PH.s 			page 36


 1996 0eb2 01F0      		breq .+2
 1997 0eb4 00C0      		rjmp .L103
 1998 0eb6 00C0      		rjmp .L126
 1999               	.L114:
 2000 0eb8 21E1      		ldi r18,hi8(4400)
 2001 0eba 0033      		cpi r16,lo8(4400)
 2002 0ebc 1207      		cpc r17,r18
 2003 0ebe 01F4      		brne .+2
 2004 0ec0 00C0      		rjmp .L101
 2005 0ec2 81E1      		ldi r24,hi8(4401)
 2006 0ec4 0133      		cpi r16,lo8(4401)
 2007 0ec6 1807      		cpc r17,r24
 2008 0ec8 04F4      		brge .L116
 2009 0eca A1E1      		ldi r26,hi8(4386)
 2010 0ecc 0232      		cpi r16,lo8(4386)
 2011 0ece 1A07      		cpc r17,r26
 2012 0ed0 01F0      		breq .L110
 2013 0ed2 B1E1      		ldi r27,hi8(4387)
 2014 0ed4 0332      		cpi r16,lo8(4387)
 2015 0ed6 1B07      		cpc r17,r27
 2016 0ed8 01F0      		breq .+2
 2017 0eda 00C0      		rjmp .L103
 2018 0edc 00C0      		rjmp .L127
 2019               	.L116:
 2020 0ede E1E1      		ldi r30,hi8(4401)
 2021 0ee0 0133      		cpi r16,lo8(4401)
 2022 0ee2 1E07      		cpc r17,r30
 2023 0ee4 01F4      		brne .+2
 2024 0ee6 00C0      		rjmp .L112
 2025 0ee8 F1E1      		ldi r31,hi8(4402)
 2026 0eea 0233      		cpi r16,lo8(4402)
 2027 0eec 1F07      		cpc r17,r31
 2028 0eee 01F0      		breq .+2
 2029 0ef0 00C0      		rjmp .L103
 2030 0ef2 00C0      		rjmp .L128
 2031               	.L104:
 2032 0ef4 4A81      		ldd r20,Y+2
 2033 0ef6 5B81      		ldd r21,Y+3
 2034 0ef8 6881      		ld r22,Y
 2035 0efa 7981      		ldd r23,Y+1
 2036 0efc C701      		movw r24,r14
 2037 0efe 0E94 0000 		call PhatDirEntryStatus
 2038 0f02 00C0      		rjmp .L124
 2039               	.L125:
 2040 0f04 BE01      		movw r22,r28
 2041 0f06 C701      		movw r24,r14
 2042 0f08 0E94 0000 		call PhatDirCreate
 2043 0f0c 00C0      		rjmp .L124
 2044               	.L106:
 2045 0f0e BE01      		movw r22,r28
 2046 0f10 C701      		movw r24,r14
 2047 0f12 0E94 0000 		call PhatDirRemove
 2048 0f16 00C0      		rjmp .L124
 2049               	.L107:
 2050 0f18 6A81      		ldd r22,Y+2
 2051 0f1a 7B81      		ldd r23,Y+3
 2052 0f1c C701      		movw r24,r14
GAS LISTING C:\Temp/cc64q1PH.s 			page 37


 2053 0f1e 0E94 0000 		call PhatDirOpen
 2054 0f22 9983      		std Y+1,r25
 2055 0f24 8883      		st Y,r24
 2056 0f26 8F5F      		subi r24,lo8(-1)
 2057 0f28 9F4F      		sbci r25,hi8(-1)
 2058 0f2a 01F4      		brne .+2
 2059 0f2c 00C0      		rjmp .L103
 2060 0f2e C0E0      		ldi r28,lo8(0)
 2061 0f30 D0E0      		ldi r29,hi8(0)
 2062 0f32 00C0      		rjmp .L117
 2063               	.L126:
 2064 0f34 8881      		ld r24,Y
 2065 0f36 9981      		ldd r25,Y+1
 2066 0f38 0E94 0000 		call PhatFileClose
 2067 0f3c 00C0      		rjmp .L124
 2068               	.L109:
 2069 0f3e CE01      		movw r24,r28
 2070 0f40 0E94 0000 		call PhatDirRead
 2071 0f44 00C0      		rjmp .L124
 2072               	.L110:
 2073 0f46 27E2      		ldi r18,lo8(39)
 2074 0f48 30E0      		ldi r19,hi8(39)
 2075 0f4a 40E0      		ldi r20,hlo8(39)
 2076 0f4c 50E0      		ldi r21,hhi8(39)
 2077 0f4e BE01      		movw r22,r28
 2078 0f50 C701      		movw r24,r14
 2079 0f52 0E94 0000 		call PhatDirDelEntry
 2080 0f56 00C0      		rjmp .L124
 2081               	.L127:
 2082 0f58 CA80      		ldd r12,Y+2
 2083 0f5a DB80      		ldd r13,Y+3
 2084 0f5c E881      		ld r30,Y
 2085 0f5e F981      		ldd r31,Y+1
 2086 0f60 D601      		movw r26,r12
 2087 0f62 4D91      		ld r20,X+
 2088 0f64 5D91      		ld r21,X+
 2089 0f66 6D91      		ld r22,X+
 2090 0f68 7C91      		ld r23,X
 2091 0f6a E480      		ldd r14,Z+4
 2092 0f6c F580      		ldd r15,Z+5
 2093 0f6e 8C81      		ldd r24,Y+4
 2094 0f70 9D81      		ldd r25,Y+5
 2095 0f72 8130      		cpi r24,1
 2096 0f74 9105      		cpc r25,__zero_reg__
 2097 0f76 01F0      		breq .L119
 2098 0f78 0297      		sbiw r24,2
 2099 0f7a 01F4      		brne .L118
 2100 0f7c 00C0      		rjmp .L129
 2101               	.L119:
 2102 0f7e E701      		movw r28,r14
 2103 0f80 8881      		ld r24,Y
 2104 0f82 9981      		ldd r25,Y+1
 2105 0f84 AA81      		ldd r26,Y+2
 2106 0f86 BB81      		ldd r27,Y+3
 2107 0f88 00C0      		rjmp .L123
 2108               	.L129:
 2109 0f8a E701      		movw r28,r14
GAS LISTING C:\Temp/cc64q1PH.s 			page 38


 2110 0f8c 8CA9      		ldd r24,Y+52
 2111 0f8e 9DA9      		ldd r25,Y+53
 2112 0f90 AEA9      		ldd r26,Y+54
 2113 0f92 BFA9      		ldd r27,Y+55
 2114               	.L123:
 2115 0f94 480F      		add r20,r24
 2116 0f96 591F      		adc r21,r25
 2117 0f98 6A1F      		adc r22,r26
 2118 0f9a 7B1F      		adc r23,r27
 2119               	.L118:
 2120 0f9c 77FD      		sbrc r23,7
 2121 0f9e 00C0      		rjmp .L103
 2122 0fa0 E701      		movw r28,r14
 2123 0fa2 8CA9      		ldd r24,Y+52
 2124 0fa4 9DA9      		ldd r25,Y+53
 2125 0fa6 AEA9      		ldd r26,Y+54
 2126 0fa8 BFA9      		ldd r27,Y+55
 2127 0faa 8417      		cp r24,r20
 2128 0fac 9507      		cpc r25,r21
 2129 0fae A607      		cpc r26,r22
 2130 0fb0 B707      		cpc r27,r23
 2131 0fb2 04F0      		brlt .L103
 2132 0fb4 CF01      		movw r24,r30
 2133 0fb6 0E94 0000 		call PhatFilePosSet
 2134 0fba 8881      		ld r24,Y
 2135 0fbc 9981      		ldd r25,Y+1
 2136 0fbe AA81      		ldd r26,Y+2
 2137 0fc0 BB81      		ldd r27,Y+3
 2138 0fc2 F601      		movw r30,r12
 2139 0fc4 8083      		st Z,r24
 2140 0fc6 9183      		std Z+1,r25
 2141 0fc8 A283      		std Z+2,r26
 2142 0fca B383      		std Z+3,r27
 2143 0fcc 00C0      		rjmp .L103
 2144               	.L128:
 2145 0fce 4A81      		ldd r20,Y+2
 2146 0fd0 5B81      		ldd r21,Y+3
 2147 0fd2 6881      		ld r22,Y
 2148 0fd4 7981      		ldd r23,Y+1
 2149 0fd6 C701      		movw r24,r14
 2150 0fd8 0E94 0000 		call PhatDirRenameEntry
 2151               	.L124:
 2152 0fdc EC01      		movw r28,r24
 2153 0fde 00C0      		rjmp .L117
 2154               	.L101:
 2155 0fe0 6881      		ld r22,Y
 2156 0fe2 7981      		ldd r23,Y+1
 2157 0fe4 4A81      		ldd r20,Y+2
 2158 0fe6 C701      		movw r24,r14
 2159 0fe8 0E94 0000 		call PhatVolMount
 2160 0fec EC01      		movw r28,r24
 2161 0fee 0097      		sbiw r24,0
 2162 0ff0 01F0      		breq .L117
 2163 0ff2 C701      		movw r24,r14
 2164 0ff4 0E94 0000 		call PhatVolUnmount
 2165 0ff8 00C0      		rjmp .L117
 2166               	.L112:
GAS LISTING C:\Temp/cc64q1PH.s 			page 39


 2167 0ffa C701      		movw r24,r14
 2168 0ffc 0E94 0000 		call PhatVolUnmount
 2169 1000 00C0      		rjmp .L124
 2170               	.L103:
 2171 1002 CFEF      		ldi r28,lo8(-1)
 2172 1004 DFEF      		ldi r29,hi8(-1)
 2173               	.L117:
 2174 1006 0053      		subi r16,lo8(-(-4400))
 2175 1008 1141      		sbci r17,hi8(-(-4400))
 2176 100a 0230      		cpi r16,2
 2177 100c 1105      		cpc r17,__zero_reg__
 2178 100e 00F0      		brlo .L121
 2179 1010 A114      		cp r10,__zero_reg__
 2180 1012 B104      		cpc r11,__zero_reg__
 2181 1014 01F0      		breq .L121
 2182 1016 C501      		movw r24,r10
 2183 1018 4296      		adiw r24,18
 2184 101a 0E94 0000 		call NutEventPost
 2185               	.L121:
 2186 101e CE01      		movw r24,r28
 2187               	/* epilogue start */
 2188 1020 DF91      		pop r29
 2189 1022 CF91      		pop r28
 2190 1024 1F91      		pop r17
 2191 1026 0F91      		pop r16
 2192 1028 FF90      		pop r15
 2193 102a EF90      		pop r14
 2194 102c DF90      		pop r13
 2195 102e CF90      		pop r12
 2196 1030 BF90      		pop r11
 2197 1032 AF90      		pop r10
 2198 1034 0895      		ret
 2199               		.size	PhatApiIOCtl, .-PhatApiIOCtl
 2200               	.global	PhatFileOpen
 2201               		.type	PhatFileOpen, @function
 2202               	PhatFileOpen:
 2203 1036 2F92      		push r2
 2204 1038 3F92      		push r3
 2205 103a 4F92      		push r4
 2206 103c 5F92      		push r5
 2207 103e 6F92      		push r6
 2208 1040 7F92      		push r7
 2209 1042 8F92      		push r8
 2210 1044 9F92      		push r9
 2211 1046 AF92      		push r10
 2212 1048 BF92      		push r11
 2213 104a CF92      		push r12
 2214 104c DF92      		push r13
 2215 104e EF92      		push r14
 2216 1050 FF92      		push r15
 2217 1052 0F93      		push r16
 2218 1054 1F93      		push r17
 2219 1056 DF93      		push r29
 2220 1058 CF93      		push r28
 2221 105a 00D0      		rcall .
 2222 105c 00D0      		rcall .
 2223 105e CDB7      		in r28,__SP_L__
GAS LISTING C:\Temp/cc64q1PH.s 			page 40


 2224 1060 DEB7      		in r29,__SP_H__
 2225               	/* prologue: function */
 2226               	/* frame size = 4 */
 2227 1062 3C01      		movw r6,r24
 2228 1064 1A01      		movw r2,r20
 2229 1066 3C83      		std Y+4,r19
 2230 1068 2B83      		std Y+3,r18
 2231 106a AE01      		movw r20,r28
 2232 106c 4F5F      		subi r20,lo8(-(1))
 2233 106e 5F4F      		sbci r21,hi8(-(1))
 2234 1070 0E94 0000 		call PhatDirOpenParent
 2235 1074 5C01      		movw r10,r24
 2236 1076 2FEF      		ldi r18,hi8(-1)
 2237 1078 8F3F      		cpi r24,lo8(-1)
 2238 107a 9207      		cpc r25,r18
 2239 107c 01F4      		brne .+2
 2240 107e 00C0      		rjmp .L131
 2241 1080 FC01      		movw r30,r24
 2242 1082 4480      		ldd r4,Z+4
 2243 1084 5580      		ldd r5,Z+5
 2244 1086 E981      		ldd r30,Y+1
 2245 1088 FA81      		ldd r31,Y+2
 2246 108a 8081      		ld r24,Z
 2247 108c 8823      		tst r24
 2248 108e 01F4      		brne .L132
 2249 1090 C101      		movw r24,r2
 2250 1092 AA27      		clr r26
 2251 1094 97FD      		sbrc r25,7
 2252 1096 A095      		com r26
 2253 1098 BA2F      		mov r27,r26
 2254 109a F201      		movw r30,r4
 2255 109c 848B      		std Z+20,r24
 2256 109e 958B      		std Z+21,r25
 2257 10a0 A68B      		std Z+22,r26
 2258 10a2 B78B      		std Z+23,r27
 2259 10a4 00C0      		rjmp .L131
 2260               	.L132:
 2261 10a6 86E0      		ldi r24,lo8(6)
 2262 10a8 90E0      		ldi r25,hi8(6)
 2263 10aa 0E94 0000 		call malloc
 2264 10ae 4C01      		movw r8,r24
 2265 10b0 86E4      		ldi r24,lo8(70)
 2266 10b2 90E0      		ldi r25,hi8(70)
 2267 10b4 0E94 0000 		call malloc
 2268 10b8 7C01      		movw r14,r24
 2269 10ba 85E2      		ldi r24,lo8(293)
 2270 10bc 91E0      		ldi r25,hi8(293)
 2271 10be 0E94 0000 		call malloc
 2272 10c2 6C01      		movw r12,r24
 2273 10c4 8114      		cp r8,__zero_reg__
 2274 10c6 9104      		cpc r9,__zero_reg__
 2275 10c8 01F0      		breq .L133
 2276 10ca E114      		cp r14,__zero_reg__
 2277 10cc F104      		cpc r15,__zero_reg__
 2278 10ce 01F0      		breq .L133
 2279 10d0 0097      		sbiw r24,0
 2280 10d2 01F4      		brne .L134
GAS LISTING C:\Temp/cc64q1PH.s 			page 41


 2281               	.L133:
 2282 10d4 C501      		movw r24,r10
 2283 10d6 0E94 0000 		call PhatFileClose
 2284 10da 8114      		cp r8,__zero_reg__
 2285 10dc 9104      		cpc r9,__zero_reg__
 2286 10de 01F0      		breq .L135
 2287 10e0 C401      		movw r24,r8
 2288 10e2 0E94 0000 		call free
 2289               	.L135:
 2290 10e6 E114      		cp r14,__zero_reg__
 2291 10e8 F104      		cpc r15,__zero_reg__
 2292 10ea 01F0      		breq .L136
 2293 10ec C701      		movw r24,r14
 2294 10ee 0E94 0000 		call free
 2295               	.L136:
 2296 10f2 C114      		cp r12,__zero_reg__
 2297 10f4 D104      		cpc r13,__zero_reg__
 2298 10f6 01F0      		breq .+2
 2299 10f8 00C0      		rjmp .L154
 2300 10fa 00C0      		rjmp .L152
 2301               	.L134:
 2302 10fc F701      		movw r30,r14
 2303 10fe 26E4      		ldi r18,lo8(70)
 2304 1100 1192      		st Z+,__zero_reg__
 2305 1102 2A95      	        dec r18
 2306 1104 01F4      		brne .-6
 2307 1106 F401      		movw r30,r8
 2308 1108 1182      		std Z+1,__zero_reg__
 2309 110a 1082      		st Z,__zero_reg__
 2310 110c 7382      		std Z+3,r7
 2311 110e 6282      		std Z+2,r6
 2312 1110 F582      		std Z+5,r15
 2313 1112 E482      		std Z+4,r14
 2314 1114 6981      		ldd r22,Y+1
 2315 1116 7A81      		ldd r23,Y+2
 2316 1118 8C01      		movw r16,r24
 2317 111a 27E3      		ldi r18,lo8(55)
 2318 111c 30E0      		ldi r19,hi8(55)
 2319 111e 40E0      		ldi r20,hlo8(55)
 2320 1120 50E0      		ldi r21,hhi8(55)
 2321 1122 C501      		movw r24,r10
 2322 1124 0E94 0000 		call PhatDirEntryFind
 2323 1128 892B      		or r24,r25
 2324 112a 01F0      		breq .L138
 2325 112c 30FC      		sbrc r3,0
 2326 112e 00C0      		rjmp .L139
 2327 1130 C601      		movw r24,r12
 2328 1132 0E94 0000 		call free
 2329 1136 C501      		movw r24,r10
 2330 1138 0E94 0000 		call PhatFileClose
 2331 113c C401      		movw r24,r8
 2332 113e 0E94 0000 		call PhatFileClose
 2333 1142 82E0      		ldi r24,lo8(2)
 2334 1144 90E0      		ldi r25,hi8(2)
 2335 1146 00C0      		rjmp .L153
 2336               	.L139:
 2337 1148 9701      		movw r18,r14
GAS LISTING C:\Temp/cc64q1PH.s 			page 42


 2338 114a 285E      		subi r18,lo8(-(24))
 2339 114c 3F4F      		sbci r19,hi8(-(24))
 2340 114e 6981      		ldd r22,Y+1
 2341 1150 7A81      		ldd r23,Y+2
 2342 1152 4B81      		ldd r20,Y+3
 2343 1154 5C81      		ldd r21,Y+4
 2344 1156 C501      		movw r24,r10
 2345 1158 0E94 0000 		call PhatDirEntryCreate
 2346 115c 892B      		or r24,r25
 2347 115e 01F4      		brne .+2
 2348 1160 00C0      		rjmp .L151
 2349 1162 C601      		movw r24,r12
 2350 1164 0E94 0000 		call free
 2351 1168 C501      		movw r24,r10
 2352 116a 0E94 0000 		call PhatFileClose
 2353 116e 00C0      		rjmp .L155
 2354               	.L138:
 2355 1170 C101      		movw r24,r2
 2356 1172 8070      		andi r24,lo8(1280)
 2357 1174 9570      		andi r25,hi8(1280)
 2358 1176 8050      		subi r24,lo8(1280)
 2359 1178 9540      		sbci r25,hi8(1280)
 2360 117a 01F4      		brne .L142
 2361 117c C601      		movw r24,r12
 2362 117e 0E94 0000 		call free
 2363 1182 C501      		movw r24,r10
 2364 1184 0E94 0000 		call PhatFileClose
 2365 1188 C401      		movw r24,r8
 2366 118a 0E94 0000 		call PhatFileClose
 2367 118e 81E1      		ldi r24,lo8(17)
 2368 1190 90E0      		ldi r25,hi8(17)
 2369               	.L153:
 2370 1192 9093 0000 		sts (errno)+1,r25
 2371 1196 8093 0000 		sts errno,r24
 2372 119a 00C0      		rjmp .L152
 2373               	.L142:
 2374 119c 31FE      		sbrs r3,1
 2375 119e 00C0      		rjmp .L143
 2376 11a0 B601      		movw r22,r12
 2377 11a2 C301      		movw r24,r6
 2378 11a4 0E94 0000 		call PhatDirReleaseChain
 2379 11a8 892B      		or r24,r25
 2380 11aa 01F0      		breq .L144
 2381 11ac C501      		movw r24,r10
 2382 11ae 0E94 0000 		call PhatFileClose
 2383 11b2 C401      		movw r24,r8
 2384 11b4 0E94 0000 		call PhatFileClose
 2385               	.L154:
 2386 11b8 C601      		movw r24,r12
 2387 11ba 0E94 0000 		call free
 2388               	.L152:
 2389 11be AA24      		clr r10
 2390 11c0 AA94      		dec r10
 2391 11c2 BA2C      		mov r11,r10
 2392 11c4 00C0      		rjmp .L131
 2393               	.L144:
 2394 11c6 F701      		movw r30,r14
GAS LISTING C:\Temp/cc64q1PH.s 			page 43


 2395 11c8 26E4      		ldi r18,lo8(70)
 2396 11ca 1192      		st Z+,__zero_reg__
 2397 11cc 2A95      	        dec r18
 2398 11ce 01F4      		brne .-6
 2399 11d0 D701      		movw r26,r14
 2400 11d2 5896      		adiw r26,24
 2401 11d4 F601      		movw r30,r12
 2402 11d6 8BE0      		ldi r24,lo8(11)
 2403               	.L145:
 2404 11d8 0190      		ld r0,Z+
 2405 11da 0D92      		st X+,r0
 2406 11dc 8150      		subi r24,lo8(-(-1))
 2407 11de 01F4      		brne .L145
 2408 11e0 F601      		movw r30,r12
 2409 11e2 8385      		ldd r24,Z+11
 2410 11e4 F701      		movw r30,r14
 2411 11e6 83A3      		std Z+35,r24
 2412 11e8 F601      		movw r30,r12
 2413 11ea 8485      		ldd r24,Z+12
 2414 11ec F701      		movw r30,r14
 2415 11ee 84A3      		std Z+36,r24
 2416 11f0 F601      		movw r30,r12
 2417 11f2 8585      		ldd r24,Z+13
 2418 11f4 F701      		movw r30,r14
 2419 11f6 85A3      		std Z+37,r24
 2420 11f8 F601      		movw r30,r12
 2421 11fa 8685      		ldd r24,Z+14
 2422 11fc 9785      		ldd r25,Z+15
 2423 11fe F701      		movw r30,r14
 2424 1200 97A3      		std Z+39,r25
 2425 1202 86A3      		std Z+38,r24
 2426 1204 F601      		movw r30,r12
 2427 1206 8089      		ldd r24,Z+16
 2428 1208 9189      		ldd r25,Z+17
 2429 120a F701      		movw r30,r14
 2430 120c 91A7      		std Z+41,r25
 2431 120e 80A7      		std Z+40,r24
 2432               	.L151:
 2433 1210 80E4      		ldi r24,lo8(64)
 2434 1212 90E0      		ldi r25,hi8(64)
 2435 1214 E80E      		add r14,r24
 2436 1216 F91E      		adc r15,r25
 2437 1218 81E0      		ldi r24,lo8(1)
 2438 121a 90E0      		ldi r25,hi8(1)
 2439 121c F701      		movw r30,r14
 2440 121e 9183      		std Z+1,r25
 2441 1220 8083      		st Z,r24
 2442 1222 80EC      		ldi r24,lo8(-64)
 2443 1224 9FEF      		ldi r25,hi8(-64)
 2444 1226 E80E      		add r14,r24
 2445 1228 F91E      		adc r15,r25
 2446 122a 00C0      		rjmp .L141
 2447               	.L143:
 2448 122c D701      		movw r26,r14
 2449 122e 5896      		adiw r26,24
 2450 1230 F601      		movw r30,r12
 2451 1232 80E2      		ldi r24,lo8(32)
GAS LISTING C:\Temp/cc64q1PH.s 			page 44


 2452               	.L146:
 2453 1234 0190      		ld r0,Z+
 2454 1236 0D92      		st X+,r0
 2455 1238 8150      		subi r24,lo8(-(-1))
 2456 123a 01F4      		brne .L146
 2457               	.L141:
 2458 123c C601      		movw r24,r12
 2459 123e 0E94 0000 		call free
 2460 1242 F201      		movw r30,r4
 2461 1244 4481      		ldd r20,Z+4
 2462 1246 5581      		ldd r21,Z+5
 2463 1248 6681      		ldd r22,Z+6
 2464 124a 7781      		ldd r23,Z+7
 2465 124c C501      		movw r24,r10
 2466 124e 0E94 0000 		call PhatClusterSector
 2467 1252 F201      		movw r30,r4
 2468 1254 2085      		ldd r18,Z+8
 2469 1256 3185      		ldd r19,Z+9
 2470 1258 4285      		ldd r20,Z+10
 2471 125a 5385      		ldd r21,Z+11
 2472 125c 260F      		add r18,r22
 2473 125e 371F      		adc r19,r23
 2474 1260 481F      		adc r20,r24
 2475 1262 591F      		adc r21,r25
 2476 1264 F701      		movw r30,r14
 2477 1266 20AF      		std Z+56,r18
 2478 1268 31AF      		std Z+57,r19
 2479 126a 42AF      		std Z+58,r20
 2480 126c 53AF      		std Z+59,r21
 2481 126e F201      		movw r30,r4
 2482 1270 8485      		ldd r24,Z+12
 2483 1272 9585      		ldd r25,Z+13
 2484 1274 A685      		ldd r26,Z+14
 2485 1276 B785      		ldd r27,Z+15
 2486 1278 8097      		sbiw r24,32
 2487 127a A109      		sbc r26,__zero_reg__
 2488 127c B109      		sbc r27,__zero_reg__
 2489 127e F701      		movw r30,r14
 2490 1280 84AF      		std Z+60,r24
 2491 1282 95AF      		std Z+61,r25
 2492 1284 A6AF      		std Z+62,r26
 2493 1286 B7AF      		std Z+63,r27
 2494 1288 84E4      		ldi r24,lo8(68)
 2495 128a 90E0      		ldi r25,hi8(68)
 2496 128c E80E      		add r14,r24
 2497 128e F91E      		adc r15,r25
 2498 1290 F201      		movw r30,r4
 2499 1292 84A5      		ldd r24,Z+44
 2500 1294 95A5      		ldd r25,Z+45
 2501 1296 F701      		movw r30,r14
 2502 1298 9183      		std Z+1,r25
 2503 129a 8083      		st Z,r24
 2504 129c F201      		movw r30,r4
 2505 129e 82A9      		ldd r24,Z+50
 2506 12a0 93A9      		ldd r25,Z+51
 2507 12a2 F701      		movw r30,r14
 2508 12a4 9293      		st -Z,r25
GAS LISTING C:\Temp/cc64q1PH.s 			page 45


 2509 12a6 8293      		st -Z,r24
 2510 12a8 7F01      		movw r14,r30
 2511 12aa 8EEB      		ldi r24,lo8(-66)
 2512 12ac 9FEF      		ldi r25,hi8(-66)
 2513 12ae E80E      		add r14,r24
 2514 12b0 F91E      		adc r15,r25
 2515 12b2 F701      		movw r30,r14
 2516 12b4 84A5      		ldd r24,Z+44
 2517 12b6 95A5      		ldd r25,Z+45
 2518 12b8 A0E0      		ldi r26,lo8(0)
 2519 12ba B0E0      		ldi r27,hi8(0)
 2520 12bc DC01      		movw r26,r24
 2521 12be 9927      		clr r25
 2522 12c0 8827      		clr r24
 2523 12c2 22A9      		ldd r18,Z+50
 2524 12c4 33A9      		ldd r19,Z+51
 2525 12c6 40E0      		ldi r20,lo8(0)
 2526 12c8 50E0      		ldi r21,hi8(0)
 2527 12ca 820F      		add r24,r18
 2528 12cc 931F      		adc r25,r19
 2529 12ce A41F      		adc r26,r20
 2530 12d0 B51F      		adc r27,r21
 2531 12d2 8483      		std Z+4,r24
 2532 12d4 9583      		std Z+5,r25
 2533 12d6 A683      		std Z+6,r26
 2534 12d8 B783      		std Z+7,r27
 2535 12da C101      		movw r24,r2
 2536 12dc AA27      		clr r26
 2537 12de 97FD      		sbrc r25,7
 2538 12e0 A095      		com r26
 2539 12e2 BA2F      		mov r27,r26
 2540 12e4 848B      		std Z+20,r24
 2541 12e6 958B      		std Z+21,r25
 2542 12e8 A68B      		std Z+22,r26
 2543 12ea B78B      		std Z+23,r27
 2544 12ec C501      		movw r24,r10
 2545 12ee 0E94 0000 		call PhatFileClose
 2546 12f2 23FE      		sbrs r2,3
 2547 12f4 00C0      		rjmp .L147
 2548 12f6 F701      		movw r30,r14
 2549 12f8 44A9      		ldd r20,Z+52
 2550 12fa 55A9      		ldd r21,Z+53
 2551 12fc 66A9      		ldd r22,Z+54
 2552 12fe 77A9      		ldd r23,Z+55
 2553 1300 4115      		cp r20,__zero_reg__
 2554 1302 5105      		cpc r21,__zero_reg__
 2555 1304 6105      		cpc r22,__zero_reg__
 2556 1306 7105      		cpc r23,__zero_reg__
 2557 1308 01F0      		breq .L147
 2558 130a C401      		movw r24,r8
 2559 130c 0E94 0000 		call PhatFilePosSet
 2560 1310 892B      		or r24,r25
 2561 1312 01F0      		breq .L147
 2562               	.L155:
 2563 1314 C401      		movw r24,r8
 2564 1316 0E94 0000 		call PhatFileClose
 2565 131a 00C0      		rjmp .L152
GAS LISTING C:\Temp/cc64q1PH.s 			page 46


 2566               	.L147:
 2567 131c 5401      		movw r10,r8
 2568               	.L131:
 2569 131e C501      		movw r24,r10
 2570               	/* epilogue start */
 2571 1320 0F90      		pop __tmp_reg__
 2572 1322 0F90      		pop __tmp_reg__
 2573 1324 0F90      		pop __tmp_reg__
 2574 1326 0F90      		pop __tmp_reg__
 2575 1328 CF91      		pop r28
 2576 132a DF91      		pop r29
 2577 132c 1F91      		pop r17
 2578 132e 0F91      		pop r16
 2579 1330 FF90      		pop r15
 2580 1332 EF90      		pop r14
 2581 1334 DF90      		pop r13
 2582 1336 CF90      		pop r12
 2583 1338 BF90      		pop r11
 2584 133a AF90      		pop r10
 2585 133c 9F90      		pop r9
 2586 133e 8F90      		pop r8
 2587 1340 7F90      		pop r7
 2588 1342 6F90      		pop r6
 2589 1344 5F90      		pop r5
 2590 1346 4F90      		pop r4
 2591 1348 3F90      		pop r3
 2592 134a 2F90      		pop r2
 2593 134c 0895      		ret
 2594               		.size	PhatFileOpen, .-PhatFileOpen
 2595               		.type	PhatApiFileOpen, @function
 2596               	PhatApiFileOpen:
 2597 134e AF92      		push r10
 2598 1350 BF92      		push r11
 2599 1352 CF92      		push r12
 2600 1354 DF92      		push r13
 2601 1356 EF92      		push r14
 2602 1358 FF92      		push r15
 2603 135a 0F93      		push r16
 2604 135c 1F93      		push r17
 2605 135e CF93      		push r28
 2606 1360 DF93      		push r29
 2607               	/* prologue: function */
 2608               	/* frame size = 0 */
 2609 1362 7C01      		movw r14,r24
 2610 1364 5B01      		movw r10,r22
 2611 1366 6A01      		movw r12,r20
 2612 1368 E901      		movw r28,r18
 2613 136a FC01      		movw r30,r24
 2614 136c 8189      		ldd r24,Z+17
 2615 136e 9289      		ldd r25,Z+18
 2616 1370 0097      		sbiw r24,0
 2617 1372 01F4      		brne .L157
 2618 1374 82E0      		ldi r24,lo8(2)
 2619 1376 90E0      		ldi r25,hi8(2)
 2620 1378 9093 0000 		sts (errno)+1,r25
 2621 137c 8093 0000 		sts errno,r24
 2622 1380 CFEF      		ldi r28,lo8(-1)
GAS LISTING C:\Temp/cc64q1PH.s 			page 47


 2623 1382 DFEF      		ldi r29,hi8(-1)
 2624 1384 00C0      		rjmp .L158
 2625               	.L157:
 2626 1386 8C01      		movw r16,r24
 2627 1388 0E5E      		subi r16,lo8(-(18))
 2628 138a 1F4F      		sbci r17,hi8(-(18))
 2629 138c 40E0      		ldi r20,lo8(0)
 2630 138e 50E0      		ldi r21,hi8(0)
 2631 1390 60E0      		ldi r22,hlo8(0)
 2632 1392 70E0      		ldi r23,hhi8(0)
 2633 1394 C801      		movw r24,r16
 2634 1396 0E94 0000 		call NutEventWait
 2635 139a 9E01      		movw r18,r28
 2636 139c A601      		movw r20,r12
 2637 139e B501      		movw r22,r10
 2638 13a0 C701      		movw r24,r14
 2639 13a2 0E94 0000 		call PhatFileOpen
 2640 13a6 EC01      		movw r28,r24
 2641 13a8 C801      		movw r24,r16
 2642 13aa 0E94 0000 		call NutEventPost
 2643               	.L158:
 2644 13ae CE01      		movw r24,r28
 2645               	/* epilogue start */
 2646 13b0 DF91      		pop r29
 2647 13b2 CF91      		pop r28
 2648 13b4 1F91      		pop r17
 2649 13b6 0F91      		pop r16
 2650 13b8 FF90      		pop r15
 2651 13ba EF90      		pop r14
 2652 13bc DF90      		pop r13
 2653 13be CF90      		pop r12
 2654 13c0 BF90      		pop r11
 2655 13c2 AF90      		pop r10
 2656 13c4 0895      		ret
 2657               		.size	PhatApiFileOpen, .-PhatApiFileOpen
 2658               	.global	devPhat0
 2659               		.data
 2660               		.type	devPhat0, @object
 2661               		.size	devPhat0, 35
 2662               	devPhat0:
 2663 0000 0000      		.word	0
 2664 0002 50        		.byte	80
 2665 0003 48        		.byte	72
 2666 0004 41        		.byte	65
 2667 0005 54        		.byte	84
 2668 0006 30        		.byte	48
 2669 0007 00        		.byte	0
 2670 0008 00        		.byte	0
 2671 0009 00        		.byte	0
 2672 000a 00        		.byte	0
 2673 000b 10        		.byte	16
 2674 000c 0000      		.word	0
 2675 000e 00        		.byte	0
 2676 000f 0000      		.word	0
 2677 0011 0000      		.word	0
 2678 0013 0000      		.word	gs(PhatInit)
 2679 0015 0000      		.word	gs(PhatApiIOCtl)
GAS LISTING C:\Temp/cc64q1PH.s 			page 48


 2680 0017 0000      		.word	gs(PhatApiFileRead)
 2681 0019 0000      		.word	gs(PhatApiFileWrite)
 2682 001b 0000      		.word	gs(PhatApiFileWrite_P)
 2683 001d 0000      		.word	gs(PhatApiFileOpen)
 2684 001f 0000      		.word	gs(PhatApiFileClose)
 2685 0021 0000      		.word	gs(PhatFileSize)
 2686               	.global	devPhat1
 2687               		.type	devPhat1, @object
 2688               		.size	devPhat1, 35
 2689               	devPhat1:
 2690 0023 0000      		.word	0
 2691 0025 50        		.byte	80
 2692 0026 48        		.byte	72
 2693 0027 41        		.byte	65
 2694 0028 54        		.byte	84
 2695 0029 31        		.byte	49
 2696 002a 00        		.byte	0
 2697 002b 00        		.byte	0
 2698 002c 00        		.byte	0
 2699 002d 00        		.byte	0
 2700 002e 10        		.byte	16
 2701 002f 0000      		.word	0
 2702 0031 00        		.byte	0
 2703 0032 0000      		.word	0
 2704 0034 0000      		.word	0
 2705 0036 0000      		.word	gs(PhatInit)
 2706 0038 0000      		.word	gs(PhatApiIOCtl)
 2707 003a 0000      		.word	gs(PhatApiFileRead)
 2708 003c 0000      		.word	gs(PhatApiFileWrite)
 2709 003e 0000      		.word	gs(PhatApiFileWrite_P)
 2710 0040 0000      		.word	gs(PhatApiFileOpen)
 2711 0042 0000      		.word	gs(PhatApiFileClose)
 2712 0044 0000      		.word	gs(PhatFileSize)
GAS LISTING C:\Temp/cc64q1PH.s 			page 49


DEFINED SYMBOLS
                            *ABS*:00000000 phatfs.c
  C:\Temp/cc64q1PH.s:2      *ABS*:0000003f __SREG__
  C:\Temp/cc64q1PH.s:3      *ABS*:0000003e __SP_H__
  C:\Temp/cc64q1PH.s:4      *ABS*:0000003d __SP_L__
  C:\Temp/cc64q1PH.s:5      *ABS*:00000034 __CCP__
  C:\Temp/cc64q1PH.s:6      *ABS*:00000000 __tmp_reg__
  C:\Temp/cc64q1PH.s:7      *ABS*:00000001 __zero_reg__
  C:\Temp/cc64q1PH.s:13     .text:00000000 PhatFileWrite_P
  C:\Temp/cc64q1PH.s:22     .text:00000006 PhatFileSize
  C:\Temp/cc64q1PH.s:38     .text:0000001a PhatInit
  C:\Temp/cc64q1PH.s:47     .text:00000020 PhatApiFileWrite_P
  C:\Temp/cc64q1PH.s:77     .text:00000054 SearchFreeCluster
  C:\Temp/cc64q1PH.s:290    .text:000001e2 AllocCluster
  C:\Temp/cc64q1PH.s:397    .text:000002aa PhatFileRead
  C:\Temp/cc64q1PH.s:808    .text:000005c6 PhatApiFileRead
  C:\Temp/cc64q1PH.s:859    .text:00000626 PhatFileFlush
  C:\Temp/cc64q1PH.s:909    .text:00000684 AllocNextCluster
  C:\Temp/cc64q1PH.s:1049   .text:00000792 AllocFirstCluster
  C:\Temp/cc64q1PH.s:1176   .text:00000880 PhatFileWrite
  C:\Temp/cc64q1PH.s:1791   .text:00000d36 PhatApiFileWrite
  C:\Temp/cc64q1PH.s:1843   .text:00000d96 PhatFileClose
  C:\Temp/cc64q1PH.s:1884   .text:00000de0 PhatApiFileClose
  C:\Temp/cc64q1PH.s:1923   .text:00000e28 PhatApiIOCtl
  C:\Temp/cc64q1PH.s:2202   .text:00001036 PhatFileOpen
  C:\Temp/cc64q1PH.s:2596   .text:0000134e PhatApiFileOpen
  C:\Temp/cc64q1PH.s:2662   .data:00000000 devPhat0
  C:\Temp/cc64q1PH.s:2689   .data:00000023 devPhat1

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
NutEventWait
NutEventPost
Phat32GetClusterLink
Phat16GetClusterLink
Phat12GetClusterLink
errno
IsFixedRootDir
PhatClusterSector
PhatSectorLoad
memcpy
PhatDirEntryUpdate
PhatSectorFlush
Phat32SetClusterLink
Phat16SetClusterLink
Phat12SetClusterLink
__udivmodsi4
GetDosTimeStamp
free
PhatDirEntryStatus
PhatDirCreate
PhatDirRemove
PhatDirOpen
PhatDirRead
PhatDirDelEntry
PhatFilePosSet
GAS LISTING C:\Temp/cc64q1PH.s 			page 50


PhatDirRenameEntry
PhatVolMount
PhatVolUnmount
PhatDirOpenParent
malloc
PhatDirEntryFind
PhatDirEntryCreate
PhatDirReleaseChain
