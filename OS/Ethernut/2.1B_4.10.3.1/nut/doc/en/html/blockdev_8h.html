<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: include/dev/blockdev.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('blockdev_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">blockdev.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Block device driver definitions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="types_8h_source.html">sys/types.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="stdint_8h_source.html">stdint.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="device_8h_source.html">sys/device.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="file_8h_source.html">sys/file.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for blockdev.h:</div>
<div class="dyncontent">
<div class="center"><img src="blockdev_8h__incl.png" border="0" usemap="#include_2dev_2blockdev_8h" alt=""/></div>
<map name="include_2dev_2blockdev_8h" id="include_2dev_2blockdev_8h">
<area shape="rect" id="node3" href="types_8h.html" title="Nut/OS type declarations." alt="" coords="52,230,135,255"/><area shape="rect" id="node9" href="stdint_8h.html" title="stdint.h" alt="" coords="51,155,113,181"/><area shape="rect" id="node11" href="device_8h.html" title="Nut/OS device definitions." alt="" coords="102,81,191,106"/><area shape="rect" id="node13" href="file_8h.html" title="sys/file.h" alt="" coords="138,155,208,181"/><area shape="rect" id="node5" href="compiler_8h.html" title="compiler.h" alt="" coords="5,305,85,330"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="blockdev_8h__dep__incl.png" border="0" usemap="#include_2dev_2blockdev_8hdep" alt=""/></div>
<map name="include_2dev_2blockdev_8hdep" id="include_2dev_2blockdev_8hdep">
<area shape="rect" id="node3" href="at91__mci_8c.html" title="arch/arm/dev/atmel/at91_mci.c" alt="" coords="5,81,195,106"/><area shape="rect" id="node5" href="blockdev_8c.html" title="Generic block I/O device routines." alt="" coords="220,81,321,106"/><area shape="rect" id="node7" href="mmcard_8c.html" title="dev/mmcard.c" alt="" coords="345,81,444,106"/><area shape="rect" id="node9" href="spi__7seg_8c.html" title="Routines for 7 segment display." alt="" coords="469,81,573,106"/><area shape="rect" id="node11" href="spi__at45d_8c.html" title="Routines for Atmel AT45 serial DataFlash memory chips." alt="" coords="598,81,705,106"/><area shape="rect" id="node13" href="spi__at45d0_8c.html" title="First AT45D DataFlash device." alt="" coords="731,81,845,106"/><area shape="rect" id="node15" href="spi__at45d1_8c.html" title="Second AT45D DataFlash device." alt="" coords="869,81,984,106"/><area shape="rect" id="node17" href="spi__at45d2_8c.html" title="Third AT45D DataFlash device." alt="" coords="1008,81,1123,106"/><area shape="rect" id="node19" href="spi__at45d3_8c.html" title="Forth AT45D DataFlash device." alt="" coords="1147,81,1261,106"/><area shape="rect" id="node21" href="spi__blkio__at45d_8c.html" title="Low level block I/O routines for Atmel AT45D SPI Flash." alt="" coords="1285,81,1427,106"/><area shape="rect" id="node23" href="spi__mmc_8c.html" title="dev/spi_mmc.c" alt="" coords="1451,81,1556,106"/><area shape="rect" id="node25" href="spi__node__at45d_8c.html" title="Low level routines for Atmel AT45D SPI Flash." alt="" coords="1581,81,1723,106"/><area shape="rect" id="node27" href="phatdbg_8c.html" title="PHAT debugging support." alt="" coords="1747,81,1836,106"/><area shape="rect" id="node29" href="phatfs_8c.html" title="PHAT File System." alt="" coords="1861,81,1939,106"/><area shape="rect" id="node31" href="phatio_8c.html" title="PHAT File System." alt="" coords="1963,81,2041,106"/><area shape="rect" id="node33" href="phatvol_8c.html" title="Volume related routines of the PHAT file system." alt="" coords="2067,81,2149,106"/><area shape="rect" id="node35" href="rawfs_8c.html" title="Raw device file system." alt="" coords="2173,81,2248,106"/></map>
</div>
</div>
<p><a href="blockdev_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___b_l_k_p_a_r___s_e_e_k.html">_BLKPAR_SEEK</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Block seek parameter structure.  <a href="struct___b_l_k_p_a_r___s_e_e_k.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___b_l_k_p_a_r___i_n_f_o.html">_BLKPAR_INFO</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Device information parameter structure.  <a href="struct___b_l_k_p_a_r___i_n_f_o.html#details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___n_u_t_b_l_o_c_k_i_o.html">_NUTBLOCKIO</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic block I/O device interface structure.  <a href="struct___n_u_t_b_l_o_c_k_i_o.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___b_l_k_p_a_r___s_e_e_k.html">_BLKPAR_SEEK</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga7db3bee8199e18b65c1609b8a2bc37eb">BLKPAR_SEEK</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Block seek parameter structure.  <a href="group__xg_block_dev.html#ga7db3bee8199e18b65c1609b8a2bc37eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___b_l_k_p_a_r___i_n_f_o.html">_BLKPAR_INFO</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga55168d7061d799d74a492b0756f2a8f8">BLKPAR_INFO</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Device information parameter structure.  <a href="group__xg_block_dev.html#ga55168d7061d799d74a492b0756f2a8f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___n_u_t_b_l_o_c_k_i_o.html">_NUTBLOCKIO</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga288b671029d86d5d0f6a30788c797b3e">NUTBLOCKIO</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic block I/O device interface structure type.  <a href="group__xg_block_dev.html#ga288b671029d86d5d0f6a30788c797b3e"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#a8dff5efbfd16eb8e5469cebdb4a48dd7">NutBlockDeviceInit</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the block I/O device.  <a href="#a8dff5efbfd16eb8e5469cebdb4a48dd7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#afffc23aaf619cbd701ae56f1f564add7">NutBlockDeviceOpen</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, CONST char *name, int mode, int acc)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Mount a volume.  <a href="#afffc23aaf619cbd701ae56f1f564add7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#aa2cb41faba478283c8f2d20ecd20f2de">NutBlockDeviceClose</a> (<a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *nfp)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Unmount a currently mounted volume.  <a href="#aa2cb41faba478283c8f2d20ecd20f2de"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#a4bf0f1d91269e65455d063c5e202add1">NutBlockDeviceIOCtl</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, int req, void *conf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform block I/O device control functions.  <a href="#a4bf0f1d91269e65455d063c5e202add1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#a6d4988c118b95110454bc6e5c0b369bd">NutBlockDeviceRead</a> (<a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *nfp, void *buffer, int num)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data blocks from a mounted volume.  <a href="#a6d4988c118b95110454bc6e5c0b369bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#a06d1a07ba0114de8976c9eb814b448df">NutBlockDeviceWrite</a> (<a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *nfp, CONST void *buffer, int num)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data blocks to a mounted volume.  <a href="#a06d1a07ba0114de8976c9eb814b448df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#ad65b4cb4433a4cde45dce7cbb8fd3333">NutBlockDeviceSize</a> (<a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *nfp)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the size of a mounted volume.  <a href="#ad65b4cb4433a4cde45dce7cbb8fd3333"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="blockdev_8h.html#a38e4c131ecf1add88ecf497563483ddd">NutBlockDeviceWrite_P</a> (<a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *nfp, PGM_P buffer, int num)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data blocks from program space to a mounted volume.  <a href="#a38e4c131ecf1add88ecf497563483ddd"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="member-group"></a>
Control Codes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#gad5bcfe283715d269e64a3d70fa58c3d3">NUTBLKDEV_MEDIAAVAIL</a>&#160;&#160;&#160;0x1200</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query for media change.  <a href="group__xg_block_dev.html#gad5bcfe283715d269e64a3d70fa58c3d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga0021380fd206ad6327ee752d3df8722c">NUTBLKDEV_MEDIACHANGE</a>&#160;&#160;&#160;0x1201</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query for media change.  <a href="group__xg_block_dev.html#ga0021380fd206ad6327ee752d3df8722c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga4bbfed5ff6ce9e59e382558829f3c8ff">NUTBLKDEV_INFO</a>&#160;&#160;&#160;0x1202</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve device information.  <a href="group__xg_block_dev.html#ga4bbfed5ff6ce9e59e382558829f3c8ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_block_dev.html#ga2c6a77c523c97bfc14789c8ab369fe58">NUTBLKDEV_SEEK</a>&#160;&#160;&#160;0x1203</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Block seek request.  <a href="group__xg_block_dev.html#ga2c6a77c523c97bfc14789c8ab369fe58"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Block device driver definitions. </p>
<div class="fragment"><pre class="fragment">
 *
 * $Log$
 * Revision 1.4  2009/01/09 17:59:05  haraldkipp
 * Added target independent AT45D block device drivers and non-volatile
 * memory support based on the new bus controllers.
 *
 * Revision 1.3  2008/08/11 06:59:59  haraldkipp
 * BSD types replaced by stdint types (feature request #1282721).
 *
 * Revision 1.2  2006/04/07 12:57:48  haraldkipp
 * Added ioctl(NUTBLKDEV_MEDIAAVAIL).
 *
 * Revision 1.1  2006/01/05 16:32:05  haraldkipp
 * First check-in.
 *
 *
 * </pre></div> 
<p>Definition in file <a class="el" href="blockdev_8h_source.html">blockdev.h</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a8dff5efbfd16eb8e5469cebdb4a48dd7"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceInit" ref="a8dff5efbfd16eb8e5469cebdb4a48dd7" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the block I/O device. </p>
<p>This dummy routine may be used by drivers, which do not need any specific initialization.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Always 0. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00131">131</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="afffc23aaf619cbd701ae56f1f564add7"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceOpen" ref="afffc23aaf619cbd701ae56f1f564add7" args="(NUTDEVICE *dev, CONST char *name, int mode, int acc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a>* NutBlockDeviceOpen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>acc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Mount a volume. </p>
<p>Nut/OS doesn't provide specific routines for mounting. Instead routines for opening files are used.</p>
<p>Applications should not directly call this function, but use the high level stdio routines for opening a file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the block I/O device. </td></tr>
    <tr><td class="paramname">name</td><td>Partition number followed by a slash followed by a name of the file system device. Both items are optional. If no file system driver name is given, the first file system driver found in the list of registered devices will be used. If no partition number is specified or if partition zero is given, the first active primary partition will be used. </td></tr>
    <tr><td class="paramname">mode</td><td>Opening mode. Currently ignored, but <div class="fragment"><pre class="fragment"> <a class="code" href="group__xg_crt_lowio.html#ga010187fb7398870cb57af650e65bded1">_O_RDWR</a> | <a class="code" href="group__xg_crt_lowio.html#ga166a079a4990ddeb0a32475728bbacd0">_O_BINARY</a> 
</pre></div> should be used for compatibility with future enhancements. </td></tr>
    <tr><td class="paramname">acc</td><td>File attributes, ignored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Pointer to a newly created file pointer to the mounted partition or NUTFILE_EOF in case of any error. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00163">163</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00128">_NUTBLOCKIO::blkio_blk_cnt</a>, <a class="el" href="blockdev_8h_source.html#l00133">_NUTBLOCKIO::blkio_blk_siz</a>, <a class="el" href="blockdev_8h_source.html#l00138">_NUTBLOCKIO::blkio_vol_bot</a>, <a class="el" href="blockdev_8h_source.html#l00143">_NUTBLOCKIO::blkio_vol_top</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="device_8h_source.html#l00230">_NUTDEVICE::dev_ioctl</a>, <a class="el" href="errno_8h_source.html#l00072">ENODEV</a>, <a class="el" href="errno_8c_source.html#l00042">errno</a>, <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="fs_2fs_8h_source.html#l00123">FS_VOL_MOUNT</a>, <a class="el" href="fs_2fs_8h_source.html#l00153">_FSCP_VOL_MOUNT::fscp_bmnt</a>, <a class="el" href="fs_2fs_8h_source.html#l00155">_FSCP_VOL_MOUNT::fscp_part_type</a>, <a class="el" href="device_8h_source.html#l00143">IFTYP_FS</a>, <a class="el" href="malloc_8c_source.html#l00064">malloc()</a>, <a class="el" href="file_8h_source.html#l00080">_NUTFILE::nf_dev</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="file_8h_source.html#l00075">_NUTFILE::nf_next</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="devreg_8c_source.html#l00090">NutDeviceLookup()</a>, <a class="el" href="file_8h_source.html#l00088">NUTFILE_EOF</a>, <a class="el" href="blockdev_8c_source.html#l00099">_BLOCKVOLUME::vol_blk_buf</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>, <a class="el" href="blockdev_8c_source.html#l00088">_BLOCKVOLUME::vol_blk_num</a>, <a class="el" href="blockdev_8c_source.html#l00079">_BLOCKVOLUME::vol_blk_off</a>, and <a class="el" href="blockdev_8c_source.html#l00067">_BLOCKVOLUME::vol_fsdev</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="blockdev_8h_afffc23aaf619cbd701ae56f1f564add7_cgraph.png" border="0" usemap="#blockdev_8h_afffc23aaf619cbd701ae56f1f564add7_cgraph" alt=""/></div>
<map name="blockdev_8h_afffc23aaf619cbd701ae56f1f564add7_cgraph" id="blockdev_8h_afffc23aaf619cbd701ae56f1f564add7_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="231,5,273,30"/><area shape="rect" id="node5" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="223,54,281,79"/><area shape="rect" id="node7" href="group__xg_device.html#ga913130771bea4118ae58e2a0ccb50a4d" title="Find device entry by name." alt="" coords="193,103,311,129"/><area shape="rect" id="node9" href="group__xg_crt_string.html#gaafa356ff1e215725834bc57e8e4fae60" title="Compare two strings." alt="" coords="361,103,421,129"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa2cb41faba478283c8f2d20ecd20f2de"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceClose" ref="aa2cb41faba478283c8f2d20ecd20f2de" args="(NUTFILE *nfp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceClose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td>
          <td class="paramname"><em>nfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unmount a currently mounted volume. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nfp</td><td>File pointer to a previously mounted volume.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00241">241</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="device_8h_source.html#l00230">_NUTDEVICE::dev_ioctl</a>, <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="fs_2fs_8h_source.html#l00124">FS_VOL_UNMOUNT</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, and <a class="el" href="blockdev_8c_source.html#l00067">_BLOCKVOLUME::vol_fsdev</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="blockdev_8h_aa2cb41faba478283c8f2d20ecd20f2de_cgraph.png" border="0" usemap="#blockdev_8h_aa2cb41faba478283c8f2d20ecd20f2de_cgraph" alt=""/></div>
<map name="blockdev_8h_aa2cb41faba478283c8f2d20ecd20f2de_cgraph" id="blockdev_8h_aa2cb41faba478283c8f2d20ecd20f2de_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="195,5,237,30"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4bf0f1d91269e65455d063c5e202add1"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceIOCtl" ref="a4bf0f1d91269e65455d063c5e202add1" args="(NUTDEVICE *dev, int req, void *conf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceIOCtl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform block I/O device control functions. </p>
<p>This function is called by the ioctl() function of the C runtime library. Applications should not directly call this function.</p>
<p>Unkown requests are passed to the block I/O device.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Identifies the device that receives the device-control function. </td></tr>
    <tr><td class="paramname">req</td><td>Requested control function. May be set to one of the following constants:<ul>
<li><a class="el" href="group__xg_block_dev.html#ga4bbfed5ff6ce9e59e382558829f3c8ff">NUTBLKDEV_INFO</a>, conf points to a <a class="el" href="group__xg_block_dev.html#ga55168d7061d799d74a492b0756f2a8f8">BLKPAR_INFO</a> structure.</li>
<li><a class="el" href="group__xg_block_dev.html#ga2c6a77c523c97bfc14789c8ab369fe58">NUTBLKDEV_SEEK</a>, conf points to a <a class="el" href="group__xg_block_dev.html#ga7db3bee8199e18b65c1609b8a2bc37eb">BLKPAR_SEEK</a> structure.</li>
</ul>
</td></tr>
    <tr><td class="paramname">conf</td><td>Points to a buffer that contains any data required for the given control function or receives data from that function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00280">280</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00165">_NUTBLOCKIO::blkio_ioctl</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="blockdev_8h_source.html#l00080">NUTBLKDEV_INFO</a>, <a class="el" href="blockdev_8h_source.html#l00082">NUTBLKDEV_SEEK</a>, <a class="el" href="blockdev_8h_source.html#l00105">_BLKPAR_INFO::par_blkbp</a>, <a class="el" href="blockdev_8h_source.html#l00093">_BLKPAR_SEEK::par_blknum</a>, <a class="el" href="blockdev_8h_source.html#l00104">_BLKPAR_INFO::par_blksz</a>, <a class="el" href="blockdev_8h_source.html#l00103">_BLKPAR_INFO::par_nblks</a>, <a class="el" href="blockdev_8h_source.html#l00092">_BLKPAR_SEEK::par_nfp</a>, <a class="el" href="blockdev_8h_source.html#l00102">_BLKPAR_INFO::par_nfp</a>, <a class="el" href="blockdev_8c_source.html#l00099">_BLOCKVOLUME::vol_blk_buf</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>, and <a class="el" href="blockdev_8c_source.html#l00088">_BLOCKVOLUME::vol_blk_num</a>.</p>

</div>
</div>
<a class="anchor" id="a6d4988c118b95110454bc6e5c0b369bd"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceRead" ref="a6d4988c118b95110454bc6e5c0b369bd" args="(NUTFILE *nfp, void *buffer, int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td>
          <td class="paramname"><em>nfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read data blocks from a mounted volume. </p>
<p>The current position may have been set by a previous I/O control <a class="el" href="group__xg_block_dev.html#ga2c6a77c523c97bfc14789c8ab369fe58">NUTBLKDEV_SEEK</a>.</p>
<p>Applications should not call this function directly, but use the stdio interface.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nfp</td><td>File pointer to a previously mounted volume. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to the data buffer to fill. </td></tr>
    <tr><td class="paramname">num</td><td>Number of blocks to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of blocks actually read. The current position is set to the next unread block. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00348">348</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00148">_NUTBLOCKIO::blkio_read</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="file_8h_source.html#l00080">_NUTFILE::nf_dev</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>, <a class="el" href="blockdev_8c_source.html#l00088">_BLOCKVOLUME::vol_blk_num</a>, and <a class="el" href="blockdev_8c_source.html#l00079">_BLOCKVOLUME::vol_blk_off</a>.</p>

</div>
</div>
<a class="anchor" id="a06d1a07ba0114de8976c9eb814b448df"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceWrite" ref="a06d1a07ba0114de8976c9eb814b448df" args="(NUTFILE *nfp, CONST void *buffer, int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td>
          <td class="paramname"><em>nfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write data blocks to a mounted volume. </p>
<p>The current position may have been set by a previous I/O control <a class="el" href="group__xg_block_dev.html#ga2c6a77c523c97bfc14789c8ab369fe58">NUTBLKDEV_SEEK</a>.</p>
<p>Applications should not call this function directly, but use the stdio interface.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nfp</td><td>File pointer to a previously mounted volume. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to the data to be written. </td></tr>
    <tr><td class="paramname">num</td><td>Number of blocks to write.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of blocks actually written. The current position is set to the next block. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00400">400</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00153">_NUTBLOCKIO::blkio_write</a>, <a class="el" href="arm_8h_source.html#l00143">CONST</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="file_8h_source.html#l00080">_NUTFILE::nf_dev</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>, <a class="el" href="blockdev_8c_source.html#l00088">_BLOCKVOLUME::vol_blk_num</a>, and <a class="el" href="blockdev_8c_source.html#l00079">_BLOCKVOLUME::vol_blk_off</a>.</p>

</div>
</div>
<a class="anchor" id="ad65b4cb4433a4cde45dce7cbb8fd3333"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceSize" ref="ad65b4cb4433a4cde45dce7cbb8fd3333" args="(NUTFILE *nfp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long NutBlockDeviceSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td>
          <td class="paramname"><em>nfp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the size of a mounted volume. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nfp</td><td>File pointer to a previously mounted volume.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Total number of bytes. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00495">495</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, and <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>.</p>

</div>
</div>
<a class="anchor" id="a38e4c131ecf1add88ecf497563483ddd"></a><!-- doxytag: member="blockdev.h::NutBlockDeviceWrite_P" ref="a38e4c131ecf1add88ecf497563483ddd" args="(NUTFILE *nfp, PGM_P buffer, int num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutBlockDeviceWrite_P </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga66d4b4dd6b81551dadfe12d452ec4455">NUTFILE</a> *&#160;</td>
          <td class="paramname"><em>nfp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGM_P&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write data blocks from program space to a mounted volume. </p>
<p>Similar to <a class="el" href="blockdev_8h.html#a06d1a07ba0114de8976c9eb814b448df" title="Write data blocks to a mounted volume.">NutBlockDeviceWrite()</a> except that the data is located in program memory.</p>
<p>Applications should not call this function directly, but use the stdio interface.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nfp</td><td>File pointer to a previously mounted volume. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to the data bytes in program space to be written. </td></tr>
    <tr><td class="paramname">num</td><td>Number of blocks to write.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of blocks actually written. The current position is set to the next block. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="blockdev_8c_source.html#l00452">452</a> of file <a class="el" href="blockdev_8c_source.html">blockdev.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00153">_NUTBLOCKIO::blkio_write</a>, <a class="el" href="blockdev_8h_source.html#l00159">_NUTBLOCKIO::blkio_write_P</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="file_8h_source.html#l00080">_NUTFILE::nf_dev</a>, <a class="el" href="file_8h_source.html#l00085">_NUTFILE::nf_fcb</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="arm_8h_source.html#l00158">PGM_P</a>, <a class="el" href="blockdev_8c_source.html#l00071">_BLOCKVOLUME::vol_blk_cnt</a>, <a class="el" href="blockdev_8c_source.html#l00075">_BLOCKVOLUME::vol_blk_len</a>, <a class="el" href="blockdev_8c_source.html#l00088">_BLOCKVOLUME::vol_blk_num</a>, and <a class="el" href="blockdev_8c_source.html#l00079">_BLOCKVOLUME::vol_blk_off</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="blockdev_8h.html">blockdev.h</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
