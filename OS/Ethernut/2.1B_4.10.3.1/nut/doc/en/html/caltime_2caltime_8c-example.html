<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: caltime/caltime.c</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('caltime_2caltime_8c-example.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">caltime/caltime.c</div>  </div>
</div>
<div class="contents">
<p>Copyright (C) 2001-2005 by egnite Software GmbH Copyright (C) 2009-2010 by egnite GmbH</p>
<p>All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<p>1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. 3. Neither the name of the copyright holders nor the names of contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>For additional information see <a href="http://www.ethernut.de/">http://www.ethernut.de/</a></p>
<dl class="rcs"><dt><b>Id:</b></dt><dd><a class="el" href="caltime_8c.html">caltime.c</a> 3538 2011-08-10 16:34:10Z haraldkipp </dd></dl>
<p>Demonstrates Nut/OS date and time functions, which had been contributed by Oliver Schulz.</p>
<p>Check the Makefile for additional options.</p>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;<a class="code" href="board_8h.html">dev/board.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="debug_8h.html" title="Debug device definitions.">dev/debug.h</a>&gt;</span>

<span class="preprocessor">#include &lt;<a class="code" href="version_8h.html">sys/version.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="sys_2timer_8h.html" title="Timer management definitions.">sys/timer.h</a>&gt;</span>

<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="stdio_8h.html" title="C Standard I/O.">stdio.h</a>&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="io_8h.html">io.h</a>&gt;</span>
<span class="preprocessor">#include &lt;string.h&gt;</span>
<span class="preprocessor">#include &lt;<a class="code" href="time_8h.html" title="Standard C time handling functions.">time.h</a>&gt;</span>
<span class="preprocessor">#ifdef USE_BUILD_TIME</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="rfctime_8h.html" title="RFC date and time conversion header.">pro/rfctime.h</a>&gt;</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifdef USE_LINE_EDITOR</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;<a class="code" href="edline_8h.html">gorp/edline.h</a>&gt;</span>
<span class="preprocessor">#define LINE_MAXLENGTH  80</span>
<span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">char</span> edbuff[LINE_MAXLENGTH];
<span class="keyword">static</span> <a name="_a0"></a><a class="code" href="struct___e_d_l_i_n_e.html" title="Edit line information structure.">EDLINE</a> *edline;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="keyword">static</span> <span class="keywordtype">char</span> *version = <span class="stringliteral">&quot;2.1&quot;</span>;


<span class="comment">/* Used for ASCII Art Animation. */</span>
<span class="keyword">static</span> <span class="keywordtype">char</span> *rotor = <span class="stringliteral">&quot;|/-\\&quot;</span>;

<span class="keyword">static</span> <span class="keywordtype">char</span> *weekday_name[7] = {
    <span class="stringliteral">&quot;Sunday&quot;</span>, <span class="stringliteral">&quot;Monday&quot;</span>, <span class="stringliteral">&quot;Tuesday&quot;</span>, <span class="stringliteral">&quot;Wednesday&quot;</span>, <span class="stringliteral">&quot;Thursday&quot;</span>, <span class="stringliteral">&quot;Friday&quot;</span>, <span class="stringliteral">&quot;Saturday&quot;</span>
};

<span class="comment">/*</span>
<span class="comment"> * Print content of tm structure.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> PrintDateTime(<a name="a1"></a><a class="code" href="arm_8h.html#a0c33b494a68ce28497e7ce8e5e95feff">CONST</a> <span class="keyword">struct</span> <a name="_a2"></a><a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> *stm)
{
    <a name="a3"></a><a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;%s, %04d/%02d/%02d, %02d:%02d:%02d%s&quot;</span>
           , weekday_name[stm-&gt;tm_wday]
           , stm-&gt;tm_year + 1900, stm-&gt;tm_mon + 1, stm-&gt;tm_mday
           , stm-&gt;tm_hour, stm-&gt;tm_min, stm-&gt;tm_sec
           , stm-&gt;tm_isdst ? <span class="stringliteral">&quot; DST&quot;</span> : <span class="stringliteral">&quot;&quot;</span>
           );
}

<span class="comment">/*</span>
<span class="comment"> * Query calendar date from user.</span>
<span class="comment"> *</span>
<span class="comment"> * Returns 0 on success, -1 otherwise.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">int</span> EnterDate(<span class="keyword">struct</span> <a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> *stm)
{
    <span class="keywordtype">int</span> year = stm-&gt;<a name="a4"></a><a class="code" href="struct__tm.html#ac3393ee6984dd5d172af96f3c73dfc4d" title="years since 1900">tm_year</a> + 1900;
    <span class="keywordtype">int</span> month = stm-&gt;<a name="a5"></a><a class="code" href="struct__tm.html#a5b0caaf824889c6fb03f045e6fe7ab0f" title="months since January - [0,11]">tm_mon</a> + 1;
    <span class="keywordtype">int</span> day = stm-&gt;<a name="a6"></a><a class="code" href="struct__tm.html#a57ccfe4f816d4c25009693f025989874" title="day of the month - [1,31]">tm_mday</a>;

    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Enter date, use format YYYY/MM/DD&quot;</span>);
<span class="preprocessor">#ifdef USE_LINE_EDITOR</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;  : &quot;</span>);
    <a name="a7"></a><a class="code" href="icc_8h.html#a5998f60c4f4af322b36debdbd11d7917">sprintf</a>(edbuff, <span class="stringliteral">&quot;%04d/%02d/%02d&quot;</span>, year, month, day);
    <a name="a8"></a><a class="code" href="group__xg_ed_line.html#ga1ee9a05187982d0d6db66a925fe2d003" title="Read a line.">EdLineRead</a>(edline, edbuff, LINE_MAXLENGTH);
    <a name="a9"></a><a class="code" href="group__xg_crt_stdio.html#ga9cb8d06a3196a5f98973ae44d38a425a" title="Read formatted data from a string.">sscanf</a>(edbuff, <span class="stringliteral">&quot;%d/%d/%d&quot;</span>, &amp;year, &amp;month, &amp;day);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; (%04d/%02d/%02d): &quot;</span>, year, month, day);
    <a name="a10"></a><a class="code" href="icc_8h.html#a9d178d8ab459cd19f1a1749b60af46ca">scanf</a>(<span class="stringliteral">&quot;%d/%d/%d&quot;</span>, &amp;year, &amp;month, &amp;day);
    <a name="a11"></a><a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> (year &lt; 1970 || year &gt; 2038) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad year: %d is not within range 1970..2038\n&quot;</span>, year);
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> (month &lt; 1 || month &gt; 12) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad month: %d is not within range 1..12\n&quot;</span>, month);
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> (day &lt; 1 || day &gt; 31) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad day: %d is not within range 1..31\n&quot;</span>, day);
        <span class="keywordflow">return</span> -1;
    }
    stm-&gt;<a class="code" href="struct__tm.html#ac3393ee6984dd5d172af96f3c73dfc4d" title="years since 1900">tm_year</a> = year - 1900;
    stm-&gt;<a class="code" href="struct__tm.html#a5b0caaf824889c6fb03f045e6fe7ab0f" title="months since January - [0,11]">tm_mon</a> = month - 1;
    stm-&gt;<a class="code" href="struct__tm.html#a57ccfe4f816d4c25009693f025989874" title="day of the month - [1,31]">tm_mday</a> = day;

    <span class="keywordflow">return</span> 0;
}

<span class="comment">/*</span>
<span class="comment"> * Query time of day from user.</span>
<span class="comment"> *</span>
<span class="comment"> * Returns 0 on success, -1 otherwise.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">int</span> EnterTime(<span class="keyword">struct</span> <a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> *stm)
{
    <span class="keywordtype">int</span> hour = stm-&gt;<a name="a12"></a><a class="code" href="struct__tm.html#a39f017347ad46548a120eaf0ddf6a226" title="hours since midnight - [0,23]">tm_hour</a>;
    <span class="keywordtype">int</span> minute = stm-&gt;<a name="a13"></a><a class="code" href="struct__tm.html#ab0a4136cc3488707cc7a2c4ad3a3587b" title="minutes after the hour - [0,59]">tm_min</a>;
    <span class="keywordtype">int</span> second = stm-&gt;<a name="a14"></a><a class="code" href="struct__tm.html#a73b45a4fdb2c4c178444f16e9ad21d7b" title="seconds after the minute - [0,59]">tm_sec</a>;

    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Enter time, use 24h format HH:MM:SS&quot;</span>);
<span class="preprocessor">#ifdef USE_LINE_EDITOR</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;: &quot;</span>);
    <a class="code" href="icc_8h.html#a5998f60c4f4af322b36debdbd11d7917">sprintf</a>(edbuff, <span class="stringliteral">&quot;%02d:%02d:%02d&quot;</span>, hour, minute, second);
    <a class="code" href="group__xg_ed_line.html#ga1ee9a05187982d0d6db66a925fe2d003" title="Read a line.">EdLineRead</a>(edline, edbuff, LINE_MAXLENGTH);
    <a class="code" href="group__xg_crt_stdio.html#ga9cb8d06a3196a5f98973ae44d38a425a" title="Read formatted data from a string.">sscanf</a>(edbuff, <span class="stringliteral">&quot;%d:%d:%d&quot;</span>, &amp;hour, &amp;minute, &amp;second);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; (%02d:%02d:%02d): &quot;</span>, hour, minute, second);
    <a class="code" href="icc_8h.html#a9d178d8ab459cd19f1a1749b60af46ca">scanf</a>(<span class="stringliteral">&quot;%d:%d:%d&quot;</span>, &amp;hour, &amp;minute, &amp;second);
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> (hour &lt; 0 || hour &gt; 23) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad hour: %d is not within range 0..23\n&quot;</span>, hour);
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> (minute &lt; 0 || minute &gt; 59) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad minute: %d is not within range 0..59\n&quot;</span>, minute);
        <span class="keywordflow">return</span> -1;
    }
    <span class="keywordflow">if</span> (second &lt; 0 || second &gt; 59) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Bad second: %d is not within range 0..59\n&quot;</span>, second);
        <span class="keywordflow">return</span> -1;
    }
    stm-&gt;<a class="code" href="struct__tm.html#a39f017347ad46548a120eaf0ddf6a226" title="hours since midnight - [0,23]">tm_hour</a> = hour;
    stm-&gt;<a class="code" href="struct__tm.html#ab0a4136cc3488707cc7a2c4ad3a3587b" title="minutes after the hour - [0,59]">tm_min</a> = minute;
    stm-&gt;<a class="code" href="struct__tm.html#a73b45a4fdb2c4c178444f16e9ad21d7b" title="seconds after the minute - [0,59]">tm_sec</a> = second;

    <span class="keywordflow">return</span> 0;
}

<span class="comment">/*</span>
<span class="comment"> * Query time difference from user, specified in hours and minutes.</span>
<span class="comment"> *</span>
<span class="comment"> * &#39;init&#39; specifies the default number of seconds.</span>
<span class="comment"> *</span>
<span class="comment"> * Returns the number of seconds.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">long</span> EnterTimeDiff(<span class="keywordtype">long</span> init)
{
    <span class="keywordtype">long</span> hours;
    <span class="keywordtype">long</span> minutes;
    <span class="keywordtype">long</span> seconds;

    seconds = init;
    minutes = seconds / 60L;
    hours = minutes / 60L;
    minutes = <a name="a15"></a><a class="code" href="group__xg_crt_std_lib.html#gaeb20b44c8437544e571a3cb9bb2cc37d" title="Compute absolute value of an integer.">abs</a>(minutes % 60L);

    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Enter time difference in format HH:MM&quot;</span>);
<span class="preprocessor">#ifdef USE_LINE_EDITOR</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;: &quot;</span>);
    <a class="code" href="icc_8h.html#a5998f60c4f4af322b36debdbd11d7917">sprintf</a>(edbuff, <span class="stringliteral">&quot;%+03ld:%02ld&quot;</span>, hours, minutes);
    <a class="code" href="group__xg_ed_line.html#ga1ee9a05187982d0d6db66a925fe2d003" title="Read a line.">EdLineRead</a>(edline, edbuff, LINE_MAXLENGTH);
    <a class="code" href="group__xg_crt_stdio.html#ga9cb8d06a3196a5f98973ae44d38a425a" title="Read formatted data from a string.">sscanf</a>(edbuff, <span class="stringliteral">&quot;%ld:%ld&quot;</span>, &amp;hours, &amp;minutes);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; (%+03ld:%02ld): &quot;</span>, hours, minutes);
    <a class="code" href="icc_8h.html#a9d178d8ab459cd19f1a1749b60af46ca">scanf</a>(<span class="stringliteral">&quot;%ld:%ld&quot;</span>, &amp;hours, &amp;minutes);
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">if</span> (hours &lt; -12 || hours &gt; 12) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;\nBad hours: %ld is not within range -12..+12\n&quot;</span>, hours);
        <span class="keywordflow">return</span> init;
    }
    <span class="keywordflow">if</span> (minutes &lt; 0 || minutes &gt; 59) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;\nBad minutes: %ld is not within range 0..59\n&quot;</span>, minutes);
        <span class="keywordflow">return</span> init;
    }
    <span class="keywordflow">return</span> (hours * 60L + minutes) * 60L;
}

<span class="comment">/*</span>
<span class="comment"> * Display the elapsed seconds of the epoch.</span>
<span class="comment"> *</span>
<span class="comment"> * The value is constantly updated until the user presses a key.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> DisplaySeconds(<span class="keywordtype">void</span>)
{
    <a class="code" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> i = 0;

    <span class="keywordflow">while</span> (!<a name="a16"></a><a class="code" href="stdio_8h.html#a97e9b1fe8d4c010474637a654aad6566">kbhit</a>()) {
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; [%c] Seconds since epoch: %ld\r&quot;</span>
               , rotor[++i &amp; 3]
               , (<span class="keywordtype">long</span>) <a name="a17"></a><a class="code" href="group__xg_crt_time.html#ga26c7d1dbf93fa8c23c5effbacec91f8c" title="Get the system time.">time</a>(NULL));
        <a name="a18"></a><a class="code" href="group__xg_timer.html#gafefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep</a>(200);
    }
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
}

<span class="comment">/*</span>
<span class="comment"> * Display the coordinated universal time.</span>
<span class="comment"> *</span>
<span class="comment"> * The value is constantly updated until the user presses a key.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> DisplayZuluTime(<span class="keywordtype">void</span>)
{
    <a class="code" href="group__xg_crt_time.html#gae33b844d9ee195d9df95b93b5fb312c5" title="Serial date/time. Holds number of seconds after January 1st, 1970.">time_t</a> secs;
    <span class="keyword">struct </span><a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> *gmt;
    <a class="code" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> i = 0;

    <span class="keywordflow">while</span> (!<a class="code" href="stdio_8h.html#a97e9b1fe8d4c010474637a654aad6566">kbhit</a>()) {
        secs = <a class="code" href="group__xg_crt_time.html#ga26c7d1dbf93fa8c23c5effbacec91f8c" title="Get the system time.">time</a>(NULL);
        gmt = <a name="a19"></a><a class="code" href="group__xg_crt_time.html#ga4bf5c1b09409b70880b839f0ff9aeb9a" title="Convert a time value to a structure.">gmtime</a>(&amp;secs);
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; [%c] Universal time: &quot;</span>, rotor[++i &amp; 3]);
        PrintDateTime(gmt);
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;    \r&quot;</span>);
        <a class="code" href="group__xg_timer.html#gafefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep</a>(500);
    }
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
}

<span class="comment">/*</span>
<span class="comment"> * Display the local time.</span>
<span class="comment"> *</span>
<span class="comment"> * The value is constantly updated until the user presses a key.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> DisplayLocalTime(<span class="keywordtype">void</span>)
{
    <a class="code" href="group__xg_crt_time.html#gae33b844d9ee195d9df95b93b5fb312c5" title="Serial date/time. Holds number of seconds after January 1st, 1970.">time_t</a> tt;
    <span class="keyword">struct </span><a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> *ltm;
    <a class="code" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> i = 0;

    <span class="keywordflow">while</span> (!<a class="code" href="stdio_8h.html#a97e9b1fe8d4c010474637a654aad6566">kbhit</a>()) {
        <span class="comment">/* Get local time and print it. */</span>
        tt = <a class="code" href="group__xg_crt_time.html#ga26c7d1dbf93fa8c23c5effbacec91f8c" title="Get the system time.">time</a>(NULL);
        ltm = <a name="a20"></a><a class="code" href="group__xg_crt_time.html#ga7a9f8811ccb83dee7960cbd77dc133e9" title="Convert a time value and correct for the local time zone.">localtime</a>(&amp;tt);
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; [%c] Local time: &quot;</span>, rotor[++i &amp; 3]);
        PrintDateTime(ltm);

        <span class="comment">/* Calculate the offset from UTC in minutes. */</span>
        tt = <a name="a21"></a><a class="code" href="group__xg_crt_time.html#ga9493c776d7de0e689626895324bd2d6e" title="Defines your local timezone.">_timezone</a>;
        <span class="keywordflow">if</span> (ltm-&gt;<a name="a22"></a><a class="code" href="struct__tm.html#ad744c69f2e5c9dbfb39e52bd3744d913" title="daylight savings time flag">tm_isdst</a> &gt; 0) {
            tt += <a name="a23"></a><a class="code" href="group__xg_crt_time.html#ga8ab2ad3557476430d80335c8df4ff374" title="Difference between standard and daylight savings time in seconds.">_dstbias</a>;
        }
        tt /= -60L;

        <span class="comment">/* Print UTC offset in format HH:MM. */</span>
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; UTC%+03ld:%02ld   \r&quot;</span>, tt / 60L, <a class="code" href="group__xg_crt_std_lib.html#gaeb20b44c8437544e571a3cb9bb2cc37d" title="Compute absolute value of an integer.">abs</a>(tt) % 60L);
        <a class="code" href="group__xg_timer.html#gafefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep</a>(200);
    }
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
}

<span class="comment">/*</span>
<span class="comment"> * Display system up time.</span>
<span class="comment"> *</span>
<span class="comment"> * The value is constantly updated until the user presses a key.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> DisplayUpTime(<span class="keywordtype">void</span>)
{
    <a class="code" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> hours;
    <a class="code" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> minutes;
    <a class="code" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> seconds;
    <a class="code" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> i = 0;

    <span class="keywordflow">while</span> (!<a class="code" href="stdio_8h.html#a97e9b1fe8d4c010474637a654aad6566">kbhit</a>()) {
        seconds = <a name="a24"></a><a class="code" href="group__xg_timer.html#ga8bc858a1ca645b9e0cf9d03d7c9adfb3" title="Return the seconds counter value.">NutGetSeconds</a>();
        minutes = seconds / 60UL;
        hours = minutes / 60UL;
        minutes %= 60UL;
        seconds %= 60UL;
        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot; [%c] System is running %lu hours&quot;</span>
               <span class="stringliteral">&quot;, %lu minutes and %lu seconds   \r&quot;</span>
               , rotor[++i &amp; 3], hours, minutes, seconds);
        <a class="code" href="group__xg_timer.html#gafefcf81d05019a8134b49fa44d8c114a" title="Temporarily suspends the current thread.">NutSleep</a>(500);
    }
    <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);
}

<span class="comment">/*</span>
<span class="comment"> * Display the week day of a queried calendar date.</span>
<span class="comment"> *</span>
<span class="comment"> * mktime() updates the structure members tm_yday and tm_wday.</span>
<span class="comment"> * This can be used to determine the week day name of any given</span>
<span class="comment"> * date.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> CalcWeekDay(<span class="keywordtype">void</span>)
{
    <span class="keyword">struct </span><a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> date;
    <a class="code" href="group__xg_crt_time.html#gae33b844d9ee195d9df95b93b5fb312c5" title="Serial date/time. Holds number of seconds after January 1st, 1970.">time_t</a> secs;

    <span class="comment">/* Use current local time as default. */</span>
    <a class="code" href="group__xg_crt_time.html#ga26c7d1dbf93fa8c23c5effbacec91f8c" title="Get the system time.">time</a>(&amp;secs);
    <a name="a25"></a><a class="code" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e">memcpy</a>(&amp;date, <a class="code" href="group__xg_crt_time.html#ga7a9f8811ccb83dee7960cbd77dc133e9" title="Convert a time value and correct for the local time zone.">localtime</a>(&amp;secs), <span class="keyword">sizeof</span>(date));
    <span class="comment">/* Query date and print week day name if we got a valid entry. */</span>
    <span class="keywordflow">if</span> (EnterDate(&amp;date) == 0) {
        <a name="a26"></a><a class="code" href="group__xg_crt_time.html#ga60ebe794537631d5c944d2580577068a" title="Convert the local time to a calendar value.">mktime</a>(&amp;date);
        <a name="a27"></a><a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(weekday_name[date.tm_wday]);
    }
}

<span class="comment">/*</span>
<span class="comment"> * Query user for a new time zone offset.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> SetTimeZone(<span class="keywordtype">void</span>)
{
    <span class="comment">/* Nut/OS uses a global variable to store the current TZ offset. */</span>
    <a class="code" href="group__xg_crt_time.html#ga9493c776d7de0e689626895324bd2d6e" title="Defines your local timezone.">_timezone</a> = EnterTimeDiff(<a class="code" href="group__xg_crt_time.html#ga9493c776d7de0e689626895324bd2d6e" title="Defines your local timezone.">_timezone</a>);
}

<span class="comment">/*</span>
<span class="comment"> * Query user for a new system time.</span>
<span class="comment"> */</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> SetLocalTime(<span class="keywordtype">void</span>)
{
    <span class="keyword">struct </span><a class="code" href="struct__tm.html" title="structure to store a date/time value.">_tm</a> ltm;
    <a class="code" href="group__xg_crt_time.html#gae33b844d9ee195d9df95b93b5fb312c5" title="Serial date/time. Holds number of seconds after January 1st, 1970.">time_t</a> now;

    <span class="comment">/* Use current local time as default. */</span>
    <a class="code" href="group__xg_crt_time.html#ga26c7d1dbf93fa8c23c5effbacec91f8c" title="Get the system time.">time</a>(&amp;now);
    <a class="code" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e">memcpy</a>(&amp;ltm, <a class="code" href="group__xg_crt_time.html#ga7a9f8811ccb83dee7960cbd77dc133e9" title="Convert a time value and correct for the local time zone.">localtime</a>(&amp;now), <span class="keyword">sizeof</span>(ltm));

    <span class="comment">/* Query date and time. */</span>
    <span class="keywordflow">if</span> (EnterDate(&amp;ltm) == 0 &amp;&amp; EnterTime(&amp;ltm) == 0) {
        <span class="comment">/* Let mktime determine whether DST is in effect. */</span>
        ltm.<a class="code" href="struct__tm.html#ad744c69f2e5c9dbfb39e52bd3744d913" title="daylight savings time flag">tm_isdst</a> = -1;
        <span class="comment">/* mktime expects local time and returns seconds since the epoch. */</span>
        now = <a class="code" href="group__xg_crt_time.html#ga60ebe794537631d5c944d2580577068a" title="Convert the local time to a calendar value.">mktime</a>(&amp;ltm);
        <span class="comment">/* stime expects seconds since the epoch. */</span>
        <a name="a28"></a><a class="code" href="group__xg_crt_time.html#ga1e9a05d0b48dcf984238438fa8efd2d8" title="Set the system time.">stime</a>(&amp;now);
    }
}

<span class="comment">/*</span>
<span class="comment"> * Application entry.</span>
<span class="comment"> */</span>
<span class="keywordtype">int</span> <a name="a29"></a><a class="code" href="arm_8h.html#aa4e97f3782107649d3e4eb3875090b3a">main</a>(<span class="keywordtype">void</span>)
{
    <a class="code" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> baud = 115200;
    <span class="keywordtype">int</span> cmd;

    <span class="comment">/* Use UART device for stdin and stdout. */</span>
    <a name="a30"></a><a class="code" href="group__xg_device.html#ga0d73e3153bf9f210194bd862d9b91c61" title="Register and initialize a device.">NutRegisterDevice</a>(&amp;<a name="a31"></a><a class="code" href="board_8h.html#ac2ef4e8d5bb559c608f6a795a3a3496e">DEV_CONSOLE</a>, 0, 0);
    <a name="a32"></a><a class="code" href="group__xg_crt_stdio.html#ga76767cc4b7500920d83e53caad264189" title="Reassign a stream.">freopen</a>(<a name="a33"></a><a class="code" href="board_8h.html#aa4a1e62a728655728db6adcd38c6855e">DEV_CONSOLE_NAME</a>, <span class="stringliteral">&quot;w&quot;</span>, <a name="a34"></a><a class="code" href="group__xg_crt_stdio.html#ga0c0ef221f95f64e8632451312fd18cc8" title="Standard output stream.">stdout</a>);
    <a class="code" href="group__xg_crt_stdio.html#ga76767cc4b7500920d83e53caad264189" title="Reassign a stream.">freopen</a>(<a class="code" href="board_8h.html#aa4a1e62a728655728db6adcd38c6855e">DEV_CONSOLE_NAME</a>, <span class="stringliteral">&quot;r&quot;</span>, <a name="a35"></a><a class="code" href="group__xg_crt_stdio.html#gaaca70138f0cb63ddb026921afc635179" title="Standard input stream.">stdin</a>);
    <a name="a36"></a><a class="code" href="group__xg_crt_lowio.html#ga6b356746f1f26fb46f2afe4357ab3534" title="Perform device specific control functions.">_ioctl</a>(<a name="a37"></a><a class="code" href="group__xg_crt_stdio.html#gab5ec3b6c064aca1b990c342a82e64aae" title="Get the file descriptor associated with a stream.">_fileno</a>(<a class="code" href="group__xg_crt_stdio.html#ga0c0ef221f95f64e8632451312fd18cc8" title="Standard output stream.">stdout</a>), <a name="a38"></a><a class="code" href="group__xg_u_a_r_t_i_o_c_t_l.html#ga2f1b5053775ad3be83ae499273a04de8" title="UART _ioctl() command code to set the line speed.">UART_SETSPEED</a>, &amp;baud);
    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;\n\nCalendar Time %s running on Nut/OS %s\n&quot;</span>
           , version, <a name="a39"></a><a class="code" href="group__xg_nut_version.html#gafc224f8837d06742cb90826cdf1dea12" title="Return Nut/OS version string.">NutVersionString</a>());

<span class="preprocessor">#ifdef USE_LINE_EDITOR</span>
<span class="preprocessor"></span>    <span class="comment">/* Open line editor, if configured. */</span>
    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Opening line editor...&quot;</span>);
    edline = <a name="a40"></a><a class="code" href="group__xg_ed_line.html#ga8c3b149d57d0e53ed4485054ae794223" title="Open a line editor.">EdLineOpen</a>(<a name="a41"></a><a class="code" href="group__xg_ed_line.html#gaa96d20c55170be730dc77ab0acdfae39" title="Enables echoing of input characters.">EDIT_MODE_ECHO</a>);
    <span class="keywordflow">if</span> (edline) {
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;OK&quot;</span>);
    } <span class="keywordflow">else</span> {
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;failed&quot;</span>);
    }
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;Note: Enable local echo!&quot;</span>);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#if USE_TIME_ZONE</span>
<span class="preprocessor"></span>    <a class="code" href="group__xg_crt_time.html#ga9493c776d7de0e689626895324bd2d6e" title="Defines your local timezone.">_timezone</a> = USE_TIME_ZONE;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifdef RTC_CHIP</span>
<span class="preprocessor"></span>    <span class="comment">/* Register and query hardware RTC, if available. */</span>
    <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;Registering RTC hardware...&quot;</span>);
    <span class="keywordflow">if</span> (<a name="a42"></a><a class="code" href="rtc_8h.html#ac47307585fae3e6632d0253eb493c0f4" title="Register a specified RTC.">NutRegisterRtc</a>(&amp;RTC_CHIP)) {
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;failed&quot;</span>);
    } <span class="keywordflow">else</span> {
        <a class="code" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> rtc_stat;

        <a name="a43"></a><a class="code" href="rtc_8h.html#a4ef299e140a7550b55bd50dbeb34c985" title="Query status flags from the registered RTC.">NutRtcGetStatus</a>(&amp;rtc_stat);
        <span class="keywordflow">if</span> (rtc_stat &amp; <a name="a44"></a><a class="code" href="rtc_8h.html#aaeb7283740ec89902dbc08d02b0850f5">RTC_STATUS_PF</a>) {
            <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;power failure&quot;</span>);
        } <span class="keywordflow">else</span> {
            <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;OK&quot;</span>);
        }
    }
<span class="preprocessor">#elif USE_BUILD_TIME</span>
<span class="preprocessor"></span>    {
        <span class="comment">/* Initially use the compile date and time. */</span>
        <a class="code" href="group__xg_crt_time.html#gae33b844d9ee195d9df95b93b5fb312c5" title="Serial date/time. Holds number of seconds after January 1st, 1970.">time_t</a> now = <a name="a45"></a><a class="code" href="rfctime_8h.html#ab7483c1b587320e72ccb2f307709c8c2" title="Parse RFC date and time string.">RfcTimeParse</a>(<span class="stringliteral">&quot;Unk, &quot;</span> __DATE__ <span class="stringliteral">&quot; &quot;</span> __TIME__);
        <a class="code" href="group__xg_crt_time.html#ga1e9a05d0b48dcf984238438fa8efd2d8" title="Set the system time.">stime</a>(&amp;now);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;Built &quot;</span> __DATE__ <span class="stringliteral">&quot; &quot;</span> __TIME__);
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
    <span class="keywordflow">for</span> (;;) {
        <span class="comment">/* Print command menu. */</span>
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;\n  0 - Display seconds counter&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  1 - Display universal time&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  2 - Display local time&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  3 - Display system uptime&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  C - Calculate weekday&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  S - Set local time&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  Y - Toggle DST calculation&quot;</span>);
        <a class="code" href="icc_8h.html#a80022cbe72a24b85437c2326543509be">puts</a>(<span class="stringliteral">&quot;  Z - Set timezone&quot;</span>);

        <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;What is thy bidding, my master? &quot;</span>);

        <span class="comment">/* Flush input buffer. */</span>
        <span class="keywordflow">while</span> (<a class="code" href="stdio_8h.html#a97e9b1fe8d4c010474637a654aad6566">kbhit</a>()) {
            cmd = <a name="a46"></a><a class="code" href="group__xg_crt_stdio.html#ga3e29caa20f7cffe18f410f01278905a8" title="Read a character from a standard input.">getchar</a>();
        }

        <span class="comment">/* Get the next command. */</span>
        cmd = <a class="code" href="group__xg_crt_stdio.html#ga3e29caa20f7cffe18f410f01278905a8" title="Read a character from a standard input.">getchar</a>();
        <a class="code" href="group__xg_crt_stdio.html#gaf4de2514b7778805db3815e8dd6cf09a" title="Write a character to standard output.">putchar</a>(<span class="charliteral">&#39;\n&#39;</span>);

        <span class="comment">/* Process the command. */</span>
        <span class="keywordflow">switch</span> (cmd) {
        <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>:
            DisplaySeconds();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:
            DisplayZuluTime();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;2&#39;</span>:
            DisplayLocalTime();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;3&#39;</span>:
            DisplayUpTime();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:
        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
            CalcWeekDay();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:
        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
            SetLocalTime();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:
        <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:
            <span class="comment">/* Nut/OS uses a global variable to enable/disable DST. </span>
<span class="comment">               Toggle the current status and display the result. */</span>
            <a name="a47"></a><a class="code" href="group__xg_crt_time.html#ga2bb3d0de4c753758209b935de23f09ae" title="Used to control daylight conversions.">_daylight</a> = <a class="code" href="group__xg_crt_time.html#ga2bb3d0de4c753758209b935de23f09ae" title="Used to control daylight conversions.">_daylight</a> == 0;
            <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;DST calculation %sabled\n&quot;</span>, <a class="code" href="group__xg_crt_time.html#ga2bb3d0de4c753758209b935de23f09ae" title="Used to control daylight conversions.">_daylight</a> ? <span class="stringliteral">&quot;en&quot;</span> : <span class="stringliteral">&quot;dis&quot;</span>);
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>:
        <span class="keywordflow">case</span> <span class="charliteral">&#39;z&#39;</span>:
            SetTimeZone();
            <span class="keywordflow">break</span>;
        }
    }
    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
