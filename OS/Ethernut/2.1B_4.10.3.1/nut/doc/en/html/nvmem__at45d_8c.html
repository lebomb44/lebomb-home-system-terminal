<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: dev/nvmem_at45d.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('nvmem__at45d_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nvmem_at45d.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Non-volatile memory support using Atmel AT45 serial DataFlash memory chips.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="cfg_2eeprom_8h_source.html">cfg/eeprom.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="memory_8h_source.html">cfg/memory.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="board_8h_source.html">dev/board.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="spi__at45d_8h_source.html">dev/spi_at45d.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="nutdebug_8h_source.html">sys/nutdebug.h</a>&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="memdebug_8h_source.html">memdebug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="nvmem__at45d_8h_source.html">dev/nvmem_at45d.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for nvmem_at45d.c:</div>
<div class="dyncontent">
<div class="center"><img src="nvmem__at45d_8c__incl.png" border="0" usemap="#dev_2nvmem__at45d_8c" alt=""/></div>
<map name="dev_2nvmem__at45d_8c" id="dev_2nvmem__at45d_8c">
<area shape="rect" id="node3" href="cfg_2eeprom_8h.html" title="cfg/eeprom.h" alt="" coords="242,81,336,106"/><area shape="rect" id="node5" href="memory_8h.html" title="Default memory layout." alt="" coords="865,379,961,405"/><area shape="rect" id="node7" href="board_8h.html" title="dev/board.h" alt="" coords="361,81,447,106"/><area shape="rect" id="node35" href="spi__at45d_8h.html" title="AT45D." alt="" coords="585,81,695,106"/><area shape="rect" id="node58" href="nutdebug_8h.html" title="sys/nutdebug.h" alt="" coords="1000,305,1107,330"/><area shape="rect" id="node66" href="memdebug_8h.html" title="memdebug.h" alt="" coords="785,81,881,106"/><area shape="rect" id="node72" href="nvmem__at45d_8h.html" title="dev/nvmem_at45d.h" alt="" coords="1088,230,1221,255"/><area shape="rect" id="node9" href="arch_8h.html" title="cfg/arch.h" alt="" coords="5,305,80,330"/><area shape="rect" id="node11" href="cfg_2uart_8h.html" title="UART configuration." alt="" coords="211,155,283,181"/><area shape="rect" id="node13" href="debug_8h.html" title="Debug device definitions." alt="" coords="307,155,396,181"/><area shape="rect" id="node32" href="null__ether_8h.html" title="dev/null_ether.h" alt="" coords="443,230,552,255"/><area shape="rect" id="node16" href="device_8h.html" title="Nut/OS device definitions." alt="" coords="406,305,495,330"/><area shape="rect" id="node26" href="stdint_8h.html" title="stdint.h" alt="" coords="370,379,432,405"/><area shape="rect" id="node28" href="dev_2uart_8h.html" title="UART I/O function prototypes." alt="" coords="293,230,368,255"/><area shape="rect" id="node18" href="file_8h.html" title="sys/file.h" alt="" coords="651,379,721,405"/><area shape="rect" id="node20" href="types_8h.html" title="Nut/OS type declarations." alt="" coords="857,454,940,479"/><area shape="rect" id="node22" href="compiler_8h.html" title="compiler.h" alt="" coords="765,529,845,554"/><area shape="rect" id="node38" href="spibus_8h.html" title="SPI bus declarations." alt="" coords="594,155,685,181"/><area shape="rect" id="node40" href="dev_2irqreg_8h.html" title="Interrupt management definitions." alt="" coords="182,230,268,255"/><area shape="rect" id="node50" href="event_8h.html" title="Event management definitions." alt="" coords="677,230,760,255"/><area shape="rect" id="node45" href="irqstack_8h.html" title="dev/irqstack.h" alt="" coords="105,305,201,330"/><area shape="rect" id="node47" href="dev_8h.html" title="cfg/dev.h" alt="" coords="118,379,188,405"/><area shape="rect" id="node52" href="thread_8h.html" title="Thread management definitions." alt="" coords="674,305,763,330"/></map>
</div>
</div>
<p><a href="nvmem__at45d_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvmem__at45d_8c.html#ad70b1387cb350d5a438b9fd287b3eff9">SpiAt45dConfigSize</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get size of configuration area.  <a href="#ad70b1387cb350d5a438b9fd287b3eff9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvmem__at45d_8c.html#a4dfe8d76a63e3f0379039bbcf74e7760">SpiAt45dConfigRead</a> (size_t pos, void *data, size_t len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Load configuration parameters from flash memory.  <a href="#a4dfe8d76a63e3f0379039bbcf74e7760"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvmem__at45d_8c.html#af4070fbe96bc548a132c126be392c6ac">SpiAt45dConfigWrite</a> (size_t pos, CONST void *data, size_t len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Store configuration parameters in flash memory.  <a href="#af4070fbe96bc548a132c126be392c6ac"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Non-volatile memory support using Atmel AT45 serial DataFlash memory chips. </p>
<div class="fragment"><pre class="fragment">
 * $Id: nvmem_at45d.c 3560 2011-08-16 10:53:31Z haraldkipp $
 * </pre></div> 
<p>Definition in file <a class="el" href="nvmem__at45d_8c_source.html">nvmem_at45d.c</a>.</p>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="ad70b1387cb350d5a438b9fd287b3eff9"></a><!-- doxytag: member="nvmem_at45d.c::SpiAt45dConfigSize" ref="ad70b1387cb350d5a438b9fd287b3eff9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t SpiAt45dConfigSize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get size of configuration area. </p>
<p>A part of the DataFlash may be used to store configuration parameters, like the network interface MAC address, the local hostname etc. The size of this area may be configured by defining NUT_CONFIG_AT45D_SIZE. Otherwise one full page is used.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes available for configuration data. In case of an error, 0 is returned. </dd></dl>

<p>Definition at line <a class="el" href="nvmem__at45d_8c_source.html#l00134">134</a> of file <a class="el" href="nvmem__at45d_8c_source.html">nvmem_at45d.c</a>.</p>

<p>References <a class="el" href="spi__at45d_8c_source.html#l00446">SpiAt45dPageSize()</a>.</p>

<p>Referenced by <a class="el" href="meminfo_8c_source.html#l00063">ShowHardwareConfiguration()</a>, <a class="el" href="nvmem__at45d_8c_source.html#l00157">SpiAt45dConfigRead()</a>, and <a class="el" href="nvmem__at45d_8c_source.html#l00187">SpiAt45dConfigWrite()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="nvmem__at45d_8c_ad70b1387cb350d5a438b9fd287b3eff9_cgraph.png" border="0" usemap="#nvmem__at45d_8c_ad70b1387cb350d5a438b9fd287b3eff9_cgraph" alt=""/></div>
<map name="nvmem__at45d_8c_ad70b1387cb350d5a438b9fd287b3eff9_cgraph" id="nvmem__at45d_8c_ad70b1387cb350d5a438b9fd287b3eff9_cgraph">
<area shape="rect" id="node3" href="spi__at45d_8h.html#aa0c27889cf7245d2266c92c32bd0fdee" title="Return the page size." alt="" coords="184,5,307,30"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4dfe8d76a63e3f0379039bbcf74e7760"></a><!-- doxytag: member="nvmem_at45d.c::SpiAt45dConfigRead" ref="a4dfe8d76a63e3f0379039bbcf74e7760" args="(size_t pos, void *data, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dConfigRead </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Load configuration parameters from flash memory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>Start location within configuration sector. </td></tr>
    <tr><td class="paramname">data</td><td>Points to a buffer that receives the contents. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="nvmem__at45d_8c_source.html#l00157">157</a> of file <a class="el" href="nvmem__at45d_8c_source.html">nvmem_at45d.c</a>.</p>

<p>References <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="malloc_8c_source.html#l00064">malloc()</a>, <a class="el" href="memcpy_8c_source.html#l00114">memcpy()</a>, <a class="el" href="nvmem__at45d_8c_source.html#l00134">SpiAt45dConfigSize()</a>, and <a class="el" href="spi__at45d_8c_source.html#l00320">SpiAt45dPageRead()</a>.</p>

<p>Referenced by <a class="el" href="nvmem_8c_source.html#l00107">NutNvMemLoad()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="nvmem__at45d_8c_a4dfe8d76a63e3f0379039bbcf74e7760_cgraph.png" border="0" usemap="#nvmem__at45d_8c_a4dfe8d76a63e3f0379039bbcf74e7760_cgraph" alt=""/></div>
<map name="nvmem__at45d_8c_a4dfe8d76a63e3f0379039bbcf74e7760_cgraph" id="nvmem__at45d_8c_a4dfe8d76a63e3f0379039bbcf74e7760_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="236,5,279,30"/><area shape="rect" id="node5" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="228,54,287,79"/><area shape="rect" id="node7" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="223,103,292,129"/><area shape="rect" id="node9" href="nvmem__at45d_8h.html#ad70b1387cb350d5a438b9fd287b3eff9" title="Get size of configuration area." alt="" coords="192,153,323,178"/><area shape="rect" id="node13" href="spi__at45d_8h.html#a25cb2b6fad5064288ec0d52a86a9421d" title="Read data from DataFlash memory." alt="" coords="192,202,323,227"/><area shape="rect" id="node11" href="spi__at45d_8h.html#aa0c27889cf7245d2266c92c32bd0fdee" title="Return the page size." alt="" coords="371,153,493,178"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af4070fbe96bc548a132c126be392c6ac"></a><!-- doxytag: member="nvmem_at45d.c::SpiAt45dConfigWrite" ref="af4070fbe96bc548a132c126be392c6ac" args="(size_t pos, CONST void *data, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dConfigWrite </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Store configuration parameters in flash memory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>Start location within configuration sector. </td></tr>
    <tr><td class="paramname">data</td><td>Points to a buffer that contains the bytes to store. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to store.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="nvmem__at45d_8c_source.html#l00187">187</a> of file <a class="el" href="nvmem__at45d_8c_source.html">nvmem_at45d.c</a>.</p>

<p>References <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="malloc_8c_source.html#l00064">malloc()</a>, <a class="el" href="memcmp_8c_source.html#l00091">memcmp()</a>, <a class="el" href="memcpy_8c_source.html#l00114">memcpy()</a>, <a class="el" href="nvmem__at45d_8c_source.html#l00134">SpiAt45dConfigSize()</a>, <a class="el" href="spi__at45d_8c_source.html#l00320">SpiAt45dPageRead()</a>, <a class="el" href="spi__at45d_8c_source.html#l00446">SpiAt45dPageSize()</a>, <a class="el" href="spi__at45d_8c_source.html#l00360">SpiAt45dPageWrite()</a>, and <a class="el" href="memcpy_8c_source.html#l00106">wsize</a>.</p>

<p>Referenced by <a class="el" href="nvmem_8c_source.html#l00140">NutNvMemSave()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="nvmem__at45d_8c_af4070fbe96bc548a132c126be392c6ac_cgraph.png" border="0" usemap="#nvmem__at45d_8c_af4070fbe96bc548a132c126be392c6ac_cgraph" alt=""/></div>
<map name="nvmem__at45d_8c_af4070fbe96bc548a132c126be392c6ac_cgraph" id="nvmem__at45d_8c_af4070fbe96bc548a132c126be392c6ac_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="233,5,276,30"/><area shape="rect" id="node5" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="225,54,284,79"/><area shape="rect" id="node7" href="group__xg_crt_string.html#ga135578e5537357b84cf147e3b352902d" title="Compare memory regions." alt="" coords="217,103,292,129"/><area shape="rect" id="node9" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="220,153,289,178"/><area shape="rect" id="node11" href="nvmem__at45d_8h.html#ad70b1387cb350d5a438b9fd287b3eff9" title="Get size of configuration area." alt="" coords="189,202,320,227"/><area shape="rect" id="node13" href="spi__at45d_8h.html#aa0c27889cf7245d2266c92c32bd0fdee" title="Return the page size." alt="" coords="368,227,491,253"/><area shape="rect" id="node15" href="spi__at45d_8h.html#a25cb2b6fad5064288ec0d52a86a9421d" title="Read data from DataFlash memory." alt="" coords="189,303,320,329"/><area shape="rect" id="node18" href="spi__at45d_8h.html#a7363f4646087da35b082f2bc61e5948e" title="Write data to DataFlash memory." alt="" coords="191,353,319,378"/></map>
</div>
</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="nvmem__at45d_8c.html">nvmem_at45d.c</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
