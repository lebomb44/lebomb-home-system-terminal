<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: dev/spi_at45d.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('spi__at45d_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">spi_at45d.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Routines for Atmel AT45 serial DataFlash memory chips.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="os_8h_source.html">cfg/os.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="memory_8h_source.html">cfg/memory.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="blockdev_8h_source.html">dev/blockdev.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="nutdebug_8h_source.html">sys/nutdebug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="sys_2timer_8h_source.html">sys/timer.h</a>&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="at45d_8h_source.html">dev/at45d.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="spi__at45d_8h_source.html">dev/spi_at45d.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for spi_at45d.c:</div>
<div class="dyncontent">
<div class="center"><img src="spi__at45d_8c__incl.png" border="0" usemap="#dev_2spi__at45d_8c" alt=""/></div>
<map name="dev_2spi__at45d_8c" id="dev_2spi__at45d_8c">
<area shape="rect" id="node3" href="os_8h.html" title="cfg/os.h" alt="" coords="5,81,69,106"/><area shape="rect" id="node5" href="memory_8h.html" title="Default memory layout." alt="" coords="76,379,172,405"/><area shape="rect" id="node7" href="blockdev_8h.html" title="Block device driver definitions." alt="" coords="221,230,323,255"/><area shape="rect" id="node24" href="nutdebug_8h.html" title="sys/nutdebug.h" alt="" coords="15,305,121,330"/><area shape="rect" id="node28" href="sys_2timer_8h.html" title="Timer management definitions." alt="" coords="699,230,781,255"/><area shape="rect" id="node37" href="at45d_8h.html" title="AT45D DataFlash defines." alt="" coords="1061,305,1147,330"/><area shape="rect" id="node41" href="spi__at45d_8h.html" title="AT45D." alt="" coords="309,81,419,106"/><area shape="rect" id="node9" href="types_8h.html" title="Nut/OS type declarations." alt="" coords="277,454,360,479"/><area shape="rect" id="node15" href="stdint_8h.html" title="stdint.h" alt="" coords="658,379,720,405"/><area shape="rect" id="node17" href="device_8h.html" title="Nut/OS device definitions." alt="" coords="463,305,552,330"/><area shape="rect" id="node19" href="file_8h.html" title="sys/file.h" alt="" coords="247,379,317,405"/><area shape="rect" id="node11" href="compiler_8h.html" title="compiler.h" alt="" coords="367,529,447,554"/><area shape="rect" id="node31" href="arch_2timer_8h.html" title="arch/timer.h" alt="" coords="899,305,985,330"/><area shape="rect" id="node44" href="spibus_8h.html" title="SPI bus declarations." alt="" coords="439,155,531,181"/><area shape="rect" id="node46" href="dev_2irqreg_8h.html" title="Interrupt management definitions." alt="" coords="571,230,657,255"/><area shape="rect" id="node57" href="event_8h.html" title="Event management definitions." alt="" coords="401,230,484,255"/><area shape="rect" id="node48" href="arch_8h.html" title="cfg/arch.h" alt="" coords="577,305,652,330"/><area shape="rect" id="node52" href="irqstack_8h.html" title="dev/irqstack.h" alt="" coords="778,305,875,330"/><area shape="rect" id="node54" href="dev_8h.html" title="cfg/dev.h" alt="" coords="791,379,861,405"/><area shape="rect" id="node59" href="thread_8h.html" title="Thread management definitions." alt="" coords="298,305,387,330"/></map>
</div>
</div>
<p><a href="spi__at45d_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a9606b54062f269d39e4fc8350c68471e">AT45_WRITE_POLLS</a>&#160;&#160;&#160;1000</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a040125696e7264e7592f88220802e4a2">SpiAt45dCommand</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> op, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> parm, int oplen, CONST void *txbuf, void *rxbuf, int xlen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send DataFlash command.  <a href="#a040125696e7264e7592f88220802e4a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#ae1d03f2c983832328f1c9abb64442ba0">SpiAt45dStatus</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the status of the DataFlash.  <a href="#ae1d03f2c983832328f1c9abb64442ba0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#af8533b6e6328d02e9f50a6bf56410624">SpiAt45dWaitReady</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> tmo, int poll)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until DataFlash memory cycle finished.  <a href="#af8533b6e6328d02e9f50a6bf56410624"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a7d428e8797fa4c40d2f40d6abc7065b1">SpiAt45dPageErase</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> pgn)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase specified DataFlash page.  <a href="#a7d428e8797fa4c40d2f40d6abc7065b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a019516018349fe5f0ffab6ca98494025">SpiAt45dChipErase</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase all DataFlash pages.  <a href="#a019516018349fe5f0ffab6ca98494025"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a2de83058ef84bb3361b18313eda4e738">SpiAt45dInit</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the DataFlash device.  <a href="#a2de83058ef84bb3361b18313eda4e738"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a25cb2b6fad5064288ec0d52a86a9421d">SpiAt45dPageRead</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> pgn, void *data, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read data from DataFlash memory.  <a href="#a25cb2b6fad5064288ec0d52a86a9421d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a7363f4646087da35b082f2bc61e5948e">SpiAt45dPageWrite</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> pgn, CONST void *data, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data to DataFlash memory.  <a href="#a7363f4646087da35b082f2bc61e5948e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a98cec9a103ede98743d6ff9a20c07a9f">SpiAt45dPageWrite_P</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> pgn, PGM_P data, int len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#a511e65d18ee1e3223f5d077f9db35ace">SpiAt45dPages</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of pages.  <a href="#a511e65d18ee1e3223f5d077f9db35ace"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#aa0c27889cf7245d2266c92c32bd0fdee">SpiAt45dPageSize</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the page size.  <a href="#aa0c27889cf7245d2266c92c32bd0fdee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi__at45d_8c.html#ab4c9fa59e861034fee22f78c0d1b2185">SpiAt45dIOCtl</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, int req, void *conf)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform block I/O device control functions.  <a href="#ab4c9fa59e861034fee22f78c0d1b2185"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Routines for Atmel AT45 serial DataFlash memory chips. </p>
<div class="fragment"><pre class="fragment">
 * $Id: spi_at45d.c 3653 2011-11-14 15:20:31Z haraldkipp $
 * </pre></div> 
<p>Definition in file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a9606b54062f269d39e4fc8350c68471e"></a><!-- doxytag: member="spi_at45d.c::AT45_WRITE_POLLS" ref="a9606b54062f269d39e4fc8350c68471e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AT45_WRITE_POLLS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00059">59</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>Referenced by <a class="el" href="spi__at45d_8c_source.html#l00360">SpiAt45dPageWrite()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a040125696e7264e7592f88220802e4a2"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dCommand" ref="a040125696e7264e7592f88220802e4a2" args="(NUTDEVICE *dev, uint8_t op, uint32_t parm, int oplen, CONST void *txbuf, void *rxbuf, int xlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>parm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>oplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>txbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>rxbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send DataFlash command. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the DataFlash device. </td></tr>
    <tr><td class="paramname">op</td><td>Command operation code. </td></tr>
    <tr><td class="paramname">parm</td><td>Optional command parameter. </td></tr>
    <tr><td class="paramname">oplen</td><td>Command length. </td></tr>
    <tr><td class="paramname">txbuf</td><td>Pointer to the transmit data buffer, may be set to NULL. </td></tr>
    <tr><td class="paramname">rxbuf</td><td>Pointer to the receive data buffer, may be set to NULL. </td></tr>
    <tr><td class="paramname">xlen</td><td>Number of byte to receive and/or transmit. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00197">197</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="ae1d03f2c983832328f1c9abb64442ba0"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dStatus" ref="ae1d03f2c983832328f1c9abb64442ba0" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> SpiAt45dStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Query the status of the DataFlash. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the Flash device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00210">210</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="af8533b6e6328d02e9f50a6bf56410624"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dWaitReady" ref="af8533b6e6328d02e9f50a6bf56410624" args="(NUTDEVICE *dev, uint32_t tmo, int poll)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dWaitReady </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>tmo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>poll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wait until DataFlash memory cycle finished. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the DataFlash device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00223">223</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="a7d428e8797fa4c40d2f40d6abc7065b1"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPageErase" ref="a7d428e8797fa4c40d2f40d6abc7065b1" args="(NUTDEVICE *dev, uint32_t pgn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dPageErase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pgn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Erase specified DataFlash page. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the registered DataFlash device. </td></tr>
    <tr><td class="paramname">pgn</td><td>Page number to erase, starting at 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 in case of an error. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00237">237</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, <a class="el" href="at45d_8h_source.html#l00079">DFCMD_PAGE_ERASE</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="a019516018349fe5f0ffab6ca98494025"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dChipErase" ref="a019516018349fe5f0ffab6ca98494025" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dChipErase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Erase all DataFlash pages. </p>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00259">259</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2de83058ef84bb3361b18313eda4e738"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dInit" ref="a2de83058ef84bb3361b18313eda4e738" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the DataFlash device. </p>
<p>This routine determines the DataFlash type. It is internally called by Nut/OS during device registration.</p>
<p>The driver framework may call this function more than once.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the DataFlash device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success or -1 if no valid DataFlash was found. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00276">276</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="spi__at45d__info_8c_source.html#l00052">at45d_info</a>, <a class="el" href="spi__at45d__info_8c_source.html#l00072">at45d_known_types</a>, <a class="el" href="at45d_8h_source.html#l00161">AT45D_STATUS_DENSITY</a>, <a class="el" href="at45d_8h_source.html#l00165">AT45D_STATUS_PAGE_SIZE</a>, <a class="el" href="blockdev_8h_source.html#l00128">_NUTBLOCKIO::blkio_blk_cnt</a>, <a class="el" href="blockdev_8h_source.html#l00133">_NUTBLOCKIO::blkio_blk_siz</a>, <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="a25cb2b6fad5064288ec0d52a86a9421d"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPageRead" ref="a25cb2b6fad5064288ec0d52a86a9421d" args="(NUTDEVICE *dev, uint32_t pgn, void *data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dPageRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pgn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read data from DataFlash memory. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the registered DataFlash device. </td></tr>
    <tr><td class="paramname">pgn</td><td>Page number to read, starting at 0. </td></tr>
    <tr><td class="paramname">data</td><td>Points to a buffer that receives the data. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes actually read. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00320">320</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, <a class="el" href="at45d_8h_source.html#l00148">DFCMD_CONT_READ</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

<p>Referenced by <a class="el" href="nvmem__at45d_8c_source.html#l00157">SpiAt45dConfigRead()</a>, and <a class="el" href="nvmem__at45d_8c_source.html#l00187">SpiAt45dConfigWrite()</a>.</p>

</div>
</div>
<a class="anchor" id="a7363f4646087da35b082f2bc61e5948e"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPageWrite" ref="a7363f4646087da35b082f2bc61e5948e" args="(NUTDEVICE *dev, uint32_t pgn, CONST void *data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dPageWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pgn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write data to DataFlash memory. </p>
<p>Each page will be automatically erased before writing the data. If the last page is not completely filled with new data, the contents of remaining bytes at the end of the page is undetermined.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the registered DataFlash device. </td></tr>
    <tr><td class="paramname">pgn</td><td>The page number. </td></tr>
    <tr><td class="paramname">data</td><td>Points to the buffer that contains the bytes to be written. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes available in the buffer. This may be less than the page size, in which case the remaining bytes of the page will be set to 0xff.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes actually written. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00360">360</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="spi__at45d_8c_source.html#l00059">AT45_WRITE_POLLS</a>, <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, <a class="el" href="at45d_8h_source.html#l00087">DFCMD_BUF1_FLASH</a>, <a class="el" href="at45d_8h_source.html#l00091">DFCMD_BUF1_WRITE</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

<p>Referenced by <a class="el" href="nvmem__at45d_8c_source.html#l00187">SpiAt45dConfigWrite()</a>.</p>

</div>
</div>
<a class="anchor" id="a98cec9a103ede98743d6ff9a20c07a9f"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPageWrite_P" ref="a98cec9a103ede98743d6ff9a20c07a9f" args="(NUTDEVICE *dev, uint32_t pgn, PGM_P data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dPageWrite_P </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pgn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGM_P&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00414">414</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a511e65d18ee1e3223f5d077f9db35ace"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPages" ref="a511e65d18ee1e3223f5d077f9db35ace" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> SpiAt45dPages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the number of pages. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the registered DataFlash device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The total number of pages available in this device. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00427">427</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

</div>
</div>
<a class="anchor" id="aa0c27889cf7245d2266c92c32bd0fdee"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dPageSize" ref="aa0c27889cf7245d2266c92c32bd0fdee" args="(NUTDEVICE *dev)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dPageSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the page size. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Specifies the registered DataFlash device.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes per page. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00446">446</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="blockdev_8h_source.html#l00123">_NUTBLOCKIO::blkio_info</a>, <a class="el" href="device_8h_source.html#l00216">_NUTDEVICE::dev_dcb</a>, and <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>.</p>

<p>Referenced by <a class="el" href="nvmem__at45d_8c_source.html#l00134">SpiAt45dConfigSize()</a>, and <a class="el" href="nvmem__at45d_8c_source.html#l00187">SpiAt45dConfigWrite()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4c9fa59e861034fee22f78c0d1b2185"></a><!-- doxytag: member="spi_at45d.c::SpiAt45dIOCtl" ref="ab4c9fa59e861034fee22f78c0d1b2185" args="(NUTDEVICE *dev, int req, void *conf)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SpiAt45dIOCtl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Perform block I/O device control functions. </p>
<p>This function is called by the ioctl() function of the C runtime library. Applications should not directly call this function.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Identifies the device that receives the control command. </td></tr>
    <tr><td class="paramname">req</td><td>Requested control command. May be set to one of the following constants:<ul>
<li><a class="el" href="group__xg_block_dev.html#gad5bcfe283715d269e64a3d70fa58c3d3">NUTBLKDEV_MEDIAAVAIL</a></li>
<li><a class="el" href="group__xg_block_dev.html#ga0021380fd206ad6327ee752d3df8722c">NUTBLKDEV_MEDIACHANGE</a></li>
</ul>
</td></tr>
    <tr><td class="paramname">conf</td><td>Points to a buffer that contains any data required for the given control function or receives data from that function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="spi__at45d_8c_source.html#l00475">475</a> of file <a class="el" href="spi__at45d_8c_source.html">spi_at45d.c</a>.</p>

<p>References <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="blockdev_8h_source.html#l00076">NUTBLKDEV_MEDIAAVAIL</a>, and <a class="el" href="blockdev_8h_source.html#l00078">NUTBLKDEV_MEDIACHANGE</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="spi__at45d_8c.html">spi_at45d.c</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
