<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: TCP Sockets</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group__xg_tcp_socket.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">TCP Sockets</div>  </div>
<div class="ingroups"><a class="el" href="group__xg_socket.html">Socket API</a></div></div>
<div class="contents">

<p>Application interface for TCP sockets.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for TCP Sockets:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__xg_tcp_socket.png" border="0" alt="" usemap="#group____xg__tcp__socket"/>
<map name="group____xg__tcp__socket" id="group____xg__tcp__socket">
<area shape="rect" id="node2" href="group__xg_socket.html" title="Nut/Net Socket Interface." alt="" coords="5,5,85,30"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtcp__socket.html">tcp_socket</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">TCP socket information structure.  <a href="structtcp__socket.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gaefdf0c5749674efdd40a37857ca45f78">SO_FIN</a>&#160;&#160;&#160;0x01</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Socket transmit flag. Send FIN after all data has been transmitted.  <a href="#gaefdf0c5749674efdd40a37857ca45f78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga4a15c49046e1b3c0c3b4a3fad2b55c6c">SO_SYN</a>&#160;&#160;&#160;0x02</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Socket transmit flag. Send SYN first.  <a href="#ga4a15c49046e1b3c0c3b4a3fad2b55c6c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga070f5c81fc9c6442a0576f42d67c794c">SO_FORCE</a>&#160;&#160;&#160;0x08</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Socket transmit flag. Force sending ACK.  <a href="#ga070f5c81fc9c6442a0576f42d67c794c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gab60d40db730ce72950328301beae2c1c">SO_ACK</a>&#160;&#160;&#160;0x10</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Socket transmit flag. Send ACK.  <a href="#gab60d40db730ce72950328301beae2c1c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structtcp__socket.html">tcp_socket</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">TCP socket type.  <a href="#gaffc7ada36497e0b38f338c1aa1b5e394"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gae062b546a18e3a15d4fa87209d6160ca">NutTcpDiscardBuffers</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga551224f0a840a9cbf97b4d49dbc7c018">NutTcpDestroySocket</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy a previously allocated socket.  <a href="#ga551224f0a840a9cbf97b4d49dbc7c018"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga376cfd10344a38e74cde7ee2667ae3fe">NutTcpFindSocket</a> (<a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> lport, <a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> rport, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> raddr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a matching socket.  <a href="#ga376cfd10344a38e74cde7ee2667ae3fe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6">NutTcpCreateSocket</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a TCP socket.  <a href="#ga6bf8ec59828c5a0e38423293b4dfe8e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gab3bd1c81e2046e53cde6973b9c6bf6f4">NutTcpSetSockOpt</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, int optname, CONST void *optval, int optlen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value of a TCP socket option.  <a href="#gab3bd1c81e2046e53cde6973b9c6bf6f4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga357055ae6ebc31de5dd3e85ebd132108">NutTcpGetSockOpt</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, int optname, void *optval, int optlen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a TCP socket option value.  <a href="#ga357055ae6ebc31de5dd3e85ebd132108"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga48ff1e877483a0833cf38e428eac6457">NutTcpConnect</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> addr, <a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> port)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect to a remote socket.  <a href="#ga48ff1e877483a0833cf38e428eac6457"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga3859b3c38665aedc32608827f931498a">NutTcpAccept</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, <a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a> port)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for incoming connect from a remote socket.  <a href="#ga3859b3c38665aedc32608827f931498a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gafc14dd4c910afbb9269adc5bebba0281">NutTcpSend</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, CONST void *data, int len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data on a connected TCP socket.  <a href="#gafc14dd4c910afbb9269adc5bebba0281"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa">NutTcpReceive</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, void *data, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data on a connected TCP socket.  <a href="#gab08d3e50fd09da18b966af0dd23fa4aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga09d94fd887683a0837e06c2cc08fc7ba">NutTcpCloseSocket</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Close TCP socket.  <a href="#ga09d94fd887683a0837e06c2cc08fc7ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255">NutTcpError</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return specific code of the last error.  <a href="#ga3953f713369f008979d738b32d8fc255"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gac4ab675d039b53314b37b12b70afefd5">NutTcpDeviceRead</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, void *buffer, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Read from virtual socket device.  <a href="#gac4ab675d039b53314b37b12b70afefd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga9e0cdc2012de837e6b81006b9b32ca12">NutTcpDeviceWrite</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, CONST void *buf, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write to a socket.  <a href="#ga9e0cdc2012de837e6b81006b9b32ca12"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga71f2a257f72723170c19ad7b5d9f991f">NutTcpDeviceWrite_P</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, PGM_P buffer, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Write to device.  <a href="#ga71f2a257f72723170c19ad7b5d9f991f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#gaceb6b4b842cb85f48f6ca163c7aa1ce0">NutTcpDeviceIOCtl</a> (<a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *sock, int cmd, void *param)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver control function.  <a href="#gaceb6b4b842cb85f48f6ca163c7aa1ce0"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__xg_tcp_socket.html#ga2fcec3521061173b7bdd704877a57395">tcpSocketList</a> = 0</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Application interface for TCP sockets. </p>
<p>TCP clients typically use this order of API calls</p>
<ul>
<li><a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#ga48ff1e877483a0833cf38e428eac6457" title="Connect to a remote socket.">NutTcpConnect()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#gafc14dd4c910afbb9269adc5bebba0281" title="Send data on a connected TCP socket.">NutTcpSend()</a>, <a class="el" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket.">NutTcpReceive()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#ga09d94fd887683a0837e06c2cc08fc7ba" title="Close TCP socket.">NutTcpCloseSocket()</a></li>
</ul>
<p>This is quite similar to the traditional Berkley TCP Socket API used on desktop PCs.</p>
<p>The order of API calls for TCP servers is</p>
<ul>
<li><a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#ga3859b3c38665aedc32608827f931498a" title="Wait for incoming connect from a remote socket.">NutTcpAccept()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#gafc14dd4c910afbb9269adc5bebba0281" title="Send data on a connected TCP socket.">NutTcpSend()</a>, <a class="el" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket.">NutTcpReceive()</a></li>
<li><a class="el" href="group__xg_tcp_socket.html#ga09d94fd887683a0837e06c2cc08fc7ba" title="Close TCP socket.">NutTcpCloseSocket()</a></li>
</ul>
<p>Note, that this differs slightly from the Berkley API, where the initial socket is bound to a port and an additional socket is created when a connection is accepted. Nut/Net doesn't provide a bind call.</p>
<p>Most Nut/OS applications make use of the ability to assign a TCP socket to a stream and replace the somewhat primitive functions <a class="el" href="group__xg_tcp_socket.html#gafc14dd4c910afbb9269adc5bebba0281" title="Send data on a connected TCP socket.">NutTcpSend()</a> and <a class="el" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket.">NutTcpReceive()</a> with stdio calls like <a class="el" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream.">fprintf()</a> or <a class="el" href="group__xg_crt_stdio.html#ga344a4094f900770fa0c5c1c80054dbda" title="Read formatted data from a stream.">fscanf()</a>. </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="stdio_8h.html" title="C Standard I/O.">stdio.h</a>&gt;</span>
<span class="preprocessor"> #include &lt;<a class="code" href="socket_8h.html" title="UDP and TCP socket interface definitions.">sys/socket.h</a>&gt;</span>

 ...

 <a class="code" href="structtcp__socket.html" title="TCP socket information structure.">TCPSOCKET</a> *sock;
 <a class="code" href="fatfs_8h.html#a1bcda75666d51eabcbd6e14ec07da8f8">FILE</a> *stream;

 ...

 stream = <a class="code" href="group__xg_crt_stdio.html#ga907a98011e3468d951740abecb768685" title="Open a stream associated with a file, device or socket descriptor.">_fdopen</a>((<span class="keywordtype">int</span>) sock, <span class="stringliteral">&quot;r+b&quot;</span>);
 <a class="code" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream.">fprintf</a>(stream, <span class="stringliteral">&quot;Hello peer\r\n&quot;</span>);
</pre></div><p>Remember, that Nut/OS streams are opened in text mode by default. Thus, we explicitly specify binary mode for the stream.</p>
<p>The application programmer can modify some default values of the TCP stack by calling <a class="el" href="group__xg_tcp_socket.html#gab3bd1c81e2046e53cde6973b9c6bf6f4" title="Set value of a TCP socket option.">NutTcpSetSockOpt()</a>. This could be useful to fine tune the stack for maximum performance at minimum resource usage.</p>
<p>In addition you may call <a class="el" href="group__xg_tcp_socket.html#gab3bd1c81e2046e53cde6973b9c6bf6f4" title="Set value of a TCP socket option.">NutTcpSetSockOpt()</a> to set a receive timeout in order to detect broken connections. That's often required, because TCP relies on a gracefully closed connection on the remote side. If the remote crashes or if the physical connection breaks, then <a class="el" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket.">NutTcpReceive()</a> will never return unless a receive timeout value had been set. At least this is true for Nut/Net, which currently doesn't support the <a class="el" href="socket_8h.html#a0691781c519eed3f9a634f8eb55cd258" title="Keep connections alive.">SO_KEEPALIVE</a> option.</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="socket_8h.html" title="UDP and TCP socket interface definitions.">sys/socket.h</a>&gt;</span>

 ...

 <a class="code" href="structudp__socket.html" title="UDP socket information structure.">UDPSOCKET</a> *sock;
 <a class="code" href="group__xg_nut_o_s.html#ga8f25a50daf29ce2cee1ec038a4d744ea" title="Unsigned 32-bit value.">u_long</a> tmo = 3000;
 <span class="keywordtype">int</span> rc;
 <span class="keywordtype">char</span> buff[128];

 ...

 <a class="code" href="group__xg_tcp_socket.html#gab3bd1c81e2046e53cde6973b9c6bf6f4" title="Set value of a TCP socket option.">NutTcpSetSockOpt</a>(sock, <a class="code" href="socket_8h.html#af2d1ed6a34336a6f3df80fb518325846" title="Receive timeout.">SO_RCVTIMEO</a>, &amp;tmo, <span class="keyword">sizeof</span>(tmo));

 ...

 rc = <a class="code" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket.">NutTcpReceive</a>(sock, buff, <span class="keyword">sizeof</span>(buf));
 <span class="keywordflow">if</span> (rc == 0) {
     <span class="comment">/* </span>
<span class="comment">      * A timeout occured. We will now perform an application specific</span>
<span class="comment">      * action to check wether our remote is still alive.</span>
<span class="comment">      */</span>
 ...

 }
</pre></div><p>Note again the difference to the Berkley API, where select() is used to determine receive timeouts.</p>
<p>Most socket API calls return -1 in case of a failure. The function <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a> can be used to query a more specific error code. </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #include &lt;<a class="code" href="stdio_8h.html" title="C Standard I/O.">stdio.h</a>&gt;</span>
<span class="preprocessor"> #include &lt;<a class="code" href="socket_8h.html" title="UDP and TCP socket interface definitions.">sys/socket.h</a>&gt;</span>

 ...

 <a class="code" href="structtcp__socket.html" title="TCP socket information structure.">TCPSOCKET</a> *sock;
 <a class="code" href="group__xg_nut_o_s.html#ga8f25a50daf29ce2cee1ec038a4d744ea" title="Unsigned 32-bit value.">u_long</a> <a class="code" href="structip.html" title="Structure of an internet header.">ip</a> = <a class="code" href="group__xg_i_p.html#gadbce564458332a83ab871b91a54269dd" title="Convert decimal dotted ASCII representation into numeric IP address.">inet_addr</a>(<span class="stringliteral">&quot;192.168.1.100&quot;</span>);
 <a class="code" href="group__xg_nut_o_s.html#gaa1a19deefc008737e6397f44d983cfd4" title="Unsigned 16-bit value.">u_short</a> port = 20191;
 <span class="keywordtype">int</span> tcperr;

 ...

 <span class="keywordflow">if</span> (<a class="code" href="group__xg_tcp_socket.html#ga48ff1e877483a0833cf38e428eac6457" title="Connect to a remote socket.">NutTcpConnect</a>(sock, ip, port)) {
     tcperr = <a class="code" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError</a>(sock);
     <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;TCP Error: &quot;</span>);
     <span class="keywordflow">switch</span>(tcperr) {
     <span class="keywordflow">case</span> <a class="code" href="errno_8h.html#a53e186028fc992c3341ccb0d4d239b24">EHOSTUNREACH</a>:
         <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;No route to %s\n&quot;</span>, <a class="code" href="group__xg_i_p.html#ga9daa3cef32d6bcb76a95d0e869fd8b7a" title="Convert numeric IP address into decimal dotted ASCII representation.">inet_ntoa</a>(ip));
         <span class="keywordflow">break</span>;
     <span class="keywordflow">default</span>:
         <a class="code" href="icc_8h.html#a3cb9f0894fab1c8fbb0753c9c7c2a8d9" title="Redefined standard library routines.">printf</a>(<span class="stringliteral">&quot;%d\n&quot;</span>, tcperr);
         <span class="keywordflow">break</span>;
     }
 }
</pre></div> <hr/><h2>Define Documentation</h2>
<a class="anchor" id="gaefdf0c5749674efdd40a37857ca45f78"></a><!-- doxytag: member="sock_var.h::SO_FIN" ref="gaefdf0c5749674efdd40a37857ca45f78" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SO_FIN&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Socket transmit flag. Send FIN after all data has been transmitted. </p>

<p>Definition at line <a class="el" href="sock__var_8h_source.html#l00270">270</a> of file <a class="el" href="sock__var_8h_source.html">sock_var.h</a>.</p>

<p>Referenced by <a class="el" href="tcpout_8c_source.html#l00209">NutTcpOutput()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4a15c49046e1b3c0c3b4a3fad2b55c6c"></a><!-- doxytag: member="sock_var.h::SO_SYN" ref="ga4a15c49046e1b3c0c3b4a3fad2b55c6c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SO_SYN&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Socket transmit flag. Send SYN first. </p>

<p>Definition at line <a class="el" href="sock__var_8h_source.html#l00271">271</a> of file <a class="el" href="sock__var_8h_source.html">sock_var.h</a>.</p>

<p>Referenced by <a class="el" href="tcpout_8c_source.html#l00209">NutTcpOutput()</a>.</p>

</div>
</div>
<a class="anchor" id="ga070f5c81fc9c6442a0576f42d67c794c"></a><!-- doxytag: member="sock_var.h::SO_FORCE" ref="ga070f5c81fc9c6442a0576f42d67c794c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SO_FORCE&#160;&#160;&#160;0x08</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Socket transmit flag. Force sending ACK. </p>

<p>Definition at line <a class="el" href="sock__var_8h_source.html#l00272">272</a> of file <a class="el" href="sock__var_8h_source.html">sock_var.h</a>.</p>

<p>Referenced by <a class="el" href="tcpout_8c_source.html#l00209">NutTcpOutput()</a>, <a class="el" href="tcpsm_8c_source.html#l01671">NutTcpSm()</a>, and <a class="el" href="tcpsm_8c_source.html#l00934">NutTcpStateWindowEvent()</a>.</p>

</div>
</div>
<a class="anchor" id="gab60d40db730ce72950328301beae2c1c"></a><!-- doxytag: member="sock_var.h::SO_ACK" ref="gab60d40db730ce72950328301beae2c1c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SO_ACK&#160;&#160;&#160;0x10</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Socket transmit flag. Send ACK. </p>

<p>Definition at line <a class="el" href="sock__var_8h_source.html#l00273">273</a> of file <a class="el" href="sock__var_8h_source.html">sock_var.h</a>.</p>

<p>Referenced by <a class="el" href="tcpout_8c_source.html#l00209">NutTcpOutput()</a>, <a class="el" href="tcpsock_8c_source.html#l00692">NutTcpSend()</a>, <a class="el" href="tcpsm_8c_source.html#l01671">NutTcpSm()</a>, and <a class="el" href="tcpsm_8c_source.html#l00934">NutTcpStateWindowEvent()</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="gaffc7ada36497e0b38f338c1aa1b5e394"></a><!-- doxytag: member="sock_var.h::TCPSOCKET" ref="gaffc7ada36497e0b38f338c1aa1b5e394" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structtcp__socket.html">tcp_socket</a> <a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>TCP socket type. </p>

<p>Definition at line <a class="el" href="sock__var_8h_source.html#l00200">200</a> of file <a class="el" href="sock__var_8h_source.html">sock_var.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gae062b546a18e3a15d4fa87209d6160ca"></a><!-- doxytag: member="tcpsock.c::NutTcpDiscardBuffers" ref="gae062b546a18e3a15d4fa87209d6160ca" args="(TCPSOCKET *sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutTcpDiscardBuffers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00244">244</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="netbuf_8h_source.html#l00161">_NETBUF::nb_next</a>, <a class="el" href="netbuf_8c_source.html#l00364">NutNetBufFree()</a>, <a class="el" href="sock__var_8h_source.html#l00247">tcp_socket::so_rx_buf</a>, <a class="el" href="sock__var_8h_source.html#l00249">tcp_socket::so_rx_nbq</a>, and <a class="el" href="sock__var_8h_source.html#l00237">tcp_socket::so_tx_nbq</a>.</p>

<p>Referenced by <a class="el" href="tcpsm_8c_source.html#l01849">NutTcpAbortSocket()</a>, and <a class="el" href="tcpsock_8c_source.html#l00273">NutTcpDestroySocket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_gae062b546a18e3a15d4fa87209d6160ca_cgraph.png" border="0" usemap="#group__xg_tcp_socket_gae062b546a18e3a15d4fa87209d6160ca_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_gae062b546a18e3a15d4fa87209d6160ca_cgraph" id="group__xg_tcp_socket_gae062b546a18e3a15d4fa87209d6160ca_cgraph">
<area shape="rect" id="node3" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="198,29,301,54"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga551224f0a840a9cbf97b4d49dbc7c018"></a><!-- doxytag: member="tcpsock.c::NutTcpDestroySocket" ref="ga551224f0a840a9cbf97b4d49dbc7c018" args="(TCPSOCKET *sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NutTcpDestroySocket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Destroy a previously allocated socket. </p>
<p>Remove socket from the socket list and release occupied memory.</p>
<p>Applications must not call this function. It is automatically called by a timer after the socket has been closed by <a class="el" href="group__xg_tcp_socket.html#ga09d94fd887683a0837e06c2cc08fc7ba" title="Close TCP socket.">NutTcpCloseSocket()</a>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00273">273</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="memset_8c_source.html#l00088">memset()</a>, <a class="el" href="tcpsock_8c_source.html#l00244">NutTcpDiscardBuffers()</a>, <a class="el" href="sock__var_8h_source.html#l00220">tcp_socket::so_devobuf</a>, <a class="el" href="sock__var_8h_source.html#l00219">tcp_socket::so_devocnt</a>, <a class="el" href="sock__var_8h_source.html#l00209">tcp_socket::so_next</a>, and <a class="el" href="tcpsock_8c_source.html#l00238">tcpSocketList</a>.</p>

<p>Referenced by <a class="el" href="tcpsm_8c_source.html#l01671">NutTcpSm()</a>, and <a class="el" href="tcpsm_8c_source.html#l00879">NutTcpStateCloseEvent()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga551224f0a840a9cbf97b4d49dbc7c018_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga551224f0a840a9cbf97b4d49dbc7c018_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga551224f0a840a9cbf97b4d49dbc7c018_cgraph" id="group__xg_tcp_socket_ga551224f0a840a9cbf97b4d49dbc7c018_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="245,5,288,30"/><area shape="rect" id="node5" href="group__xg_crt_string.html#gaa4075a014de11292d9105188ddbeb216" title="Fill memory region with a specific byte value." alt="" coords="233,54,301,79"/><area shape="rect" id="node7" href="group__xg_tcp_socket.html#gae062b546a18e3a15d4fa87209d6160ca" title="NutTcpDiscardBuffers" alt="" coords="195,103,338,129"/><area shape="rect" id="node9" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="387,103,490,129"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga376cfd10344a38e74cde7ee2667ae3fe"></a><!-- doxytag: member="tcpsock.c::NutTcpFindSocket" ref="ga376cfd10344a38e74cde7ee2667ae3fe" args="(uint16_t lport, uint16_t rport, uint32_t raddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a>* NutTcpFindSocket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>lport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>rport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>raddr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Find a matching socket. </p>
<p>Loop through all sockets and find a matching connection (prefered) or a listening socket.</p>
<p>Applications typically do not call this function.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">lport</td><td>Local port number. </td></tr>
    <tr><td class="paramname">rport</td><td>Remote port number. </td></tr>
    <tr><td class="paramname">raddr</td><td>Remote IP address in network byte order.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Socket descriptor. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00323">323</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="sock__var_8h_source.html#l00225">tcp_socket::so_local_port</a>, <a class="el" href="sock__var_8h_source.html#l00209">tcp_socket::so_next</a>, <a class="el" href="sock__var_8h_source.html#l00226">tcp_socket::so_remote_addr</a>, <a class="el" href="sock__var_8h_source.html#l00227">tcp_socket::so_remote_port</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="tcp__fsm_8h_source.html#l00095">TCPS_CLOSED</a>, and <a class="el" href="tcp__fsm_8h_source.html#l00096">TCPS_LISTEN</a>.</p>

<p>Referenced by <a class="el" href="tcpsm_8c_source.html#l01671">NutTcpSm()</a>.</p>

</div>
</div>
<a class="anchor" id="ga6bf8ec59828c5a0e38423293b4dfe8e6"></a><!-- doxytag: member="tcpsock.c::NutTcpCreateSocket" ref="ga6bf8ec59828c5a0e38423293b4dfe8e6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a>* NutTcpCreateSocket </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a TCP socket. </p>
<p>Allocates a TCPSOCKET structure from heap memory, initializes it and returns a pointer to that structure.</p>
<p>The very first call will also start the TCP state machine, which is running in a separate thread.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Socket descriptor of the newly created TCP socket or 0 if there is not enough memory left. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00373">373</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="icc_8h_source.html#l00143">calloc</a>, <a class="el" href="device_8h_source.html#l00139">IFTYP_TCPSOCK</a>, <a class="el" href="in_8h_source.html#l00132">IPPROTO_TCP</a>, <a class="el" href="timer_8c_source.html#l00699">NutGetTickCount()</a>, <a class="el" href="ipdemux_8c_source.html#l00120">NutRegisterIpHandler()</a>, <a class="el" href="tcpsock_8c_source.html#l01143">NutTcpDeviceIOCtl()</a>, <a class="el" href="tcpsock_8c_source.html#l00937">NutTcpDeviceRead()</a>, <a class="el" href="tcpsock_8c_source.html#l00977">NutTcpDeviceWrite()</a>, <a class="el" href="tcpsock_8c_source.html#l01105">NutTcpDeviceWrite_P()</a>, <a class="el" href="tcpsm_8c_source.html#l01828">NutTcpInitStateMachine()</a>, <a class="el" href="tcpin_8c_source.html#l00148">NutTcpInput()</a>, <a class="el" href="sock__var_8h_source.html#l00217">tcp_socket::so_devioctl</a>, <a class="el" href="sock__var_8h_source.html#l00221">tcp_socket::so_devobsz</a>, <a class="el" href="sock__var_8h_source.html#l00212">tcp_socket::so_devread</a>, <a class="el" href="sock__var_8h_source.html#l00211">tcp_socket::so_devtype</a>, <a class="el" href="sock__var_8h_source.html#l00213">tcp_socket::so_devwrite</a>, <a class="el" href="sock__var_8h_source.html#l00215">tcp_socket::so_devwrite_P</a>, <a class="el" href="sock__var_8h_source.html#l00251">tcp_socket::so_mss</a>, <a class="el" href="sock__var_8h_source.html#l00209">tcp_socket::so_next</a>, <a class="el" href="sock__var_8h_source.html#l00254">tcp_socket::so_rtto</a>, <a class="el" href="sock__var_8h_source.html#l00244">tcp_socket::so_rx_bsz</a>, <a class="el" href="sock__var_8h_source.html#l00242">tcp_socket::so_rx_win</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="sock__var_8h_source.html#l00230">tcp_socket::so_tx_isn</a>, <a class="el" href="sock__var_8h_source.html#l00232">tcp_socket::so_tx_nxt</a>, <a class="el" href="sock__var_8h_source.html#l00231">tcp_socket::so_tx_una</a>, <a class="el" href="netinet_2tcp_8h_source.html#l00192">TCP_MSS</a>, <a class="el" href="netinet_2tcp_8h_source.html#l00200">TCP_WINSIZE</a>, <a class="el" href="tcp__fsm_8h_source.html#l00095">TCPS_CLOSED</a>, and <a class="el" href="tcpsock_8c_source.html#l00238">tcpSocketList</a>.</p>

<p>Referenced by <a class="el" href="httpd__simple_8c_source.html#l00069">main()</a>, <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>, <a class="el" href="smtpc_8c_source.html#l00209">NutSmtpConnect()</a>, <a class="el" href="portdio_8c_source.html#l00374">service()</a>, and <a class="el" href="httpserv_8c_source.html#l00587">Service()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga6bf8ec59828c5a0e38423293b4dfe8e6_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga6bf8ec59828c5a0e38423293b4dfe8e6_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga6bf8ec59828c5a0e38423293b4dfe8e6_cgraph" id="group__xg_tcp_socket_ga6bf8ec59828c5a0e38423293b4dfe8e6_cgraph">
<area shape="rect" id="node3" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="1261,5,1376,30"/><area shape="rect" id="node5" href="group__xg_i_p.html#ga7606caeb3d5b7bdacaa52b35de179685" title="Register an additional Ethernet protocol handler." alt="" coords="190,846,333,871"/><area shape="rect" id="node7" href="group__xg_tcp_socket.html#gaceb6b4b842cb85f48f6ca163c7aa1ce0" title="Driver control function." alt="" coords="199,895,324,921"/><area shape="rect" id="node9" href="group__xg_tcp_socket.html#gac4ab675d039b53314b37b12b70afefd5" title="Read from virtual socket device." alt="" coords="197,643,325,669"/><area shape="rect" id="node79" href="group__xg_tcp_socket.html#ga9e0cdc2012de837e6b81006b9b32ca12" title="Write to a socket." alt="" coords="394,745,521,770"/><area shape="rect" id="node86" href="group__xg_tcp_socket.html#ga71f2a257f72723170c19ad7b5d9f991f" title="Write to device." alt="" coords="191,745,332,770"/><area shape="rect" id="node89" href="group__xg_t_c_p.html#gaf4276abdc9e3a9912632c592769eb13a" title="Start TCP state machine." alt="" coords="382,394,533,419"/><area shape="rect" id="node136" href="group__xg_t_c_p.html#gae07d8163a48c288273133b44e1aa1cee" title="Process incoming TCP segments from IP layer." alt="" coords="413,1023,501,1049"/><area shape="rect" id="node11" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket." alt="" coords="405,643,510,669"/><area shape="rect" id="node13" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="1047,593,1153,618"/><area shape="rect" id="node23" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="830,469,925,494"/><area shape="rect" id="node34" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="1493,694,1563,719"/><area shape="rect" id="node36" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="1477,1150,1579,1175"/><area shape="rect" id="node39" href="group__xg_t_c_p.html#ga9f691b65c2a49fbb90202f3d45c5b000" title="Initiated by the application." alt="" coords="581,782,744,807"/><area shape="rect" id="node15" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="1237,530,1400,555"/><area shape="rect" id="node17" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="1242,457,1395,482"/><area shape="rect" id="node19" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="1255,579,1383,605"/><area shape="rect" id="node21" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="1470,306,1586,331"/><area shape="rect" id="node28" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="1051,491,1149,517"/><area shape="rect" id="node30" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="1042,339,1158,365"/><area shape="rect" id="node41" href="sock__var_8h.html#a2dbf5a03e60e89a32ffcfd429aa81775" title="Initiate TCP segment transmission." alt="" coords="829,833,926,858"/><area shape="rect" id="node44" href="netdebug_8h.html#a13243e59b9857a6c4ee17e4cee73af51" title="NutDumpTcpHeader" alt="" coords="1032,191,1168,217"/><area shape="rect" id="node52" href="group__xg_timer.html#gac1887264221d66b13d1e86d034227f1c" title="Return the milliseconds counter value." alt="" coords="1056,142,1144,167"/><area shape="rect" id="node57" href="group__xg_i_p.html#gacbd7636c68dcc06dd37e2fae11472278" title="Calculates an the final IP checksum over a block of data." alt="" coords="1269,897,1368,922"/><area shape="rect" id="node59" href="group__xg_i_p.html#ga0586b4cd0a06f9e87f216037f937fab1" title="Calculate a partial IP checksum of a buffer." alt="" coords="1461,897,1595,922"/><area shape="rect" id="node62" href="group__xg_i_p.html#gaa1d170f1dc44c4292480d40990483d85" title="Send IP datagram." alt="" coords="1057,947,1143,973"/><area shape="rect" id="node64" href="group__xgnetbuf.html#ga7a733aed1e6c15aaabb6657abe5f4e39" title="Allocate or re&#45;allocate a network buffer part." alt="" coords="1267,998,1371,1023"/><area shape="rect" id="node67" href="group__xgnetbuf.html#ga3619cbf40ea5786bc0241c1e2e8e955a" title="Create a referencing copy of an existing network buffer structure." alt="" coords="1252,846,1385,871"/><area shape="rect" id="node73" href="group__xg_i_p.html#ga9ddc8d97c6179d3b2c562a78b2131632" title="Calculates the partial IP pseudo checksum." alt="" coords="1011,1099,1189,1125"/><area shape="rect" id="node46" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream." alt="" coords="1293,205,1345,230"/><area shape="rect" id="node50" href="group__xg_crt_stdio.html#ga14acfae1988535199b72df91e18f72f3" title="Write a string to a stream." alt="" coords="1503,154,1553,179"/><area shape="rect" id="node48" href="group__xg_crt_stdio.html#ga50c4b673b1d86ab16f2a46aff7122c5c" title="Write argument list to a stream using a given format." alt="" coords="1499,205,1557,230"/><area shape="rect" id="node55" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="1262,54,1375,79"/><area shape="rect" id="node81" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="1079,1302,1121,1327"/><area shape="rect" id="node83" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="633,1454,692,1479"/><area shape="rect" id="node91" href="group__xg_nut_arch_arm_os_context.html#ga8357f2631f0c0a9444844e5ea64be50d" title="Create a new thread." alt="" coords="1041,241,1159,266"/><area shape="rect" id="node104" href="group__xg_t_c_p.html#gac0a5f54bde677941f7cf555c2f89a367" title="TCP state machine thread." alt="" coords="623,394,703,419"/><area shape="rect" id="node97" href="osdebug_8h.html#acc9b4c9e94b94936592ec3b84625b1fb" title="Dump system thread list." alt="" coords="1251,103,1386,129"/><area shape="rect" id="node99" href="group__xg_crt_stdio.html#gabe6299d5823dd023e610aaa619735a3f" title="Write a character to a stream." alt="" coords="1504,55,1552,81"/><area shape="rect" id="node102" href="thread_8h.html#ad3d53c8f90bef732dd044b78c55f801c" title="NutThreadStackAvailable" alt="" coords="1449,105,1607,130"/><area shape="rect" id="node106" href="group__xg_thread.html#ga8ebe134e9c404072584e80fb8d7e8985" title="Set the current thread&#39;s priority." alt="" coords="1033,290,1167,315"/><area shape="rect" id="node114" href="sock__var_8h.html#a47fb9b8095e5720d1cf8bc1b9db8df2c" title="Reject an incoming segment." alt="" coords="829,1023,925,1049"/><area shape="rect" id="node123" href="group__xg_t_c_p.html#gad8b7767f85c9dc3cd4a1f1f961ae7a84" title="Retransmit a segment after ACK timeout." alt="" coords="792,293,963,318"/><area shape="rect" id="node130" href="group__xg_tcp_socket.html#ga551224f0a840a9cbf97b4d49dbc7c018" title="Destroy a previously allocated socket." alt="" coords="807,1302,947,1327"/><area shape="rect" id="node133" href="group__xg_tcp_socket.html#ga376cfd10344a38e74cde7ee2667ae3fe" title="Find a matching socket." alt="" coords="816,243,939,269"/><area shape="rect" id="node110" href="group__xg_thread.html#gaf8e9b69ee0082bcdb00fd6cdb68f4136" title="Kill the running thread." alt="" coords="1270,407,1367,433"/><area shape="rect" id="node125" href="group__xg_t_c_p.html#gaf821e7425534f4f62fd8ea64b0f98992" title="Closes socket with error." alt="" coords="1037,93,1163,118"/><area shape="rect" id="node138" href="group__xg_t_c_p.html#ga3402b7ed85f67803cc473f636290d22a" title="Process incoming TCP segments." alt="" coords="595,1023,730,1049"/><area shape="rect" id="node141" href="group__xg_event.html#gad519c6b1469621d2b3909fe58d1ac40b" title="Post an event to a specified queue." alt="" coords="829,770,925,795"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab3bd1c81e2046e53cde6973b9c6bf6f4"></a><!-- doxytag: member="tcpsock.c::NutTcpSetSockOpt" ref="gab3bd1c81e2046e53cde6973b9c6bf6f4" args="(TCPSOCKET *sock, int optname, CONST void *optval, int optlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpSetSockOpt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set value of a TCP socket option. </p>
<p>The following values can be set:</p>
<ul>
<li><a class="el" href="netinet_2tcp_8h.html#af20c12fa9bf018281e14c3b43b777e2e" title="Set maximum segment size.">TCP_MAXSEG</a> Maximum segment size (<a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>). Can only be set if socket is not yet connected.</li>
<li><a class="el" href="socket_8h.html#ab9d2f7ca5c94bd51cdab3e1913b66e2d" title="Send timeout.">SO_SNDTIMEO</a> Socket send timeout (<a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>).</li>
<li><a class="el" href="socket_8h.html#af2d1ed6a34336a6f3df80fb518325846" title="Receive timeout.">SO_RCVTIMEO</a> Socket receive timeout (<a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>).</li>
<li><a class="el" href="socket_8h.html#af618cbb85161ff3196d3bcdf7565ba64" title="Send buffer size.">SO_SNDBUF</a> Socket output buffer size (<a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>).</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">optname</td><td>Option to set. </td></tr>
    <tr><td class="paramname">optval</td><td>Pointer to the value. </td></tr>
    <tr><td class="paramname">optlen</td><td>Length of the value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. The specific error code can be retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a>. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00433">433</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00075">EINVAL</a>, <a class="el" href="errno_8h_source.html#l00118">EISCONN</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00251">tcp_socket::so_mss</a>, <a class="el" href="socket_8h_source.html#l00163">SO_RCVBUF</a>, <a class="el" href="sock__var_8h_source.html#l00244">tcp_socket::so_rx_bsz</a>, <a class="el" href="sock__var_8h_source.html#l00242">tcp_socket::so_rx_win</a>, <a class="el" href="socket_8h_source.html#l00166">SO_SNDTIMEO</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="sock__var_8h_source.html#l00263">tcp_socket::so_write_to</a>, <a class="el" href="netinet_2tcp_8h_source.html#l00218">TCP_MAXSEG</a>, and <a class="el" href="tcp__fsm_8h_source.html#l00095">TCPS_CLOSED</a>.</p>

<p>Referenced by <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>, and <a class="el" href="smtpc_8c_source.html#l00209">NutSmtpConnect()</a>.</p>

</div>
</div>
<a class="anchor" id="ga357055ae6ebc31de5dd3e85ebd132108"></a><!-- doxytag: member="tcpsock.c::NutTcpGetSockOpt" ref="ga357055ae6ebc31de5dd3e85ebd132108" args="(TCPSOCKET *sock, int optname, void *optval, int optlen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpGetSockOpt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a TCP socket option value. </p>
<p>The following values can be set:</p>
<ul>
<li><a class="el" href="netinet_2tcp_8h.html#af20c12fa9bf018281e14c3b43b777e2e" title="Set maximum segment size.">TCP_MAXSEG</a> Maximum segment size (<a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>).</li>
<li><a class="el" href="socket_8h.html#ab9d2f7ca5c94bd51cdab3e1913b66e2d" title="Send timeout.">SO_SNDTIMEO</a> Socket send timeout (<a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>).</li>
<li><a class="el" href="socket_8h.html#af2d1ed6a34336a6f3df80fb518325846" title="Receive timeout.">SO_RCVTIMEO</a> Socket receive timeout (<a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>).</li>
<li><a class="el" href="socket_8h.html#af618cbb85161ff3196d3bcdf7565ba64" title="Send buffer size.">SO_SNDBUF</a> Socket output buffer size (<a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>).</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">optname</td><td>Option to get. </td></tr>
    <tr><td class="paramname">optval</td><td>Points to a buffer receiving the value. </td></tr>
    <tr><td class="paramname">optlen</td><td>Length of the value buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. The specific error code can be retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a>. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00516">516</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00075">EINVAL</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00251">tcp_socket::so_mss</a>, <a class="el" href="socket_8h_source.html#l00163">SO_RCVBUF</a>, <a class="el" href="sock__var_8h_source.html#l00244">tcp_socket::so_rx_bsz</a>, <a class="el" href="socket_8h_source.html#l00166">SO_SNDTIMEO</a>, <a class="el" href="sock__var_8h_source.html#l00263">tcp_socket::so_write_to</a>, and <a class="el" href="netinet_2tcp_8h_source.html#l00218">TCP_MAXSEG</a>.</p>

</div>
</div>
<a class="anchor" id="ga48ff1e877483a0833cf38e428eac6457"></a><!-- doxytag: member="tcpsock.c::NutTcpConnect" ref="ga48ff1e877483a0833cf38e428eac6457" args="(TCPSOCKET *sock, uint32_t addr, uint16_t port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpConnect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Connect to a remote socket. </p>
<p>This function tries to establish a connection to the specified remote port of the specified remote server. The calling thread will be suspended until a connection is successfully established or an error occurs.</p>
<p>This function is typically used by TCP client applications.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">addr</td><td>IP address of the host to connect (network byte order). </td></tr>
    <tr><td class="paramname">port</td><td>Port number to connect (host byte order).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. The specific error code can be retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a>. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00593">593</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, <a class="el" href="errno_8h_source.html#l00130">EHOSTUNREACH</a>, <a class="el" href="errno_8h_source.html#l00118">EISCONN</a>, <a class="el" href="errno_8h_source.html#l00105">EOPNOTSUPP</a>, <a class="el" href="types_8h_source.html#l00331">htons</a>, <a class="el" href="if__var_8h_source.html#l00198">ifnet::if_local_ip</a>, <a class="el" href="route_8c_source.html#l00349">NutIpRouteQuery()</a>, <a class="el" href="tcpsm_8c_source.html#l00847">NutTcpStateActiveOpenEvent()</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00224">tcp_socket::so_local_addr</a>, <a class="el" href="sock__var_8h_source.html#l00225">tcp_socket::so_local_port</a>, <a class="el" href="sock__var_8h_source.html#l00209">tcp_socket::so_next</a>, <a class="el" href="sock__var_8h_source.html#l00226">tcp_socket::so_remote_addr</a>, <a class="el" href="sock__var_8h_source.html#l00227">tcp_socket::so_remote_port</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="tcp__fsm_8h_source.html#l00095">TCPS_CLOSED</a>, <a class="el" href="tcp__fsm_8h_source.html#l00096">TCPS_LISTEN</a>, and <a class="el" href="tcpsock_8c_source.html#l00238">tcpSocketList</a>.</p>

<p>Referenced by <a class="el" href="inetq_8c_source.html#l00128">main()</a>, <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>, and <a class="el" href="smtpc_8c_source.html#l00209">NutSmtpConnect()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga48ff1e877483a0833cf38e428eac6457_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga48ff1e877483a0833cf38e428eac6457_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga48ff1e877483a0833cf38e428eac6457_cgraph" id="group__xg_tcp_socket_ga48ff1e877483a0833cf38e428eac6457_cgraph">
<area shape="rect" id="node3" href="group__xg_i_p.html#ga2534f1918ba2a63523659fc005344b25" title="Find a device associated with a particular IP route." alt="" coords="193,83,309,109"/><area shape="rect" id="node5" href="group__xg_t_c_p.html#ga77edd214cf89e11aebfc556b6879e487" title="Initiated by the application." alt="" coords="161,133,341,158"/><area shape="rect" id="node7" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="390,133,485,158"/><area shape="rect" id="node9" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="539,158,645,183"/><area shape="rect" id="node11" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="699,107,861,133"/><area shape="rect" id="node13" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="1123,95,1277,121"/><area shape="rect" id="node15" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="716,209,844,234"/><area shape="rect" id="node33" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="543,345,641,370"/><area shape="rect" id="node49" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="534,6,650,31"/><area shape="rect" id="node17" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="928,183,1056,209"/><area shape="rect" id="node24" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="909,282,1075,307"/><area shape="rect" id="node29" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="934,233,1050,258"/><area shape="rect" id="node19" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="1151,206,1249,231"/><area shape="rect" id="node21" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1331,281,1435,306"/><area shape="rect" id="node26" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="1143,331,1257,357"/><area shape="rect" id="node35" href="group__xg_timer.html#gaf104e0c3660b2a77bd0d7b00c4fd741c" title="Start a system timer." alt="" coords="717,345,843,370"/><area shape="rect" id="node41" href="group__xg_nut_arch_arm_os_timer_at91.html#gabb52a4e7f513a7c586898065e0a0c81a" title="Calculate system ticks for a given number of milliseconds." alt="" coords="708,419,852,445"/><area shape="rect" id="node37" href="group__xg_timer.html#ga1e47b683a996583386ebef7e7c92501e" title="Create a new system timer." alt="" coords="937,331,1047,357"/><area shape="rect" id="node43" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="935,433,1049,458"/><area shape="rect" id="node45" href="group__xg_timer.html#ga784a7f52b5167c777149fd1d874c99f0" title="Return the CPU clock frequency." alt="" coords="1143,433,1257,458"/><area shape="rect" id="node47" href="group__xg_nut_arch_arm_os_timer_gba.html#ga7d11c53224db0028ad4838f8b9df9872" title="Return the CPU clock in Hertz." alt="" coords="1325,433,1440,458"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3859b3c38665aedc32608827f931498a"></a><!-- doxytag: member="tcpsock.c::NutTcpAccept" ref="ga3859b3c38665aedc32608827f931498a" args="(TCPSOCKET *sock, uint16_t port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpAccept </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a1f1825b69244eb3ad2c7165ddc99c956">uint16_t</a>&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wait for incoming connect from a remote socket. </p>
<p>The calling thread will be suspended until until an incoming connection request is received.</p>
<p>This function is typically used by TCP server applications.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">port</td><td>Port number to listen to (host byte order).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. The specific error code can be retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a>. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00669">669</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="types_8h_source.html#l00331">htons</a>, <a class="el" href="tcpsm_8c_source.html#l00803">NutTcpStatePassiveOpenEvent()</a>, and <a class="el" href="sock__var_8h_source.html#l00225">tcp_socket::so_local_port</a>.</p>

<p>Referenced by <a class="el" href="httpd__simple_8c_source.html#l00069">main()</a>, <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>, <a class="el" href="portdio_8c_source.html#l00374">service()</a>, and <a class="el" href="httpserv_8c_source.html#l00587">Service()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga3859b3c38665aedc32608827f931498a_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga3859b3c38665aedc32608827f931498a_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga3859b3c38665aedc32608827f931498a_cgraph" id="group__xg_tcp_socket_ga3859b3c38665aedc32608827f931498a_cgraph">
<area shape="rect" id="node3" href="group__xg_t_c_p.html#gac5d18facd9bf6a983652d415fc806083" title="Initiated by the application." alt="" coords="153,133,346,158"/><area shape="rect" id="node5" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="395,133,490,158"/><area shape="rect" id="node7" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="544,158,651,183"/><area shape="rect" id="node9" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="704,107,867,133"/><area shape="rect" id="node11" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="1129,95,1282,121"/><area shape="rect" id="node13" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="721,209,849,234"/><area shape="rect" id="node31" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="548,345,647,370"/><area shape="rect" id="node47" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="539,6,655,31"/><area shape="rect" id="node15" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="933,183,1061,209"/><area shape="rect" id="node22" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="915,282,1080,307"/><area shape="rect" id="node27" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="939,233,1055,258"/><area shape="rect" id="node17" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="1156,206,1255,231"/><area shape="rect" id="node19" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1336,281,1440,306"/><area shape="rect" id="node24" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="1148,331,1263,357"/><area shape="rect" id="node33" href="group__xg_timer.html#gaf104e0c3660b2a77bd0d7b00c4fd741c" title="Start a system timer." alt="" coords="722,345,849,370"/><area shape="rect" id="node39" href="group__xg_nut_arch_arm_os_timer_at91.html#gabb52a4e7f513a7c586898065e0a0c81a" title="Calculate system ticks for a given number of milliseconds." alt="" coords="713,419,857,445"/><area shape="rect" id="node35" href="group__xg_timer.html#ga1e47b683a996583386ebef7e7c92501e" title="Create a new system timer." alt="" coords="942,331,1053,357"/><area shape="rect" id="node41" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="941,433,1054,458"/><area shape="rect" id="node43" href="group__xg_timer.html#ga784a7f52b5167c777149fd1d874c99f0" title="Return the CPU clock frequency." alt="" coords="1148,433,1263,458"/><area shape="rect" id="node45" href="group__xg_nut_arch_arm_os_timer_gba.html#ga7d11c53224db0028ad4838f8b9df9872" title="Return the CPU clock in Hertz." alt="" coords="1331,433,1445,458"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gafc14dd4c910afbb9269adc5bebba0281"></a><!-- doxytag: member="tcpsock.c::NutTcpSend" ref="gafc14dd4c910afbb9269adc5bebba0281" args="(TCPSOCKET *sock, CONST void *data, int len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpSend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send data on a connected TCP socket. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. In addition a connection must have been established by calling NutTcpConnect or NutTcpAccept. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to a buffer containing the data to send. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to be sent.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If successful, the number of bytes added to the socket transmit buffer. This is limited to the maximum segment size of the connection and thus may be less than the specified number of bytes to send. The return value -1 indicates a fatal error. On time out, a value of 0 is returned. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00692">692</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00119">ENOTCONN</a>, <a class="el" href="event_8c_source.html#l00271">NutEventWait()</a>, <a class="el" href="tcpout_8c_source.html#l00209">NutTcpOutput()</a>, <a class="el" href="thread_8c_source.html#l00466">NutThreadYield()</a>, <a class="el" href="sock__var_8h_source.html#l00273">SO_ACK</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00251">tcp_socket::so_mss</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="sock__var_8h_source.html#l00229">tcp_socket::so_tx_flags</a>, <a class="el" href="sock__var_8h_source.html#l00232">tcp_socket::so_tx_nxt</a>, <a class="el" href="sock__var_8h_source.html#l00238">tcp_socket::so_tx_tq</a>, <a class="el" href="sock__var_8h_source.html#l00231">tcp_socket::so_tx_una</a>, <a class="el" href="sock__var_8h_source.html#l00263">tcp_socket::so_write_to</a>, and <a class="el" href="tcp__fsm_8h_source.html#l00099">TCPS_ESTABLISHED</a>.</p>

<p>Referenced by <a class="el" href="inetq_8c_source.html#l00128">main()</a>, and <a class="el" href="ftpd_8c_source.html#l00741">NutFtpTransferFile()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_gafc14dd4c910afbb9269adc5bebba0281_cgraph.png" border="0" usemap="#group__xg_tcp_socket_gafc14dd4c910afbb9269adc5bebba0281_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_gafc14dd4c910afbb9269adc5bebba0281_cgraph" id="group__xg_tcp_socket_gafc14dd4c910afbb9269adc5bebba0281_cgraph">
<area shape="rect" id="node3" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="145,168,239,193"/><area shape="rect" id="node5" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="293,219,400,244"/><area shape="rect" id="node49" href="sock__var_8h.html#a2dbf5a03e60e89a32ffcfd429aa81775" title="Initiate TCP segment transmission." alt="" coords="298,771,395,796"/><area shape="rect" id="node7" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="461,167,624,192"/><area shape="rect" id="node9" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="894,92,1047,117"/><area shape="rect" id="node11" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="479,117,607,143"/><area shape="rect" id="node29" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="297,344,396,369"/><area shape="rect" id="node45" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="289,67,405,92"/><area shape="rect" id="node13" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="699,117,827,143"/><area shape="rect" id="node20" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="680,268,845,293"/><area shape="rect" id="node25" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="705,167,821,192"/><area shape="rect" id="node15" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="921,167,1020,192"/><area shape="rect" id="node17" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1101,268,1205,293"/><area shape="rect" id="node22" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="913,369,1028,395"/><area shape="rect" id="node31" href="group__xg_timer.html#gaf104e0c3660b2a77bd0d7b00c4fd741c" title="Start a system timer." alt="" coords="479,344,606,369"/><area shape="rect" id="node37" href="group__xg_nut_arch_arm_os_timer_at91.html#gabb52a4e7f513a7c586898065e0a0c81a" title="Calculate system ticks for a given number of milliseconds." alt="" coords="471,471,615,496"/><area shape="rect" id="node33" href="group__xg_timer.html#ga1e47b683a996583386ebef7e7c92501e" title="Create a new system timer." alt="" coords="707,369,818,395"/><area shape="rect" id="node39" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="706,471,819,496"/><area shape="rect" id="node41" href="group__xg_timer.html#ga784a7f52b5167c777149fd1d874c99f0" title="Return the CPU clock frequency." alt="" coords="913,471,1028,496"/><area shape="rect" id="node43" href="group__xg_nut_arch_arm_os_timer_gba.html#ga7d11c53224db0028ad4838f8b9df9872" title="Return the CPU clock in Hertz." alt="" coords="1096,471,1211,496"/><area shape="rect" id="node51" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="936,999,1005,1024"/><area shape="rect" id="node53" href="netdebug_8h.html#a13243e59b9857a6c4ee17e4cee73af51" title="NutDumpTcpHeader" alt="" coords="475,1075,611,1100"/><area shape="rect" id="node77" href="group__xg_timer.html#gac1887264221d66b13d1e86d034227f1c" title="Return the milliseconds counter value." alt="" coords="499,421,587,447"/><area shape="rect" id="node81" href="group__xg_i_p.html#gacbd7636c68dcc06dd37e2fae11472278" title="Calculates an the final IP checksum over a block of data." alt="" coords="713,623,812,648"/><area shape="rect" id="node83" href="group__xg_i_p.html#ga0586b4cd0a06f9e87f216037f937fab1" title="Calculate a partial IP checksum of a buffer." alt="" coords="903,572,1038,597"/><area shape="rect" id="node86" href="group__xg_i_p.html#gaa1d170f1dc44c4292480d40990483d85" title="Send IP datagram." alt="" coords="499,771,586,796"/><area shape="rect" id="node88" href="group__xgnetbuf.html#ga7a733aed1e6c15aaabb6657abe5f4e39" title="Allocate or re&#45;allocate a network buffer part." alt="" coords="711,872,815,897"/><area shape="rect" id="node90" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="919,897,1022,923"/><area shape="rect" id="node95" href="group__xgnetbuf.html#ga3619cbf40ea5786bc0241c1e2e8e955a" title="Create a referencing copy of an existing network buffer structure." alt="" coords="696,973,829,999"/><area shape="rect" id="node105" href="group__xg_i_p.html#ga9ddc8d97c6179d3b2c562a78b2131632" title="Calculates the partial IP pseudo checksum." alt="" coords="454,521,631,547"/><area shape="rect" id="node55" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream." alt="" coords="737,1125,789,1151"/><area shape="rect" id="node73" href="group__xg_crt_stdio.html#ga14acfae1988535199b72df91e18f72f3" title="Write a string to a stream." alt="" coords="946,1075,995,1100"/><area shape="rect" id="node57" href="group__xg_crt_stdio.html#ga50c4b673b1d86ab16f2a46aff7122c5c" title="Write argument list to a stream using a given format." alt="" coords="942,1125,999,1151"/><area shape="rect" id="node59" href="group__xg_crt_stdio.html#ga651a41ea9a05d4294a58c1ec83e13f18" title="Write formatted data using a given output function." alt="" coords="1129,1149,1178,1175"/><area shape="rect" id="node71" href="io_8h.html#a901fa187b164dd6faaac1b62c88614b5" title="_write" alt="" coords="1126,1100,1181,1125"/><area shape="rect" id="node61" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="1264,1099,1323,1124"/><area shape="rect" id="node63" href="group__xg_crt_string.html#ga9d0726a46ae033e7755fd1313da76ab1" title="Locate byte in a memory region." alt="" coords="1259,1148,1327,1173"/><area shape="rect" id="node65" href="group__xg_crt_string.html#ga7b9fc4834c90ac78977b5fbb3076c5ac" title="Compute the length of a NUL terminated string." alt="" coords="1267,1049,1320,1075"/><area shape="rect" id="node67" href="group__xg_crt_string.html#ga5f9abaa6c5ffa26025ca901c14cb1056" title="Copy a string." alt="" coords="1266,1197,1321,1223"/><area shape="rect" id="node69" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="1272,1247,1315,1272"/><area shape="rect" id="node93" href="group__xg_crt_string.html#gaa4075a014de11292d9105188ddbeb216" title="Fill memory region with a specific byte value." alt="" coords="729,672,797,697"/><area shape="rect" id="node101" href="group__xg_i_p.html#ga2534f1918ba2a63523659fc005344b25" title="Find a device associated with a particular IP route." alt="" coords="705,721,821,747"/><area shape="rect" id="node103" href="if__ether_8h.html#ad1273e0893b714b62384c38dcc443beb" title="NutArpCacheQuery" alt="" coords="699,771,826,796"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab08d3e50fd09da18b966af0dd23fa4aa"></a><!-- doxytag: member="tcpsock.c::NutTcpReceive" ref="gab08d3e50fd09da18b966af0dd23fa4aa" args="(TCPSOCKET *sock, void *data, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpReceive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receive data on a connected TCP socket. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. In addition a connection must have been established by calling NutTcpConnect or NutTcpAccept. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the buffer that receives the data. </td></tr>
    <tr><td class="paramname">size</td><td>Size of the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If successful, the number of received data bytes is returned. This may be less than the specified size of the buffer. The return value 0 indicates a timeout, while -1 is returned in case of an error or broken connection. Call <a class="el" href="group__xg_tcp_socket.html#ga3953f713369f008979d738b32d8fc255" title="Return specific code of the last error.">NutTcpError()</a> to determine the specific error code. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00762">762</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00119">ENOTCONN</a>, <a class="el" href="memcpy_8c_source.html#l00114">memcpy()</a>, <a class="el" href="netbuf_8h_source.html#l00166">_NETBUF::nb_ap</a>, <a class="el" href="netbuf_8h_source.html#l00161">_NETBUF::nb_next</a>, <a class="el" href="event_8c_source.html#l00271">NutEventWait()</a>, <a class="el" href="netbuf_8c_source.html#l00364">NutNetBufFree()</a>, <a class="el" href="tcpsm_8c_source.html#l00934">NutTcpStateWindowEvent()</a>, <a class="el" href="thread_8c_source.html#l00466">NutThreadYield()</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00251">tcp_socket::so_mss</a>, <a class="el" href="sock__var_8h_source.html#l00245">tcp_socket::so_rd_cnt</a>, <a class="el" href="sock__var_8h_source.html#l00262">tcp_socket::so_read_to</a>, <a class="el" href="sock__var_8h_source.html#l00246">tcp_socket::so_rx_apc</a>, <a class="el" href="sock__var_8h_source.html#l00244">tcp_socket::so_rx_bsz</a>, <a class="el" href="sock__var_8h_source.html#l00247">tcp_socket::so_rx_buf</a>, <a class="el" href="sock__var_8h_source.html#l00243">tcp_socket::so_rx_cnt</a>, <a class="el" href="sock__var_8h_source.html#l00248">tcp_socket::so_rx_tq</a>, <a class="el" href="sock__var_8h_source.html#l00242">tcp_socket::so_rx_win</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, <a class="el" href="netbuf_8h_source.html#l00153">_NBDATA::sz</a>, <a class="el" href="tcp__fsm_8h_source.html#l00100">TCPS_CLOSE_WAIT</a>, <a class="el" href="tcp__fsm_8h_source.html#l00099">TCPS_ESTABLISHED</a>, and <a class="el" href="netbuf_8h_source.html#l00152">_NBDATA::vp</a>.</p>

<p>Referenced by <a class="el" href="inetq_8c_source.html#l00128">main()</a>, <a class="el" href="ftpd_8c_source.html#l00741">NutFtpTransferFile()</a>, and <a class="el" href="tcpsock_8c_source.html#l00937">NutTcpDeviceRead()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_gab08d3e50fd09da18b966af0dd23fa4aa_cgraph.png" border="0" usemap="#group__xg_tcp_socket_gab08d3e50fd09da18b966af0dd23fa4aa_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_gab08d3e50fd09da18b966af0dd23fa4aa_cgraph" id="group__xg_tcp_socket_gab08d3e50fd09da18b966af0dd23fa4aa_cgraph">
<area shape="rect" id="node3" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="1019,1163,1088,1189"/><area shape="rect" id="node5" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="194,158,289,183"/><area shape="rect" id="node7" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="376,158,483,183"/><area shape="rect" id="node51" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="1002,713,1105,738"/><area shape="rect" id="node54" href="group__xg_t_c_p.html#ga9f691b65c2a49fbb90202f3d45c5b000" title="Initiated by the application." alt="" coords="160,738,323,763"/><area shape="rect" id="node9" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="544,107,707,133"/><area shape="rect" id="node11" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="977,82,1130,107"/><area shape="rect" id="node13" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="561,209,689,234"/><area shape="rect" id="node31" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="380,333,479,358"/><area shape="rect" id="node47" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="371,6,487,31"/><area shape="rect" id="node15" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="781,207,909,233"/><area shape="rect" id="node22" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="763,257,928,282"/><area shape="rect" id="node27" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="787,158,903,183"/><area shape="rect" id="node17" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="1004,206,1103,231"/><area shape="rect" id="node19" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1184,257,1288,282"/><area shape="rect" id="node24" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="996,358,1111,383"/><area shape="rect" id="node33" href="group__xg_timer.html#gaf104e0c3660b2a77bd0d7b00c4fd741c" title="Start a system timer." alt="" coords="562,333,689,358"/><area shape="rect" id="node39" href="group__xg_nut_arch_arm_os_timer_at91.html#gabb52a4e7f513a7c586898065e0a0c81a" title="Calculate system ticks for a given number of milliseconds." alt="" coords="553,397,697,422"/><area shape="rect" id="node35" href="group__xg_timer.html#ga1e47b683a996583386ebef7e7c92501e" title="Create a new system timer." alt="" coords="790,358,901,383"/><area shape="rect" id="node41" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="789,459,902,485"/><area shape="rect" id="node43" href="group__xg_timer.html#ga784a7f52b5167c777149fd1d874c99f0" title="Return the CPU clock frequency." alt="" coords="996,459,1111,485"/><area shape="rect" id="node45" href="group__xg_nut_arch_arm_os_timer_gba.html#ga7d11c53224db0028ad4838f8b9df9872" title="Return the CPU clock in Hertz." alt="" coords="1179,459,1293,485"/><area shape="rect" id="node56" href="sock__var_8h.html#a2dbf5a03e60e89a32ffcfd429aa81775" title="Initiate TCP segment transmission." alt="" coords="381,813,478,838"/><area shape="rect" id="node59" href="netdebug_8h.html#a13243e59b9857a6c4ee17e4cee73af51" title="NutDumpTcpHeader" alt="" coords="557,561,693,586"/><area shape="rect" id="node83" href="group__xg_timer.html#gac1887264221d66b13d1e86d034227f1c" title="Return the milliseconds counter value." alt="" coords="581,459,669,485"/><area shape="rect" id="node87" href="group__xg_i_p.html#gacbd7636c68dcc06dd37e2fae11472278" title="Calculates an the final IP checksum over a block of data." alt="" coords="796,814,895,839"/><area shape="rect" id="node89" href="group__xg_i_p.html#ga0586b4cd0a06f9e87f216037f937fab1" title="Calculate a partial IP checksum of a buffer." alt="" coords="986,1062,1121,1087"/><area shape="rect" id="node92" href="group__xg_i_p.html#gaa1d170f1dc44c4292480d40990483d85" title="Send IP datagram." alt="" coords="582,863,669,889"/><area shape="rect" id="node94" href="group__xgnetbuf.html#ga7a733aed1e6c15aaabb6657abe5f4e39" title="Allocate or re&#45;allocate a network buffer part." alt="" coords="793,713,897,738"/><area shape="rect" id="node99" href="group__xgnetbuf.html#ga3619cbf40ea5786bc0241c1e2e8e955a" title="Create a referencing copy of an existing network buffer structure." alt="" coords="779,1011,912,1037"/><area shape="rect" id="node109" href="group__xg_i_p.html#ga9ddc8d97c6179d3b2c562a78b2131632" title="Calculates the partial IP pseudo checksum." alt="" coords="537,1037,714,1062"/><area shape="rect" id="node61" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream." alt="" coords="819,561,871,586"/><area shape="rect" id="node79" href="group__xg_crt_stdio.html#ga14acfae1988535199b72df91e18f72f3" title="Write a string to a stream." alt="" coords="1029,510,1078,535"/><area shape="rect" id="node63" href="group__xg_crt_stdio.html#ga50c4b673b1d86ab16f2a46aff7122c5c" title="Write argument list to a stream using a given format." alt="" coords="1025,561,1082,586"/><area shape="rect" id="node65" href="group__xg_crt_stdio.html#ga651a41ea9a05d4294a58c1ec83e13f18" title="Write formatted data using a given output function." alt="" coords="1211,610,1261,635"/><area shape="rect" id="node77" href="io_8h.html#a901fa187b164dd6faaac1b62c88614b5" title="_write" alt="" coords="1209,561,1263,586"/><area shape="rect" id="node67" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="1347,559,1405,585"/><area shape="rect" id="node69" href="group__xg_crt_string.html#ga9d0726a46ae033e7755fd1313da76ab1" title="Locate byte in a memory region." alt="" coords="1342,609,1410,634"/><area shape="rect" id="node71" href="group__xg_crt_string.html#ga7b9fc4834c90ac78977b5fbb3076c5ac" title="Compute the length of a NUL terminated string." alt="" coords="1349,510,1403,535"/><area shape="rect" id="node73" href="group__xg_crt_string.html#ga5f9abaa6c5ffa26025ca901c14cb1056" title="Copy a string." alt="" coords="1349,658,1403,683"/><area shape="rect" id="node75" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="1355,707,1397,733"/><area shape="rect" id="node97" href="group__xg_crt_string.html#gaa4075a014de11292d9105188ddbeb216" title="Fill memory region with a specific byte value." alt="" coords="811,913,879,938"/><area shape="rect" id="node105" href="group__xg_i_p.html#ga2534f1918ba2a63523659fc005344b25" title="Find a device associated with a particular IP route." alt="" coords="787,962,903,987"/><area shape="rect" id="node107" href="if__ether_8h.html#ad1273e0893b714b62384c38dcc443beb" title="NutArpCacheQuery" alt="" coords="782,863,909,889"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga09d94fd887683a0837e06c2cc08fc7ba"></a><!-- doxytag: member="tcpsock.c::NutTcpCloseSocket" ref="ga09d94fd887683a0837e06c2cc08fc7ba" args="(TCPSOCKET *sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpCloseSocket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Close TCP socket. </p>
<p>Note, that the socket may not be immediately destroyed after calling this function. However, the application must not use the socket after this call.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00855">855</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="tcpsock_8c_source.html#l00977">NutTcpDeviceWrite()</a>, and <a class="el" href="tcpsm_8c_source.html#l00879">NutTcpStateCloseEvent()</a>.</p>

<p>Referenced by <a class="el" href="httpd__simple_8c_source.html#l00069">main()</a>, <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>, <a class="el" href="ftpd_8c_source.html#l00860">NutFtpTransferDirectoryOptions()</a>, <a class="el" href="ftpd_8c_source.html#l00741">NutFtpTransferFile()</a>, <a class="el" href="smtpc_8c_source.html#l00184">NutSmtpDisconnect()</a>, <a class="el" href="portdio_8c_source.html#l00374">service()</a>, and <a class="el" href="httpserv_8c_source.html#l00587">Service()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga09d94fd887683a0837e06c2cc08fc7ba_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga09d94fd887683a0837e06c2cc08fc7ba_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga09d94fd887683a0837e06c2cc08fc7ba_cgraph" id="group__xg_tcp_socket_ga09d94fd887683a0837e06c2cc08fc7ba_cgraph">
<area shape="rect" id="node3" href="group__xg_tcp_socket.html#ga9e0cdc2012de837e6b81006b9b32ca12" title="Write to a socket." alt="" coords="197,79,323,105"/><area shape="rect" id="node11" href="group__xg_t_c_p.html#gae64ae871579ec8252d41240a947f1a5e" title="Socket close by application." alt="" coords="184,155,336,181"/><area shape="rect" id="node5" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="633,105,676,130"/><area shape="rect" id="node7" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="425,5,484,30"/><area shape="rect" id="node9" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="420,54,489,79"/><area shape="rect" id="node13" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="401,278,508,303"/><area shape="rect" id="node35" href="group__xg_tcp_socket.html#ga551224f0a840a9cbf97b4d49dbc7c018" title="Destroy a previously allocated socket." alt="" coords="385,155,525,181"/><area shape="rect" id="node15" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="573,302,736,327"/><area shape="rect" id="node17" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="998,303,1151,329"/><area shape="rect" id="node19" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="591,253,719,278"/><area shape="rect" id="node21" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="803,253,931,278"/><area shape="rect" id="node28" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="784,403,949,429"/><area shape="rect" id="node33" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="809,302,925,327"/><area shape="rect" id="node23" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="1025,254,1124,279"/><area shape="rect" id="node25" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1200,329,1304,354"/><area shape="rect" id="node30" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="1017,353,1132,378"/><area shape="rect" id="node37" href="group__xg_tcp_socket.html#gae062b546a18e3a15d4fa87209d6160ca" title="NutTcpDiscardBuffers" alt="" coords="583,154,726,179"/><area shape="rect" id="node43" href="group__xg_crt_string.html#gaa4075a014de11292d9105188ddbeb216" title="Fill memory region with a specific byte value." alt="" coords="621,203,689,229"/><area shape="rect" id="node39" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="815,154,918,179"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3953f713369f008979d738b32d8fc255"></a><!-- doxytag: member="tcpsock.c::NutTcpError" ref="ga3953f713369f008979d738b32d8fc255" args="(TCPSOCKET *sock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return specific code of the last error. </p>
<p>Possible error codes (<a class="el" href="net_2errno_8h.html" title="Network error definitions.">net/errno.h</a>) are:</p>
<ul>
<li>EWOULDBLOCK: Operation would block</li>
<li>EINPROGRESS: Operation now in progress</li>
<li>EALREADY: Operation already in progress</li>
<li>ENOTSOCK: Socket operation on non-socket</li>
<li>EDESTADDRREQ: Destination address required</li>
<li>EMSGSIZE: Message too long</li>
<li>EPROTOTYPE: Protocol wrong type for socket</li>
<li>ENOPROTOOPT: Protocol not available</li>
<li>EPROTONOSUPPORT: Protocol not supported</li>
<li>ESOCKTNOSUPPORT: Socket type not supported</li>
<li>EOPNOTSUPP: Operation not supported on socket</li>
<li>EPFNOSUPPORT: Protocol family not supported</li>
<li>EAFNOSUPPORT: Address family not supported by protocol family</li>
<li>EADDRINUSE: Address already in use</li>
<li>EADDRNOTAVAIL: Can't assign requested address</li>
<li>ENETDOWN: Network is down</li>
<li>ENETUNREACH: Network is unreachable</li>
<li>ENETRESET: Network dropped connection on reset</li>
<li>ECONNABORTED: Software caused connection abort</li>
<li>ECONNRESET: Connection reset by peer</li>
<li>ENOBUFS: No buffer space available</li>
<li>EISCONN: Socket is already connected</li>
<li>ENOTCONN: Socket is not connected</li>
<li>ESHUTDOWN: Can't send after socket shutdown</li>
<li>ETOOMANYREFS: Too many references: can't splice</li>
<li>ETIMEDOUT: Connection timed out</li>
<li>ECONNREFUSED: Connection refused</li>
<li>ELOOP: Too many levels of symbolic links</li>
<li>ENAMETOOLONG: File name too long</li>
<li>EHOSTDOWN: Host is down</li>
<li>EHOSTUNREACH: No route to host</li>
<li>ENOTEMPTY: Directory not empty</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Applications must not call this function to retrieve the error code if <a class="el" href="group__xg_tcp_socket.html#ga09d94fd887683a0837e06c2cc08fc7ba" title="Close TCP socket.">NutTcpCloseSocket()</a> or <a class="el" href="group__xg_tcp_socket.html#ga551224f0a840a9cbf97b4d49dbc7c018" title="Destroy a previously allocated socket.">NutTcpDestroySocket()</a> failed.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000044">Todo:</a></b></dt><dd>Not all error codes are properly set right now. Some socket functions return an error without setting an error code. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00911">911</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00098">ENOTSOCK</a>, and <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>.</p>

<p>Referenced by <a class="el" href="ftpd_8c_source.html#l00465">NutFtpDataConnect()</a>.</p>

</div>
</div>
<a class="anchor" id="gac4ab675d039b53314b37b12b70afefd5"></a><!-- doxytag: member="tcpsock.c::NutTcpDeviceRead" ref="gac4ab675d039b53314b37b12b70afefd5" args="(TCPSOCKET *sock, void *buffer, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpDeviceRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read from virtual socket device. </p>
<p>TCP sockets can be used like other Nut/OS devices. This routine is part of the virtual socket device driver.</p>
<p>This function is called by the low level input routines of the <a class="el" href="group__xg_crt_lowio.html#xrCrtLowio">C runtime library</a>, using the <a class="el" href="struct___n_u_t_d_e_v_i_c_e.html#a105f32f25da275ccbc559aa28db75a26" title="Read from device.">_NUTDEVICE::dev_read</a> entry.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to the buffer that receives the data. </td></tr>
    <tr><td class="paramname">size</td><td>Maximum number of bytes to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes read, which may be less than the number of bytes specified. A return value of -1 indicates an error, while zero is returned in case of a timeout. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00937">937</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="tcpsock_8c_source.html#l00762">NutTcpReceive()</a>.</p>

<p>Referenced by <a class="el" href="tcpsock_8c_source.html#l00373">NutTcpCreateSocket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_gac4ab675d039b53314b37b12b70afefd5_cgraph.png" border="0" usemap="#group__xg_tcp_socket_gac4ab675d039b53314b37b12b70afefd5_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_gac4ab675d039b53314b37b12b70afefd5_cgraph" id="group__xg_tcp_socket_gac4ab675d039b53314b37b12b70afefd5_cgraph">
<area shape="rect" id="node3" href="group__xg_tcp_socket.html#gab08d3e50fd09da18b966af0dd23fa4aa" title="Receive data on a connected TCP socket." alt="" coords="182,610,287,635"/><area shape="rect" id="node5" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="552,158,659,183"/><area shape="rect" id="node27" href="group__xg_event.html#ga79af18e0842286182af7c5b647526ce5" title="Wait for an event in a specified queue." alt="" coords="370,158,465,183"/><area shape="rect" id="node52" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="1195,661,1264,686"/><area shape="rect" id="node54" href="group__xgnetbuf.html#ga2e14a135152823a816388f50bdb3ea3f" title="Release a network buffer structure." alt="" coords="1178,961,1281,986"/><area shape="rect" id="node57" href="group__xg_t_c_p.html#ga9f691b65c2a49fbb90202f3d45c5b000" title="Initiated by the application." alt="" coords="336,759,499,785"/><area shape="rect" id="node7" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="720,107,883,133"/><area shape="rect" id="node9" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="1153,82,1306,107"/><area shape="rect" id="node11" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="737,209,865,234"/><area shape="rect" id="node13" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="957,207,1085,233"/><area shape="rect" id="node20" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="939,257,1104,282"/><area shape="rect" id="node25" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="963,158,1079,183"/><area shape="rect" id="node15" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="1180,206,1279,231"/><area shape="rect" id="node17" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1360,257,1464,282"/><area shape="rect" id="node22" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="1172,358,1287,383"/><area shape="rect" id="node32" href="group__xg_timer.html#ga91b42f5fd833e1b72c27b3bfb0ed0af7" title="Start a system timer." alt="" coords="556,321,655,346"/><area shape="rect" id="node48" href="group__xg_event.html#gaaa944c4484d068bdacd8220b7e081302" title="Timer callback in case of event timeout." alt="" coords="547,6,663,31"/><area shape="rect" id="node34" href="group__xg_timer.html#gaf104e0c3660b2a77bd0d7b00c4fd741c" title="Start a system timer." alt="" coords="738,321,865,346"/><area shape="rect" id="node40" href="group__xg_nut_arch_arm_os_timer_at91.html#gabb52a4e7f513a7c586898065e0a0c81a" title="Calculate system ticks for a given number of milliseconds." alt="" coords="729,397,873,422"/><area shape="rect" id="node36" href="group__xg_timer.html#ga1e47b683a996583386ebef7e7c92501e" title="Create a new system timer." alt="" coords="966,358,1077,383"/><area shape="rect" id="node42" href="group__xg_nut_arch_arm_os_timer_at91.html#ga2724f52da15ed45123a32c1ed7e148f0" title="Return the number of system ticks per second." alt="" coords="965,459,1078,485"/><area shape="rect" id="node44" href="group__xg_timer.html#ga784a7f52b5167c777149fd1d874c99f0" title="Return the CPU clock frequency." alt="" coords="1172,459,1287,485"/><area shape="rect" id="node46" href="group__xg_nut_arch_arm_os_timer_gba.html#ga7d11c53224db0028ad4838f8b9df9872" title="Return the CPU clock in Hertz." alt="" coords="1355,459,1469,485"/><area shape="rect" id="node59" href="sock__var_8h.html#a2dbf5a03e60e89a32ffcfd429aa81775" title="Initiate TCP segment transmission." alt="" coords="557,859,654,885"/><area shape="rect" id="node62" href="netdebug_8h.html#a13243e59b9857a6c4ee17e4cee73af51" title="NutDumpTcpHeader" alt="" coords="733,559,869,585"/><area shape="rect" id="node86" href="group__xg_timer.html#gac1887264221d66b13d1e86d034227f1c" title="Return the milliseconds counter value." alt="" coords="757,459,845,485"/><area shape="rect" id="node90" href="group__xg_i_p.html#gacbd7636c68dcc06dd37e2fae11472278" title="Calculates an the final IP checksum over a block of data." alt="" coords="972,1062,1071,1087"/><area shape="rect" id="node92" href="group__xg_i_p.html#ga0586b4cd0a06f9e87f216037f937fab1" title="Calculate a partial IP checksum of a buffer." alt="" coords="1162,1113,1297,1138"/><area shape="rect" id="node95" href="group__xg_i_p.html#gaa1d170f1dc44c4292480d40990483d85" title="Send IP datagram." alt="" coords="758,859,845,885"/><area shape="rect" id="node97" href="group__xgnetbuf.html#ga7a733aed1e6c15aaabb6657abe5f4e39" title="Allocate or re&#45;allocate a network buffer part." alt="" coords="969,961,1073,986"/><area shape="rect" id="node102" href="group__xgnetbuf.html#ga3619cbf40ea5786bc0241c1e2e8e955a" title="Create a referencing copy of an existing network buffer structure." alt="" coords="955,711,1088,737"/><area shape="rect" id="node112" href="group__xg_i_p.html#ga9ddc8d97c6179d3b2c562a78b2131632" title="Calculates the partial IP pseudo checksum." alt="" coords="713,1214,890,1239"/><area shape="rect" id="node64" href="group__xg_crt_stdio.html#ga2f7351ee13f3f4c465c65e849a12a3fd" title="Print formatted data to a stream." alt="" coords="995,509,1047,534"/><area shape="rect" id="node82" href="group__xg_crt_stdio.html#ga14acfae1988535199b72df91e18f72f3" title="Write a string to a stream." alt="" coords="1205,559,1254,585"/><area shape="rect" id="node66" href="group__xg_crt_stdio.html#ga50c4b673b1d86ab16f2a46aff7122c5c" title="Write argument list to a stream using a given format." alt="" coords="1201,509,1258,534"/><area shape="rect" id="node68" href="group__xg_crt_stdio.html#ga651a41ea9a05d4294a58c1ec83e13f18" title="Write formatted data using a given output function." alt="" coords="1387,509,1437,534"/><area shape="rect" id="node80" href="io_8h.html#a901fa187b164dd6faaac1b62c88614b5" title="_write" alt="" coords="1385,558,1439,583"/><area shape="rect" id="node70" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="1523,461,1581,486"/><area shape="rect" id="node72" href="group__xg_crt_string.html#ga9d0726a46ae033e7755fd1313da76ab1" title="Locate byte in a memory region." alt="" coords="1518,510,1586,535"/><area shape="rect" id="node74" href="group__xg_crt_string.html#ga7b9fc4834c90ac78977b5fbb3076c5ac" title="Compute the length of a NUL terminated string." alt="" coords="1525,609,1579,634"/><area shape="rect" id="node76" href="group__xg_crt_string.html#ga5f9abaa6c5ffa26025ca901c14cb1056" title="Copy a string." alt="" coords="1525,559,1579,585"/><area shape="rect" id="node78" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="1531,411,1573,437"/><area shape="rect" id="node100" href="group__xg_crt_string.html#gaa4075a014de11292d9105188ddbeb216" title="Fill memory region with a specific byte value." alt="" coords="987,761,1055,786"/><area shape="rect" id="node108" href="group__xg_i_p.html#ga2534f1918ba2a63523659fc005344b25" title="Find a device associated with a particular IP route." alt="" coords="963,810,1079,835"/><area shape="rect" id="node110" href="if__ether_8h.html#ad1273e0893b714b62384c38dcc443beb" title="NutArpCacheQuery" alt="" coords="958,859,1085,885"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga9e0cdc2012de837e6b81006b9b32ca12"></a><!-- doxytag: member="tcpsock.c::NutTcpDeviceWrite" ref="ga9e0cdc2012de837e6b81006b9b32ca12" args="(TCPSOCKET *sock, CONST void *buf, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpDeviceWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONST void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write to a socket. </p>
<p>TCP sockets can be used like other Nut/OS devices. This routine is part of the virtual socket device driver.</p>
<p>This function is called by the low level output routines of the <a class="el" href="group__xg_crt_lowio.html#xrCrtLowio">C runtime library</a>, using the <a class="el" href="struct___n_u_t_d_e_v_i_c_e.html#a2f1ae37c71ffc3af5aff422b3e992f14">_NUTDEVICE::dev_write</a> entry.</p>
<p>In contrast to <a class="el" href="group__xg_tcp_socket.html#gafc14dd4c910afbb9269adc5bebba0281" title="Send data on a connected TCP socket.">NutTcpSend()</a> this routine provides some buffering.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">buf</td><td>Pointer to the data to be written. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to write. If zero, then the output buffer will be flushed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes written. A return value of -1 indicates an error. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00977">977</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="errno_8h_source.html#l00119">ENOTCONN</a>, <a class="el" href="malloc_8c_source.html#l00084">free()</a>, <a class="el" href="malloc_8c_source.html#l00064">malloc()</a>, <a class="el" href="memcpy_8c_source.html#l00114">memcpy()</a>, <a class="el" href="sock__var_8h_source.html#l00221">tcp_socket::so_devobsz</a>, <a class="el" href="sock__var_8h_source.html#l00220">tcp_socket::so_devobuf</a>, <a class="el" href="sock__var_8h_source.html#l00219">tcp_socket::so_devocnt</a>, <a class="el" href="sock__var_8h_source.html#l00258">tcp_socket::so_last_error</a>, <a class="el" href="sock__var_8h_source.html#l00223">tcp_socket::so_state</a>, and <a class="el" href="tcp__fsm_8h_source.html#l00099">TCPS_ESTABLISHED</a>.</p>

<p>Referenced by <a class="el" href="tcpsock_8c_source.html#l00855">NutTcpCloseSocket()</a>, <a class="el" href="tcpsock_8c_source.html#l00373">NutTcpCreateSocket()</a>, and <a class="el" href="tcpsock_8c_source.html#l01105">NutTcpDeviceWrite_P()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga9e0cdc2012de837e6b81006b9b32ca12_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga9e0cdc2012de837e6b81006b9b32ca12_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga9e0cdc2012de837e6b81006b9b32ca12_cgraph" id="group__xg_tcp_socket_ga9e0cdc2012de837e6b81006b9b32ca12_cgraph">
<area shape="rect" id="node3" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="195,5,237,30"/><area shape="rect" id="node5" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="187,54,245,79"/><area shape="rect" id="node7" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="181,103,251,129"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga71f2a257f72723170c19ad7b5d9f991f"></a><!-- doxytag: member="tcpsock.c::NutTcpDeviceWrite_P" ref="ga71f2a257f72723170c19ad7b5d9f991f" args="(TCPSOCKET *sock, PGM_P buffer, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpDeviceWrite_P </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PGM_P&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write to device. </p>
<p>This function is implemented for CPUs with Harvard Architecture only.</p>
<p>TCP sockets can be used like other Nut/OS devices. This routine is part of the virtual socket device driver and similar to <a class="el" href="group__xg_tcp_socket.html#ga9e0cdc2012de837e6b81006b9b32ca12" title="Write to a socket.">NutTcpDeviceWrite()</a> except that the data is located in program memory.</p>
<p>This function is called by the low level output routines of the <a class="el" href="group__xg_crt_lowio.html#xrCrtLowio">C runtime library</a>, using the <a class="el" href="struct___n_u_t_d_e_v_i_c_e.html#a965dec701781da979635e1cbba7098af">_NUTDEVICE::dev_write_P</a> entry.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">buffer</td><td>Pointer to the data in program space to be written. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to write.</td></tr>
  </table>
  </dd>
</dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Inefficient implementation. No buffering has been implemented. Thus, each call will result in a separate TCP segment. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l01105">1105</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="arm_8h_source.html#l00172">memcpy_P</a>, <a class="el" href="heap_8h_source.html#l00086">NutHeapAlloc</a>, <a class="el" href="heap_8h_source.html#l00088">NutHeapFree</a>, and <a class="el" href="tcpsock_8c_source.html#l00977">NutTcpDeviceWrite()</a>.</p>

<p>Referenced by <a class="el" href="tcpsock_8c_source.html#l00373">NutTcpCreateSocket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__xg_tcp_socket_ga71f2a257f72723170c19ad7b5d9f991f_cgraph.png" border="0" usemap="#group__xg_tcp_socket_ga71f2a257f72723170c19ad7b5d9f991f_cgraph" alt=""/></div>
<map name="group__xg_tcp_socket_ga71f2a257f72723170c19ad7b5d9f991f_cgraph" id="group__xg_tcp_socket_ga71f2a257f72723170c19ad7b5d9f991f_cgraph">
<area shape="rect" id="node3" href="group__xg_tcp_socket.html#ga9e0cdc2012de837e6b81006b9b32ca12" title="Write to a socket." alt="" coords="195,54,322,79"/><area shape="rect" id="node5" href="group__xg_heap.html#ga9f850d0608418aea291e4c0fdab93826" title="Return a block to heap memory." alt="" coords="384,5,427,30"/><area shape="rect" id="node7" href="group__xg_heap.html#ga381d0a123dbf80ca3efe2614aa826e08" title="Allocate a block from heap memory." alt="" coords="376,54,435,79"/><area shape="rect" id="node9" href="group__xg_crt_string.html#ga09a4c3953e2e41a212a73cf3df4c8c8e" title="memcpy" alt="" coords="371,103,440,129"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaceb6b4b842cb85f48f6ca163c7aa1ce0"></a><!-- doxytag: member="tcpsock.c::NutTcpDeviceIOCtl" ref="gaceb6b4b842cb85f48f6ca163c7aa1ce0" args="(TCPSOCKET *sock, int cmd, void *param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutTcpDeviceIOCtl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Driver control function. </p>
<p>Used by the virtual device driver to modify or query device specific settings.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>Socket descriptor. This pointer must have been retrieved by calling <a class="el" href="group__xg_tcp_socket.html#ga6bf8ec59828c5a0e38423293b4dfe8e6" title="Create a TCP socket.">NutTcpCreateSocket()</a>. </td></tr>
    <tr><td class="paramname">cmd</td><td>Requested control function. May be set to one of the following constants:<ul>
<li><a class="el" href="group__xg_crt_lowio.html#gab36ad110d70105bd33c1e0c9be137339">IOCTL_GETFILESIZE</a></li>
<li><a class="el" href="group__xg_crt_lowio.html#gae06e732c285bea82878b1b82377b437d">IOCTL_GETINBUFCOUNT</a></li>
<li><a class="el" href="group__xg_crt_lowio.html#ga809cc6bff637bb28aad35eeaaeed26bb">IOCTL_GETOUTBUFCOUNT</a></li>
</ul>
</td></tr>
    <tr><td class="paramname">param</td><td>Points to a buffer that contains any data required for the given control function or receives data from that function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 otherwise. </dd></dl>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l01143">1143</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>References <a class="el" href="io_8h_source.html#l00081">IOCTL_GETFILESIZE</a>, <a class="el" href="io_8h_source.html#l00087">IOCTL_GETINBUFCOUNT</a>, <a class="el" href="io_8h_source.html#l00084">IOCTL_GETOUTBUFCOUNT</a>, <a class="el" href="sock__var_8h_source.html#l00219">tcp_socket::so_devocnt</a>, <a class="el" href="sock__var_8h_source.html#l00245">tcp_socket::so_rd_cnt</a>, and <a class="el" href="sock__var_8h_source.html#l00243">tcp_socket::so_rx_cnt</a>.</p>

<p>Referenced by <a class="el" href="tcpsock_8c_source.html#l00373">NutTcpCreateSocket()</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="ga2fcec3521061173b7bdd704877a57395"></a><!-- doxytag: member="tcpsock.c::tcpSocketList" ref="ga2fcec3521061173b7bdd704877a57395" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__xg_tcp_socket.html#gaffc7ada36497e0b38f338c1aa1b5e394">TCPSOCKET</a>* <a class="el" href="group__xg_tcp_socket.html#ga2fcec3521061173b7bdd704877a57395">tcpSocketList</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Global linked list of all TCP sockets. </p>

<p>Definition at line <a class="el" href="tcpsock_8c_source.html#l00238">238</a> of file <a class="el" href="tcpsock_8c_source.html">tcpsock.c</a>.</p>

<p>Referenced by <a class="el" href="tcpsock_8c_source.html#l00593">NutTcpConnect()</a>, <a class="el" href="tcpsock_8c_source.html#l00373">NutTcpCreateSocket()</a>, and <a class="el" href="tcpsock_8c_source.html#l00273">NutTcpDestroySocket()</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
