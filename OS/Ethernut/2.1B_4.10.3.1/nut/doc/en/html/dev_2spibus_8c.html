<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nut/OS: dev/spibus.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="nutos_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nut/OS
   &#160;<span id="projectnumber">4.10.3</span>
   </div>
   <div id="projectbrief">API Reference</div>
  </td>
  
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('dev_2spibus_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">spibus.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="device_8h_source.html">sys/device.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="nutdebug_8h_source.html">sys/nutdebug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="spibus_8h_source.html">dev/spibus.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for spibus.c:</div>
<div class="dyncontent">
<div class="center"><img src="dev_2spibus_8c__incl.png" border="0" usemap="#dev_2spibus_8c" alt=""/></div>
<map name="dev_2spibus_8c" id="dev_2spibus_8c">
<area shape="rect" id="node3" href="device_8h.html" title="Nut/OS device definitions." alt="" coords="5,230,93,255"/><area shape="rect" id="node15" href="nutdebug_8h.html" title="sys/nutdebug.h" alt="" coords="504,230,611,255"/><area shape="rect" id="node20" href="spibus_8h.html" title="SPI bus declarations." alt="" coords="157,81,248,106"/><area shape="rect" id="node5" href="file_8h.html" title="sys/file.h" alt="" coords="14,305,84,330"/><area shape="rect" id="node13" href="stdint_8h.html" title="stdint.h" alt="" coords="109,305,171,330"/><area shape="rect" id="node7" href="types_8h.html" title="Nut/OS type declarations." alt="" coords="421,379,504,405"/><area shape="rect" id="node9" href="compiler_8h.html" title="compiler.h" alt="" coords="344,454,424,479"/><area shape="rect" id="node17" href="memory_8h.html" title="Default memory layout." alt="" coords="472,305,568,330"/><area shape="rect" id="node22" href="dev_2irqreg_8h.html" title="Interrupt management definitions." alt="" coords="159,155,245,181"/><area shape="rect" id="node33" href="event_8h.html" title="Event management definitions." alt="" coords="333,155,416,181"/><area shape="rect" id="node24" href="arch_8h.html" title="cfg/arch.h" alt="" coords="169,230,244,255"/><area shape="rect" id="node28" href="irqstack_8h.html" title="dev/irqstack.h" alt="" coords="269,230,365,255"/><area shape="rect" id="node30" href="dev_8h.html" title="cfg/dev.h" alt="" coords="275,305,345,330"/><area shape="rect" id="node35" href="thread_8h.html" title="Thread management definitions." alt="" coords="390,230,479,255"/></map>
</div>
</div>
<p><a href="dev_2spibus_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dev_2spibus_8c.html#a9f84b1e3e0d80febca1d2071b04f6fc7">NutRegisterSpiDevice</a> (<a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *dev, <a class="el" href="spibus_8h.html#a13aa308d06e8dd80a561824c99d97659">NUTSPIBUS</a> *bus, int cs)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Register and initialize an SPI device attached to a specified bus.  <a href="#a9f84b1e3e0d80febca1d2071b04f6fc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dev_2spibus_8c.html#afc8436860a2eb534dac97cdd3e595c95">NutSpiBusWait</a> (<a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *node, <a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a> tmo)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until all SPI bus transfers are done.  <a href="#afc8436860a2eb534dac97cdd3e595c95"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a6ed085329b153773ff76afa0702cf897">uint_fast16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dev_2spibus_8c.html#a97c4e8b5edd13bcbbe447b1f88c43506">NutSpiBusSetMode</a> (<a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *node, <a class="el" href="stdint_8h.html#a6ed085329b153773ff76afa0702cf897">uint_fast16_t</a> mode)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set SPI mode of a specified bus device.  <a href="#a97c4e8b5edd13bcbbe447b1f88c43506"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#a8f075c759c74e109e8184306c663809d">uint_fast32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dev_2spibus_8c.html#a75bb7de2545f6b22c2466fb9d9d188c3">NutSpiBusSetRate</a> (<a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *node, <a class="el" href="stdint_8h.html#a8f075c759c74e109e8184306c663809d">uint_fast32_t</a> rate)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set clock rate of a specified SPI device.  <a href="#a75bb7de2545f6b22c2466fb9d9d188c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dev_2spibus_8c.html#aa29c28c7b0a5ceb06ddbacef4d88edf6">NutSpiBusSetBits</a> (<a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *node, <a class="el" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> bits)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set clock rate of a specified SPI device.  <a href="#aa29c28c7b0a5ceb06ddbacef4d88edf6"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a9f84b1e3e0d80febca1d2071b04f6fc7"></a><!-- doxytag: member="spibus.c::NutRegisterSpiDevice" ref="a9f84b1e3e0d80febca1d2071b04f6fc7" args="(NUTDEVICE *dev, NUTSPIBUS *bus, int cs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutRegisterSpiDevice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="spibus_8h.html#a13aa308d06e8dd80a561824c99d97659">NUTSPIBUS</a> *&#160;</td>
          <td class="paramname"><em>bus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register and initialize an SPI device attached to a specified bus. </p>
<p>Calls the bus controller initialization and, if successful, initializes the SPI device and adds it to the system device list.</p>
<p>Applications should call this function during initialization for each SPI device they intend to use.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">dev</td><td>Pointer to the <a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> structure, which is provided by the device driver. </td></tr>
    <tr><td class="paramname">bus</td><td>Pointer to the <a class="el" href="spibus_8h.html#a13aa308d06e8dd80a561824c99d97659">NUTSPIBUS</a> structure, which is provided by the bus controller driver. </td></tr>
    <tr><td class="paramname">cs</td><td>Zero based chip select number for this device. Must be set to 0, if only one device is attached to the bus and no chip select line is provided.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if the device has been registered for the first time and the initialization was successful. The function returns -1, if any device with the same name had been registered previously, if the <a class="el" href="group__xg_device.html#ga6e44357e76989d8e579d3f65bc3a2741">NUTDEVICE</a> structure or the chip select is invalid or if the device or bus controller initialization failed. </dd></dl>

<p>Definition at line <a class="el" href="dev_2spibus_8c_source.html#l00072">72</a> of file <a class="el" href="dev_2spibus_8c_source.html">spibus.c</a>.</p>

<p>References <a class="el" href="spibus_8h_source.html#l00100">_NUTSPIBUS::bus_initnode</a>, <a class="el" href="spibus_8h_source.html#l00082">_NUTSPIBUS::bus_mutex</a>, <a class="el" href="device_8h_source.html#l00209">_NUTDEVICE::dev_icb</a>, <a class="el" href="spibus_8h_source.html#l00143">_NUTSPINODE::node_bus</a>, <a class="el" href="spibus_8h_source.html#l00173">_NUTSPINODE::node_cs</a>, <a class="el" href="nutdebug_8h_source.html#l00047">NUTASSERT</a>, <a class="el" href="event_8c_source.html#l00454">NutEventPost()</a>, and <a class="el" href="devreg_8c_source.html#l00129">NutRegisterDevice()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="dev_2spibus_8c_a9f84b1e3e0d80febca1d2071b04f6fc7_cgraph.png" border="0" usemap="#dev_2spibus_8c_a9f84b1e3e0d80febca1d2071b04f6fc7_cgraph" alt=""/></div>
<map name="dev_2spibus_8c_a9f84b1e3e0d80febca1d2071b04f6fc7_cgraph" id="dev_2spibus_8c_a9f84b1e3e0d80febca1d2071b04f6fc7_cgraph">
<area shape="rect" id="node3" href="group__xg_event.html#gad519c6b1469621d2b3909fe58d1ac40b" title="Post an event to a specified queue." alt="" coords="212,155,308,181"/><area shape="rect" id="node28" href="group__xg_device.html#ga0d73e3153bf9f210194bd862d9b91c61" title="Register and initialize a device." alt="" coords="197,205,323,230"/><area shape="rect" id="node5" href="group__xg_event.html#ga129d2de44ddf083f252d0754fc45d9d3" title="Asynchronously post an event to a specified queue." alt="" coords="768,155,896,181"/><area shape="rect" id="node13" href="group__xg_thread.html#ga075836f9a2596c5983b7ba88420afd11" title="Give up the CPU." alt="" coords="377,79,484,105"/><area shape="rect" id="node7" href="group__xg_timer.html#gafb23f6965312663a72d41fefc574dc00" title="Stop a specified timer." alt="" coords="991,154,1089,179"/><area shape="rect" id="node11" href="group__xg_thread.html#ga4d2458fb9ec9d926a6f87706b19e7e06" title="Add a thread to a prioritiy ordered queue." alt="" coords="963,105,1117,130"/><area shape="rect" id="node9" href="group__xg_timer.html#ga681ca3c989be2bdeb5f0cc97e11d6e06" title="Insert a new timer in the global timer list." alt="" coords="1165,79,1269,105"/><area shape="rect" id="node15" href="group__xg_thread.html#gae45ebad9f604755d5c5ba8adaf9e4f89" title="Remove a thread from a specified queue." alt="" coords="539,5,701,30"/><area shape="rect" id="node18" href="group__xg_thread.html#gaabfac60c4d51b57c2dc422d09a69df5b" title="Continue with the highest priority thread, which is ready to run." alt="" coords="556,54,684,79"/><area shape="rect" id="node21" href="group__xg_timer.html#gaf719e88403b4ccc78f071ce5c85a5a71" title="Process elapsed timers." alt="" coords="749,5,915,30"/><area shape="rect" id="node26" href="group__xg_nut_arch_arm_os_context.html#gad63408e1c4ef1c03d9f979ad2d31b7e0" title="Switch to another thread." alt="" coords="774,54,890,79"/><area shape="rect" id="node23" href="group__xg_timer.html#ga940f66286dcf28b8280e41b605064446" title="Return the number of system timer ticks." alt="" coords="983,55,1097,81"/><area shape="rect" id="node30" href="group__xg_device.html#ga913130771bea4118ae58e2a0ccb50a4d" title="Find device entry by name." alt="" coords="371,206,490,231"/><area shape="rect" id="node32" href="group__xg_crt_string.html#gaafa356ff1e215725834bc57e8e4fae60" title="Compare two strings." alt="" coords="590,206,650,231"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afc8436860a2eb534dac97cdd3e595c95"></a><!-- doxytag: member="spibus.c::NutSpiBusWait" ref="afc8436860a2eb534dac97cdd3e595c95" args="(NUTSPINODE *node, uint32_t tmo)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int NutSpiBusWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a06896e8c53f721507066c079052171f8">uint32_t</a>&#160;</td>
          <td class="paramname"><em>tmo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wait until all SPI bus transfers are done. </p>
<p>This dummy function is used by SPI device drivers, which do not provide asynchronous transfers.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>Specifies the SPI bus node. </td></tr>
    <tr><td class="paramname">tmo</td><td>Timeout in milliseconds. To disable timeout, set this parameter to NUT_WAIT_INFINITE.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Always 0. </dd></dl>

<p>Definition at line <a class="el" href="dev_2spibus_8c_source.html#l00111">111</a> of file <a class="el" href="dev_2spibus_8c_source.html">spibus.c</a>.</p>

</div>
</div>
<a class="anchor" id="a97c4e8b5edd13bcbbe447b1f88c43506"></a><!-- doxytag: member="spibus.c::NutSpiBusSetMode" ref="a97c4e8b5edd13bcbbe447b1f88c43506" args="(NUTSPINODE *node, uint_fast16_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a6ed085329b153773ff76afa0702cf897">uint_fast16_t</a> NutSpiBusSetMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a6ed085329b153773ff76afa0702cf897">uint_fast16_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set SPI mode of a specified bus device. </p>
<p>The new mode will be used during the next transfer. If its value is SPI_CURRENT_MODE, then the mode is not updated. This can be used to query the current mode.</p>
<p>Otherwise this parameter may be the or'ed combination of the following bits:</p>
<ul>
<li>SPI_MODE_CPHA: Data updated on leading edge.</li>
<li>SPI_MODE_CPOL: Idle clock is high.</li>
<li>SPI_MODE_FAULT: Enables mode fault detection.</li>
<li>SPI_MODE_LOOPBACK: Loopback mode.</li>
<li>SPI_MODE_SLAVE: Slave mode.</li>
<li>SPI_MODE_CSKEEP: Chip select remains active after transfer.</li>
<li>SPI_MODE_CSDEC: Decoded chip selects.</li>
<li>SPI_MODE_CSHIGH: Chip select is high active.</li>
</ul>
<p>Be aware, that SPI drivers may have implemented a subset only.</p>
<p>Instead of SPI_MODE_CPHA and SPI_MODE_CPOL one of the following mode numbers may be used:</p>
<ul>
<li>SPI_MODE_0: Idle clock is low and data is captured on the rising edge.</li>
<li>SPI_MODE_1: Idle clock is low and data is captured on the falling edge.</li>
<li>SPI_MODE_2: Idle clock is high and data is captured on the falling edge.</li>
<li>SPI_MODE_3: Idle clock is high and data is captured on the rising edge.</li>
</ul>
<p>The return value may additionally contain the bit SPI_MODE_UPDATE, which indicates that here had been no transfer since the last mode update.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>Specifies the SPI bus node. </td></tr>
    <tr><td class="paramname">mode</td><td>New mode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Old mode. </dd></dl>

<p>Definition at line <a class="el" href="dev_2spibus_8c_source.html#l00154">154</a> of file <a class="el" href="dev_2spibus_8c_source.html">spibus.c</a>.</p>

<p>References <a class="el" href="spibus_8h_source.html#l00161">_NUTSPINODE::node_mode</a>, <a class="el" href="spibus_8h_source.html#l00050">SPI_CURRENT_MODE</a>, and <a class="el" href="spibus_8h_source.html#l00060">SPI_MODE_UPDATE</a>.</p>

</div>
</div>
<a class="anchor" id="a75bb7de2545f6b22c2466fb9d9d188c3"></a><!-- doxytag: member="spibus.c::NutSpiBusSetRate" ref="a75bb7de2545f6b22c2466fb9d9d188c3" args="(NUTSPINODE *node, uint_fast32_t rate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#a8f075c759c74e109e8184306c663809d">uint_fast32_t</a> NutSpiBusSetRate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a8f075c759c74e109e8184306c663809d">uint_fast32_t</a>&#160;</td>
          <td class="paramname"><em>rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set clock rate of a specified SPI device. </p>
<p>The new clock rate will be used for the next transfer. If the given rate is beyond the capabilities of the bus controller, it will automatically adjusted before the transfer starts.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>Specifies the SPI bus node. </td></tr>
    <tr><td class="paramname">rate</td><td>New clock rate, given in bits per second. If the value is SPI_CURRENT_RATE, then the current rate is kept.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Previous rate. </dd></dl>

<p>Definition at line <a class="el" href="dev_2spibus_8c_source.html#l00177">177</a> of file <a class="el" href="dev_2spibus_8c_source.html">spibus.c</a>.</p>

<p>References <a class="el" href="spibus_8h_source.html#l00161">_NUTSPINODE::node_mode</a>, <a class="el" href="spibus_8h_source.html#l00155">_NUTSPINODE::node_rate</a>, <a class="el" href="spibus_8h_source.html#l00068">SPI_CURRENT_RATE</a>, and <a class="el" href="spibus_8h_source.html#l00060">SPI_MODE_UPDATE</a>.</p>

</div>
</div>
<a class="anchor" id="aa29c28c7b0a5ceb06ddbacef4d88edf6"></a><!-- doxytag: member="spibus.c::NutSpiBusSetBits" ref="aa29c28c7b0a5ceb06ddbacef4d88edf6" args="(NUTSPINODE *node, uint_fast8_t bits)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a> NutSpiBusSetBits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="spibus_8h.html#a773cdd0ed090ed95c3aa5b8b9fb878d4">NUTSPINODE</a> *&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#ad0fca8b15c218d2c687f8c373a71d228">uint_fast8_t</a>&#160;</td>
          <td class="paramname"><em>bits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set clock rate of a specified SPI device. </p>
<p>The new clock rate will be used for the next transfer. If the given rate is beyond the capabilities of the bus controller, it will automatically adjusted before the transfer starts.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>Specifies the SPI bus node. </td></tr>
    <tr><td class="paramname">rate</td><td>New clock rate, given in bits per second. If the value is SPI_CURRENT_RATE, then the current rate is kept.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Previous rate. </dd></dl>

<p>Definition at line <a class="el" href="dev_2spibus_8c_source.html#l00201">201</a> of file <a class="el" href="dev_2spibus_8c_source.html">spibus.c</a>.</p>

<p>References <a class="el" href="spibus_8h_source.html#l00167">_NUTSPINODE::node_bits</a>, <a class="el" href="spibus_8h_source.html#l00161">_NUTSPINODE::node_mode</a>, <a class="el" href="spibus_8h_source.html#l00070">SPI_CURRENT_BITS</a>, and <a class="el" href="spibus_8h_source.html#l00060">SPI_MODE_UPDATE</a>.</p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dev_2spibus_8c.html">spibus.c</a>      </li>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr>
<address>
  <small>
    &copy;&nbsp;2000-2010 by contributors - 
    visit <a href="http://www.ethernut.de/">http://www.ethernut.de/</a>
  </small>
</address>
</body>
</html>
